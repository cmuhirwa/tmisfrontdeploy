(this.webpackJsonpTMIS=this.webpackJsonpTMIS||[]).push([[27],{129:function(e,t,a){"use strict";a.d(t,"a",(function(){return L}));var s=a(40),r=a(35),i=a(4),n=a(26),l=a(27),o=a(28),c=a(29),d=a(2),u=a.n(d),m=a(16),_=a(12),h=a(24),b=a(30),p=a(39),f=a(105),g=a(31),j=a(48),x=a(106),v=a(25),O=a(111),y=a(119),N=a(1),S=function(e){Object(o.a)(a,e);var t=Object(c.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).submitLogin=function(e){var t;if(e.preventDefault(),""===s.state.nid)return s.setState({error:{target:"nid",msg:"Required!"}});if((null===s.state.first_name||""===s.state.first_name)&&s.props.required.first_name)return s.setState({error:{target:"first_name",msg:"Required!"}});if((null===s.state.last_name||(null===(t=s.state.last_name)||void 0===t?void 0:t.length)<=2)&&s.props.required.last_name)return s.setState({error:{target:"last_name",msg:"Required!"}});if(""===s.state.full_name&&s.props.required.full_name)return s.setState({error:{target:"full_name",msg:"Required!"}});if(""===s.state.phone_numbers&&s.props.required.phone_numbers)return s.setState({error:{target:"phone_numbers",msg:"Required!"}});if(""===s.state.email&&s.props.required.email)return s.setState({error:{target:"email",msg:"Required!"}});if(""===s.state.username&&s.props.required.username)return s.setState({error:{target:"username",msg:"Required!"}});if(""===s.state.staff_code&&s.props.required.staff_code)return s.setState({error:{target:"staff_code",msg:"Required!"}});if(""===s.state.sex&&s.props.required.sex)return s.setState({error:{target:"sex",msg:"Required!"}});if(""===s.state.martial_status&&s.props.required.martial_status)return s.setState({error:{target:"martial_status",msg:"Required!"}});if((null===s.state.martial_status||""===s.state.martial_status)&&s.props.required.martial_status)return s.setState({error:{target:"martial_status",msg:"Required!"}});if(""===s.state.rssb_number&&s.props.required.rssb_number)return s.setState({error:{target:"rssb_number",msg:"Required!"}});if(""===s.state.highest_qualification_id&&s.props.required.highest_qualification_id)return s.setState({error:{target:"highest_qualification_id",msg:"Required!"}});if(""===s.state.nationality_id||null===s.state.nationality_id)return s.setState({error:{target:"nationality_id",msg:"Required!"}});if(""===s.state.dob||null===s.state.dob)return s.setState({error:{target:"dob",msg:"Required!"}});if((""===s.state.bank_id||null===s.state.bank_id)&&s.props.required.bank_id)return s.setState({error:{target:"bank_id",msg:"Required!"}});if(""===s.state.bank_account||null===s.state.bank_account)return s.setState({error:{target:"bank_account",msg:"Required!"}});if(""===s.state.graduation_date&&s.props.required.graduation_date)return s.setState({error:{target:"graduation_date",msg:"Required!"}});if(null===s.state.specialization_id||""===s.state.specialization_id)return s.setState({error:{target:"specialization_id",msg:"Required!"}});if((null===s.state.contract_type||""===s.state.contract_type)&&s.props.required.contract_type)return s.setState({error:{target:"contract_type",msg:"Required!"}});if(""===s.state.hired_date&&s.props.required.hired_date)return s.setState({error:{target:"hired_date",msg:"Required!"}});if(""===s.state.bank_account&&s.props.required.bank_account)return s.setState({error:{target:"bank_account",msg:"Required!"}});var a={bank_account:s.state.bank_account,bank_id:s.state.bank_id,contract_type:s.state.contract_type,dob:s.state.dob,education_domain_id:s.state.education_domain_id,education_sub_domain_id:s.state.education_domain_id,email:s.state.email,first_name:s.state.first_name,full_name:s.state.full_name,graduation_date:s.state.graduation_date,highest_qualification_id:s.state.highest_qualification_id,hired_date:s.state.hired_date,last_name:s.state.last_name,martial_status:s.state.martial_status,middle_name:s.state.middle_name,nationality_id:s.state.nationality_id,nid:s.state.nid,phone_numbers:s.state.phone_numbers,rssb_number:s.state.rssb_number,sex:s.state.sex,specialization_id:s.state.specialization_id,staff_category_id:s.state.staff_category_id,staff_code:s.state.staff_code,username:s.state.username,village_code:s.state.village_code};Object(_.T)(s.props.user_id,a,(function(e,t){!0===e?(s.setState({loading:!1,error:{target:"main-success",msg:"Staff details updated successfully"}}),s.props.success(s.props.user_id,a)):s.setState({loading:!1,error:{target:"main-error",msg:t}}),setTimeout((function(){s.setState({error:{target:null,msg:""}})}),3e3)}))},s.state={loading_assets:!0,loading:!1,error:{target:null,msg:""},nid:"",first_name:"",middle_name:"",last_name:"",full_name:"",phone_numbers:"",email:"",username:"",staff_code:"",sex:"",martial_status:"",highest_qualification_id:"",dob:"",rssb_number:"",nationality_id:"",bank_account:"",bank_id:"",village_code:"",staff_category_id:"",specialization_id:"",contract_type:"",graduation_date:"",education_domain_id:"",education_sub_domain_id:"",hired_date:"",specialization_open:!1},s}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;!0===this.props.basic.register_assets.loading||null===this.props.basic.register_assets.data?this.props.FC_GetRegistrationAssets((function(t,a){!0===t?e.props.FC_GetUserDetailsInfo(e.props.user_id,(function(t,a,s){!0===t&&null!==a?e.setState({loading_assets:!1,bank_account:a.bank_account,bank_id:a.bank_id,contract_type:a.contract_type,dob:a.dob,education_domain_id:a.education_domain_id,education_sub_domain_id:a.education_sub_dommain_id,email:a.email,first_name:a.first_name,full_name:a.full_name,last_name:a.last_name,graduation_date:a.graduation_date,highest_qualification_id:a.highest_qualification_id,hired_date:a.hired_date,martial_status:a.marital_status,middle_name:a.middle_name,nationality_id:a.nationality_id,nid:a.nid,phone_numbers:a.phone_numbers,rssb_number:a.rssb_number,sex:a.sex,specialization_id:a.specialisation_id,staff_category_id:a.staff_category_id,staff_code:a.staff_code,username:a.username,village_code:a.village_code,error:{target:null,msg:""}}):e.setState({loading_assets:!1,error:{target:"main-error",msg:s}})})):e.setState({error:{target:"main-error",msg:a}})})):this.props.FC_GetUserDetailsInfo(this.props.user_id,(function(t,a,s){!0===t&&null!==a?e.setState({loading_assets:!1,bank_account:a.bank_account,bank_id:a.bank_id,contract_type:a.contract_type,dob:a.dob,education_domain_id:a.education_domain_id,education_sub_domain_id:a.education_sub_dommain_id,email:a.email,first_name:a.first_name,full_name:a.full_name,last_name:a.last_name,graduation_date:a.graduation_date,highest_qualification_id:a.highest_qualification_id,hired_date:a.hired_date,martial_status:a.marital_status,middle_name:a.middle_name,nationality_id:a.nationality_id,nid:a.nid,phone_numbers:a.phone_numbers,rssb_number:a.rssb_number,sex:a.sex,specialization_id:a.specialization_id,staff_category_id:a.staff_category_id,staff_code:a.staff_code,username:a.username,village_code:a.village_code,error:{target:null,msg:""}}):e.setState({loading_assets:!1,error:{target:"main-error",msg:s}})}))}},{key:"render",value:function(){var e=this;if(!0===this.props.basic.register_assets.loading||null===this.props.basic.register_assets.data)return Object(N.jsxs)(b.a,{children:[Object(N.jsx)("div",{className:"py-6 mx-auto text-center",children:Object(N.jsx)(j.a,{})}),Object(N.jsx)("h3",{className:"pt-3 font-bold text-lg text-center",children:"Loading..."})]});if(!0===this.state.loading_assets)return Object(N.jsxs)(b.a,{children:[Object(N.jsx)("div",{className:"py-6 mx-auto text-center",children:Object(N.jsx)(j.a,{})}),Object(N.jsx)("h3",{className:"pt-3 font-bold text-lg text-center",children:"Loading profile info..."})]});var t=this.props.basic.register_assets.data,a=t.specializations.find((function(t){return t.specialization_id===e.state.specialization_id}));return Object(N.jsxs)(N.Fragment,{children:["main-error"===this.state.error.target&&Object(N.jsx)(h.a,{theme:"danger",fixed:!0,children:this.state.error.msg}),"main-success"===this.state.error.target&&Object(N.jsx)(h.a,{theme:"success",fixed:!0,children:this.state.error.msg}),Object(N.jsxs)(b.a,{className:"animate__animated animate__zoomIn animate__faster",children:[Object(N.jsxs)("div",{className:"py-2 flex items-center border-b",children:[Object(N.jsx)("div",{className:"flex-1 opacity-70",children:Object(N.jsx)(p.a,{children:"Update staff"})}),Object(N.jsx)("div",{className:"",children:Object(N.jsx)(v.a,{onClick:this.props.close,theme:"danger-light",children:"Close"})})]}),Object(N.jsxs)("form",{onSubmit:this.submitLogin,children:[Object(N.jsxs)("div",{className:"p-2 flex flex-wrap",children:[Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(g.a,{disabled:this.state.loading,label:"National ID/Passport(*)",name:"nid",type:"number",onChange:function(t){return e.setState({nid:t.target.value,error:{target:null,msg:""}})},value:this.state.nid,error:"nid"===this.state.error.target?this.state.error.msg:"",placeholder:"National Id",className:"p-2"})}),this.props.formAccess.first_name&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(g.a,{disabled:this.state.loading,label:"First name",name:"first_name",onChange:function(t){return e.setState({first_name:t.target.value,full_name:"".concat(null!==t.target.value?t.target.value:""," ").concat(null!==e.state.middle_name?e.state.middle_name:""," ").concat(null!==e.state.last_name?e.state.last_name:""),error:{target:null,msg:""}})},value:this.state.first_name,error:"first_name"===this.state.error.target?this.state.error.msg:"",placeholder:"First name",className:"p-2"})}),this.props.formAccess.middle_name&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(g.a,{disabled:this.state.loading,label:"Middle name",name:"middle_name",onChange:function(t){return e.setState({middle_name:t.target.value,full_name:"".concat(null!==e.state.first_name?e.state.first_name:""," ").concat(null!==t.target.value?t.target.value:""," ").concat(null!==e.state.last_name?e.state.last_name:""),error:{target:null,msg:""}})},value:this.state.middle_name,error:"middle_name"===this.state.error.target?this.state.error.msg:"",placeholder:"Middle name",className:"p-2"})}),this.props.formAccess.last_name&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(g.a,{disabled:this.state.loading,label:"Last name",name:"last_name",onChange:function(t){return e.setState({last_name:t.target.value,full_name:"".concat(null!==e.state.first_name?e.state.first_name:""," ").concat(null!==e.state.middle_name?e.state.middle_name:""," ").concat(null!==t.target.value?t.target.value:""),error:{target:null,msg:""}})},value:this.state.last_name,error:"last_name"===this.state.error.target?this.state.error.msg:"",placeholder:"Last name",className:"p-2"})}),this.props.formAccess.full_name&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(g.a,{disabled:!0,label:"Full name",name:"full_name",onChange:function(e){},value:this.state.full_name,error:"full_name"===this.state.error.target?this.state.error.msg:"",placeholder:"Full name",className:"p-2"})}),this.props.formAccess.phone_numbers&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(g.a,{disabled:this.state.loading,label:"Phone number",name:"phone_numbers",onChange:function(t){return e.setState({phone_numbers:t.target.value,error:{target:null,msg:""}})},value:this.state.phone_numbers,error:"phone_numbers"===this.state.error.target?this.state.error.msg:"",placeholder:"0700000000",className:"p-2"})}),this.props.formAccess.email&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(g.a,{disabled:this.state.loading,label:"email",name:"email",onChange:function(t){return e.setState({email:t.target.value,error:{target:null,msg:""}})},value:this.state.email,error:"email"===this.state.error.target?this.state.error.msg:"",placeholder:"my@email.com",className:"p-2"})}),this.props.formAccess.username&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(g.a,{disabled:this.state.loading,label:"Username (your number)",name:"username",onChange:function(t){return e.setState({username:t.target.value,error:{target:null,msg:""}})},value:this.state.username,error:"username"===this.state.error.target?this.state.error.msg:"",placeholder:"0780000000",className:"p-2"})}),this.props.formAccess.staff_code&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(g.a,{disabled:this.state.loading,label:"Staff code",name:"staff_code",onChange:function(t){return e.setState({staff_code:t.target.value,error:{target:null,msg:""}})},value:this.state.staff_code,error:"staff_code"===this.state.error.target?this.state.error.msg:"",placeholder:"Staff code",className:"p-2"})}),this.props.formAccess.sex&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(f.a,{data:[{title:this.state.sex?this.state.sex:"",value:this.state.sex?this.state.sex:""},{title:"",value:""},{title:"MALE",value:"MALE"},{title:"FEMALE",value:"FEMALE"}],error:"sex"===this.state.error.target?this.state.error.msg:"",value:this.state.sex,onChange:function(t){return e.setState({sex:t.target.value,error:{target:null,msg:""}})},label:"Gender",name:"gender",placeholder:"Select gender"})}),this.props.formAccess.martial_status&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(f.a,{data:[{title:this.state.martial_status?this.state.martial_status:"",value:this.state.martial_status?this.state.martial_status:""}].concat(Object(r.a)(t.marital.map((function(e){return{title:e,value:e}})))),error:"martial_status"===this.state.error.target?this.state.error.msg:"",value:this.state.martial_status,onChange:function(t){e.setState({martial_status:t.target.value,error:{target:null,msg:""}})},label:"Martial Status",name:"matrias_status",placeholder:"Select a value"})}),this.props.formAccess.rssb_number&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(g.a,{disabled:this.state.loading,label:"RSSB Number",name:"rssb_number",onChange:function(t){return e.setState({rssb_number:t.target.value,error:{target:null,msg:""}})},value:this.state.rssb_number,error:"rssb_number"===this.state.error.target?this.state.error.msg:"",placeholder:"RSSB number",className:"p-2"})}),this.props.formAccess.highest_qualification_id&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(f.a,{data:[{title:"",value:""}].concat(Object(r.a)(this.props.basic.qualifications.map((function(e){return{value:e.qualification_id,title:e.qualification_name}})))),error:"highest_qualification_id"===this.state.error.target?this.state.error.msg:"",value:this.state.highest_qualification_id,onChange:function(t){return e.setState({highest_qualification_id:t.target.value,error:{target:null,msg:""}})},label:"Highest Qualification",name:"highest_qualification",placeholder:"Select a highest qualification"})}),this.props.formAccess.nationality_id&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(f.a,{data:[{title:"",value:"Select a country"}].concat(Object(r.a)(t.nationality.map((function(e){return{title:e.country,value:e.country_id}})))),error:"nationality_id"===this.state.error.target?this.state.error.msg:"",value:this.state.nationality_id,onChange:function(t){return e.setState({nationality_id:t.target.value,error:{target:null,msg:""}})},label:"Nationality",name:"nationality",placeholder:"Select a country"})}),this.props.formAccess.dob&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(g.a,{disabled:this.state.loading,label:"Date of birth",name:"dob",type:"date",onChange:function(t){return e.setState({dob:t.target.value,error:{target:null,msg:""}})},value:this.state.dob,error:"dob"===this.state.error.target?this.state.error.msg:"",placeholder:"DOB",className:"p-2"})}),this.props.formAccess.bank_id&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(f.a,{data:[{title:"",value:""}].concat(Object(r.a)(t.banks.map((function(e){return{title:e.bank,value:e.bank_id}})))),error:"bank_id"===this.state.error.target?this.state.error.msg:"",value:this.state.bank_id,onChange:function(t){return e.setState({bank_id:t.target.value,error:{target:null,msg:""}})},label:"Select a bank",name:"bank",placeholder:"Select bank"})}),this.props.formAccess.bank_account&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(g.a,{disabled:this.state.loading,label:"Bank Account",name:"bank_account",type:"number",onChange:function(t){return e.setState({bank_account:t.target.value,error:{target:null,msg:""}})},value:this.state.bank_account,error:"bank_account"===this.state.error.target?this.state.error.msg:"",placeholder:"Bank account",className:"p-2"})}),this.props.formAccess.village_code&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(g.a,{disabled:this.state.loading,label:"Village",name:"village_code",onChange:function(t){return e.setState({village_code:t.target.value,error:{target:null,msg:""}})},value:this.state.village_code,error:"village_code"===this.state.error.target?this.state.error.msg:"",placeholder:"Village",className:"p-2"})}),this.props.formAccess.graduation_date&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(g.a,{disabled:this.state.loading,label:"Graduation date",name:"graduation_date",type:"date",onChange:function(t){return e.setState({graduation_date:t.target.value,error:{target:null,msg:""}})},value:this.state.graduation_date,error:"graduation_date"===this.state.error.target?this.state.error.msg:"",placeholder:"Graduation date",className:"p-2"})}),this.props.formAccess.specialization_id&&Object(N.jsx)(N.Fragment,{children:this.state.specialization_open?Object(N.jsxs)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:[Object(N.jsx)("label",{className:"block",children:"Specialization"}),Object(N.jsx)(O.a,{click:function(t){return e.setState({specialization_id:t.specialization_id,specialization_open:!1})},close:function(){return e.setState({specialization_open:!1})},data:[{value:"",title:""}].concat(Object(r.a)(t.specializations.map((function(e){return{specialization_id:e.specialization_id,specialization_name:e.specialization_name}})))),id:"specialization_id",title:"specialization_name",loading:this.state.loading})]}):Object(N.jsx)("div",{onClick:function(){return e.setState({specialization_open:!0})},className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(g.a,{error:"specialization_id"===this.state.error.target?this.state.error.msg:"",label:"Specialization",name:"",onChange:function(e){},placeholder:"",value:void 0===a?"":a.specialization_name})})}),this.props.formAccess.contract_type&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(f.a,{data:[{title:this.state.contract_type?this.state.contract_type:"",value:this.state.contract_type?this.state.contract_type:""}].concat(Object(r.a)(t.contract_types.map((function(e){return{value:e,title:e}})))),error:"contract_type"===this.state.error.target?this.state.error.msg:"",value:this.state.contract_type,onChange:function(t){return e.setState({contract_type:t.target.value,error:{target:null,msg:""}})},label:"Contract type",name:"staff_category",placeholder:"Select category"})}),this.props.formAccess.hired_date&&Object(N.jsx)("div",{className:"w-full lg:w-1/2 py-1 px-3",children:Object(N.jsx)(g.a,{disabled:this.state.loading,label:"Date of hire (Date in education)",name:"hired_date",onChange:function(t){return e.setState({hired_date:t.target.value,error:{target:null,msg:""}})},value:this.state.hired_date,error:"hired_date"===this.state.error.target?this.state.error.msg:"",type:"date",placeholder:"Hired date",className:"p-2"})})]}),Object(N.jsxs)("div",{className:"px-6 text-right flex",children:[Object(N.jsx)("div",{className:"flex-1",children:null!==this.state.error.target&&"main-error"!==this.state.error.target&&"main-success"!==this.state.error.target&&Object(N.jsx)("div",{className:"text-sm text-red-400 pr-4",children:"Some fields are required!"})}),Object(N.jsx)("div",{className:"",children:Object(N.jsx)(v.a,{type:"submit",size:"lg",loading:this.state.loading,children:"Update staff details"})})]})]}),Object(N.jsx)("div",{className:"bg-gray-100 py-1 mt-4 rounded",children:""!==this.state.staff_code?Object(N.jsx)(y.b,{allowEdit:!0,staff_code:this.state.staff_code,full_name:this.state.full_name}):Object(N.jsx)("div",{className:"bg-gray-100 rounded-md px-6 py-3 font-extrabold text-gray-500 text-center text-2xl",children:"Loading, please wait..."})})]})]})}}]),a}(u.a.Component),q=Object(m.b)((function(e){return{auth:e.auth,basic:e.basic}}),{FC_GetRegistrationAssets:_.u,FC_GetUserDetailsInfo:_.G})(S),w=a(124),k=a(18),C=a(7),z=a(23),A=a(3),R=a.n(A),U=a(5),D=a.n(U),F=a(13),P=function(e){var t=Object(d.useState)(null),a=Object(z.a)(t,2),s=a[0],r=a[1],i=Object(d.useState)(null),n=Object(z.a)(i,2),l=n[0],o=n[1],c=Object(d.useState)(!1),u=Object(z.a)(c,2),m=u[0],h=u[1],b=Object(d.useState)(""),p=Object(z.a)(b,2),f=p[0],g=p[1],x=Object(d.useState)(null),v=Object(z.a)(x,2),O=v[0],y=v[1],S=function(){var t=Object(C.a)(R.a.mark((function t(){var a,r;return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.auth.user||""===f){t.next=18;break}return h(!0),t.prev=2,t.next=5,D.a.post("".concat(F.c,"/user/assign/position"),{user_id:e.user.user_id,school_code:e.school.school_code,position_code:f});case 5:a=t.sent,null!==s&&void 0!==(r=s.find((function(e){return e.position_code===f})))&&(y(r.position_name),e.updateUserPosition(e.user.user_id,r.position_name)),console.log("Success: ",a),e.close&&e.close(),alert("User position assignment done successfully!"),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),console.log("Err: ",t.t0);case 15:h(!1),t.next=19;break;case 18:alert("Please select a position!");case 19:case"end":return t.stop()}}),t,null,[[2,12]])})));return function(){return t.apply(this,arguments)}}(),q=function(){return console.log("Test schoolPosition: ",s),console.log("Test schoolPositionTest: ",l),null!==s?s.filter((function(t){return t.qualification_name===e.user.qualification&&null!==s})):[]};return Object(d.useEffect)((function(){null===s&&e.basic.academic_calender&&Object(_.B)(e.school.school_code,e.basic.academic_calender.academic_year_id,(function(e,t,a){h(!0),!0===e&&null!==t&&(r(t.school_positions),o(t.school_post_requests),h(!1))}))})),Object(N.jsxs)("div",{className:"px-4 pb-4 bg-gray-50 border-t rounded-b",children:[Object(N.jsxs)("div",{children:[Object(N.jsx)("div",{children:"School name: "}),Object(N.jsxs)("div",{className:"text-xl font-bold",children:[e.school.school_name," (",e.school.school_code,")"]})]}),Object(N.jsxs)("div",{children:[Object(N.jsx)("div",{children:"Teacher: "}),Object(N.jsxs)("div",{className:"text-xl font-bold text-primary-800",children:[e.user.first_name," ",e.user.last_name," (",e.user.role,")"]})]}),!0===m?Object(N.jsx)("div",{className:"flex flex-col items-center justify-center w-full p-3 rounded",children:Object(N.jsx)(j.a,{})}):null!==O?Object(N.jsxs)("div",{children:[Object(N.jsx)("div",{children:"Submitted position: "}),Object(N.jsx)("div",{className:"text-xl font-bold text-green-700 bg-green-100 rounded-lg px-4 py-2",children:O})]}):null!==e.user.position&&Object(N.jsxs)("div",{children:[Object(N.jsx)("div",{children:"Current position: "}),Object(N.jsx)("div",{className:"text-xl font-bold text-green-700 bg-green-100 rounded-lg px-4 py-2",children:e.user.position})]}),!0===m||null===s||!0===e.loading?Object(N.jsx)("div",{className:"text-2xl font-bold text-yellow-700 text-center",children:"Loading, Please wait..."}):Object(N.jsxs)("div",{children:[Object(N.jsxs)("div",{children:[null===e.user.position?"Choose position for (".concat(e.user.qualification,")"):"Update position for (".concat(e.user.qualification,")"),":"," "]}),Object(N.jsx)("div",{children:0===q().length?Object(N.jsxs)("div",{className:"bg-red-100 text-red-900 font-bold px-4 py-2 text-xl rounded",children:["No available posts on your qualification (",e.user.qualification,")"]}):Object(N.jsxs)("select",{value:f,onChange:function(e){return g(e.target.value)},className:"px-3 py-2 rounded-md w-full border-2 border-primary-900",children:[Object(N.jsx)("option",{value:"",children:"Choose school position"}),q().filter((function(t){return t.position_name!==e.user.position})).map((function(e,t){return Object(N.jsx)("option",{value:e.position_code,children:e.position_name+" ("+e.qualification_name+")  in "+e.school_level_name},t+1)}))]})})]}),!1===m&&Object(N.jsxs)("div",{className:"flex flex-row justify-between mt-2",children:[Object(N.jsx)("div",{onClick:function(){return e.close&&e.close()},className:"bg-gray-200 text-black px-4 py-2 rounded cursor-pointer w-max",children:"Cancel"}),Object(N.jsx)("div",{onClick:function(){S()},className:"bg-primary-800 text-white px-4 py-2 rounded cursor-pointer w-max",children:"Submit"})]})]})},I=function(e){Object(o.a)(a,e);var t=Object(c.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).submitLogin=function(e){e.preventDefault()},s.componentDidMount=function(){s.startApp()},s.DisableUser=function(e){console.log("deleting candidate"),!0===window.confirm("Are you sure you want to deactivate this user?")&&(s.setState({disable_user_loading:!0}),s.props.FC_DisableUser(e,(function(t,a){!0===t?s.setState({data:s.state.data.filter((function(t){return t.user_id!==e})),disable_user_loading:!1}):s.setState({disable_user_loading:!1,error:{target:"main-error",msg:a}})})))},s.startApp=function(){if(null===s.props.basic.academic_calender)s.setState({error:{target:"main-error",msg:"Failed to load data, please reload data"}});else if(null===s.props.auth.school&&void 0===s.props.school_code)s.setState({error:{target:"main-error",msg:"No school assigned to you"}});else{var e,t=void 0===s.props.school_code?null===(e=s.props.auth.school)||void 0===e?void 0:e.school_code:s.props.school_code;if(s.setState({error:{target:null,msg:""},loading_data:!0}),void 0===t)return s.setState({error:{target:"main-error",msg:"Invalid school ID"}});Object(_.F)(t,(function(e,t,a){!0===e&&null!==t?(console.log({status:e,data:t,msg:a}),s.setState({loading_data:!1,data:t.staff.filter((function(e){return"Active"===e.status})),roles:t.role})):s.setState({loading_data:!1,error:{msg:a,target:"main-error"}})}))}},s.state={disable_user_loading:!1,loading:!1,data:[],roles:[],error:{target:null,msg:""},loading_data:!0,selected_role:"",selected_request_id:"",selected_value:"0",selected_comment:"",selected_auto_level:"",search:"",selected_qualification:"",edit_staff_id:"",addUserPositions:null,view_staff_id:"",change_teacher_post:null,school_register_assets:null,school_register_assets_loading:!0,selected_position_id:"",selected_qualification_id:"",selected_school_code:""},s}return Object(l.a)(a,[{key:"render",value:function(){var e,t=this;if("main-error"===this.state.error.target)return Object(N.jsx)(h.a,{theme:"danger",fixed:!0,children:this.state.error.msg});var a=""===this.state.selected_role?this.state.data:this.state.data.filter((function(e){return e.role_id===t.state.selected_role})),n=a.filter((function(e){return!(null==e.first_name||""===e.first_name)})).length;return a=""===this.state.selected_qualification?a:a.filter((function(e){return e.qualification===t.state.selected_qualification})),a=Object(k.f)(a,this.state.search,{email:!0,first_name:!0,full_name:!0,last_name:!0,phone_numbers:!0,qualification:!0,role:!0,role_id:!0,status:!0,user_id:!0,username:!0,nid:!0}),!0===this.state.loading_data?Object(N.jsx)("div",{className:"p-8 text-center",children:Object(N.jsx)("div",{className:"mx-auto",children:Object(N.jsx)(j.a,{})})}):""!==this.state.edit_staff_id?Object(N.jsx)(q,{user_id:this.state.edit_staff_id,success:function(e,a){t.setState({data:t.state.data.map((function(t){return t.user_id===e?Object(i.a)(Object(i.a)({},t),{},{email:a.email,first_name:a.first_name,full_name:a.full_name,last_name:a.last_name,phone_numbers:a.phone_numbers,username:a.username}):t}))})},formAccess:{first_name:!0,middle_name:!0,last_name:!0,full_name:!0,phone_numbers:!0,email:!0,username:!0,staff_code:!0,sex:!0,martial_status:!0,highest_qualification_id:!0,dob:!0,rssb_number:!0,nationality_id:!0,bank_account:!0,bank_id:!0,specialization_id:!0,village_code:!1,contract_type:!0,education_domain_id:!0,education_sub_domain_id:!0,graduation_date:!0,hired_date:!0,staff_category_id:!0},required:{first_name:!0,middle_name:!1,last_name:!0,full_name:!0,phone_numbers:!0,email:!1,username:!0,staff_code:!0,sex:!0,martial_status:!0,highest_qualification_id:!0,dob:!0,rssb_number:!0,nationality_id:!0,bank_account:!0,bank_id:!0,specialization_id:!0,village_code:!1,contract_type:!0,education_domain_id:!0,education_sub_domain_id:!0,graduation_date:!0,hired_date:!0,staff_category_id:!0},close:function(){return t.setState({edit_staff_id:""})}}):!Object(k.e)(this.state.view_staff_id)&&null===this.state.addUserPositions&&Object(k.e)(this.state.edit_staff_id)?Object(N.jsx)(w.UserProfile,{isExternal:!0,user_id:this.state.view_staff_id,close:function(){return t.setState({view_staff_id:""})},setEditStaff:function(e){return t.setState({edit_staff_id:e})},user_data:a.find((function(e){return e.user_id===t.state.view_staff_id})),setAddUserPositions:function(e){return t.setState({addUserPositions:e})},DisableUser:function(e){return t.DisableUser(e)}}):Object(N.jsxs)(d.Fragment,{children:[Object(N.jsxs)(N.Fragment,{children:["main-success"===this.state.error.target&&Object(N.jsx)(h.a,{theme:"success",fixed:!0,children:this.state.error.msg}),"main-success"===this.state.error.target&&Object(N.jsx)(h.a,{theme:"success",fixed:!0,children:this.state.error.msg}),!0===this.state.disable_user_loading&&Object(N.jsx)(h.a,{theme:"info",fixed:!0,children:Object(N.jsx)("span",{className:"animate__animated animate__fadeIn animate__infinite",children:"Disabling..."})}),Object(N.jsxs)(b.a,{children:["main"===this.state.error.target&&Object(N.jsx)(h.a,{theme:"danger",children:this.state.error.msg}),"loading-update-error"===this.state.error.target&&Object(N.jsx)(h.a,{theme:"danger",children:this.state.error.msg}),Object(N.jsxs)("div",{className:"flex items-center",children:[Object(N.jsxs)("div",{className:"flex-1",children:[Object(N.jsx)(p.a,{children:"Staff list"}),Object(N.jsx)("p",{className:"opacity-60 text-lg -mt-1 font-bold text-accent-900 dark:text-accent-800",children:null===(e=this.props.auth.school)||void 0===e?void 0:e.school_name})]}),Object(N.jsx)("div",{className:""})]}),Object(N.jsxs)("div",{className:"mt-3",children:[Object(N.jsxs)("div",{className:"border border-t mt-2 mb-1 flex items-center pl-3 pr-2 rounded",children:[Object(N.jsx)("div",{className:"flex-1 pr-2",children:Object(N.jsx)(g.a,{error:"",label:"Search",name:"",type:"search",onChange:function(e){return t.setState({search:e.target.value})},placeholder:"Search by name, nid",value:this.state.search,size:"sm"})}),!this.props.auth.school&&Object(N.jsx)("div",{className:"",children:Object(N.jsx)(f.a,{data:[{title:"All Occupations",value:""}].concat(Object(r.a)(this.state.roles.map((function(e){return{title:e.role,value:e.role_id}})))),error:"",name:"select_role",onChange:function(e){return t.setState({selected_role:e.target.value})},label:"Occupation",placeholder:"Select Occupation",value:this.state.selected_role,size:"sm"})}),null!==this.props.basic.qualifications&&Object(N.jsx)("div",{className:"px-2",children:Object(N.jsx)(f.a,{data:[{title:"All",value:""}].concat(Object(r.a)(this.props.basic.qualifications.map((function(e){return{title:e.qualification_name,value:e.qualification_name}})))),error:"",name:"select_qualification",onChange:function(e){return t.setState({selected_qualification:e.target.value})},label:"Qualification",placeholder:"Select Qualification",value:this.state.selected_qualification,size:"sm"})}),Object(N.jsxs)("div",{className:"p-2 px-3 ml-3 bg-accent-800 bg-opacity-30 rounded",children:[Object(N.jsx)("label",{className:"",children:"Results:"}),Object(N.jsx)("h4",{className:"text-2xl -mt-1 font-bold",children:a.length})]})]}),Object(N.jsxs)("div",{className:"pb-2",children:["Non validated: ",Object(N.jsx)("b",{children:n})]}),Object(N.jsxs)("table",{className:"w-full text-left table-auto",children:[Object(N.jsx)("thead",{children:Object(N.jsxs)("tr",{children:[Object(N.jsx)("th",{className:"p-2 border",children:"#"}),Object(N.jsx)("th",{className:"p-2 border",children:"NID/Passport"}),Object(N.jsx)("th",{className:"p-2 border",children:"Staff code"}),Object(N.jsx)("th",{className:"p-2 border",children:"Names"}),Object(N.jsx)("th",{className:"p-2 border",children:"Phone number"}),Object(N.jsx)("th",{className:"p-2 border",children:"Position"}),Object(N.jsx)("th",{className:"p-2 border",children:"Occupation"}),Object(N.jsx)("th",{className:"p-2 border",children:"Validated"}),null!==this.props.auth.role&&"2"!==this.props.auth.role.role_id&&"1"!==this.props.auth.role.role_id&&Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("th",{className:"p-2 border",children:"Qualification"}),Object(N.jsx)("th",{className:"p-2 border",children:"School"})]}),void 0===this.props.school_code&&Object(N.jsx)("th",{})]})}),Object(N.jsx)("tbody",{children:a.length<=0?Object(N.jsx)("tr",{children:Object(N.jsx)("td",{colSpan:8,className:"p-8 border rounded border-opacity-25 animate__animated animate__fadeIn text-center",children:Object(N.jsx)(p.a,{size:"md",className:"opacity-60 font-light",children:"No results found"})})}):a.map((function(e,a){var s;return Object(N.jsx)(d.Fragment,{children:Object(N.jsxs)("tr",{className:"group border rounded hover:bg-blue-500 hover:bg-opacity-20 text-sm",children:[Object(N.jsx)("td",{className:"p-2 border",children:a+1},a),Object(N.jsx)("td",{className:"p-2 border",children:e.nid}),Object(N.jsx)("td",{className:"p-2 border",children:e.staff_code}),Object(N.jsx)("td",{className:"p-2 border",children:e.full_name}),Object(N.jsx)("td",{className:"p-2 border",children:e.phone_numbers}),Object(N.jsx)("td",{className:"p-2 border",children:e.position}),Object(N.jsx)("td",{className:"p-2 border",children:e.role}),Object(N.jsx)("td",{className:"w-24 text-center",children:null==e.first_name||""===e.first_name?Object(N.jsx)("span",{className:"text-xs bg-red-400 text-white p-0.5 rounded-full",children:"Non-Validated"}):Object(N.jsx)("span",{className:"text-xs bg-green-500 text-white p-0.5 rounded-full",children:"Validated"})}),null!==t.props.auth.role&&"2"!==t.props.auth.role.role_id&&"1"!==t.props.auth.role.role_id&&Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("td",{className:"p-2 border",children:e.qualification}),Object(N.jsx)("td",{className:"p-2 border",children:null===(s=e.school)||void 0===s?void 0:s.school_name})]}),void 0===t.props.school_code&&Object(N.jsx)("td",{className:"p-1 border",children:Object(N.jsx)("button",{onClick:function(){return t.setState({view_staff_id:e.user_id})},className:"opacity-80 group-hover:opacity-100 bg-accent-800 bg-opacity-0 hover:bg-opacity-10 text-accent-900 font-semibold py-2 px-4 rounded",children:"View"})})]})},a)}))})]})]})]})]}),null!==this.state.addUserPositions&&null!==this.props.auth.school&&Object(N.jsx)(x.c,{backDrop:!0,theme:x.b.default,close:function(){t.setState({addUserPositions:null})},backDropClose:!1,widthSizeClass:x.a.large,displayClose:!0,title:Object(N.jsx)("div",{className:"text-2xl w-full text-primary-800 -mb-2",children:"ADD USER POSITION"}),padding:{title:!0},children:Object(N.jsx)(P,{user:this.state.addUserPositions,school:this.props.auth.school,auth:this.props.auth,loading:this.state.loading,basic:this.props.basic,close:function(){return t.setState({addUserPositions:null})},updateUserPosition:function(e,a){var r,i=[],n=Object(s.a)(t.state.data);try{for(n.s();!(r=n.n()).done;){var l=r.value;l.user_id===e?i.push({email:l.email,first_name:l.first_name,full_name:l.full_name,last_name:l.last_name,phone_numbers:l.phone_numbers,qualification:l.qualification,role:l.role,role_id:l.role_id,status:l.status,user_id:l.user_id,position:a,username:l.username,bank_account:l.bank_account,dob:l.dob,marital_status:l.marital_status,nationality_id:l.nationality_id,nid:l.nid,rssb_number:l.rssb_number,location:l.location,school:l.school,sex:l.sex,specialization:l.specialization,staff_category:l.staff_category,staff_code:l.staff_code,start_date_in_the_school:l.start_date_in_the_school,teacher_hierarch:l.teacher_hierarch}):i.push(l)}}catch(o){n.e(o)}finally{n.f()}t.setState({data:i})}})})]})}}]),a}(u.a.Component),L=Object(m.b)((function(e){return{auth:e.auth,basic:e.basic}}),{FC_DisableUser:_.h})(I)},138:function(e,t,a){"use strict";a.r(t),a.d(t,"TeachersList",(function(){return i}));a(2);var s=a(129),r=a(1),i=function(){return Object(r.jsx)(s.a,{})}}}]);
//# sourceMappingURL=27.002f6704.chunk.js.map