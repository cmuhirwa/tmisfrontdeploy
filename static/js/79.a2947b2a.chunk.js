(this.webpackJsonpTMIS=this.webpackJsonpTMIS||[]).push([[79],{586:function(e,t,s){"use strict";s.r(t),s.d(t,"_SystemUsersList",(function(){return m})),s.d(t,"SystemUsersList",(function(){return g}));var r=s(19),l=s(20),a=s(21),c=s(22),n=s(4),i=s(36),d=s(13),o=s(53),p=s(54),j=s(25),h=s(15),u=s(448),x=s(26),b=s(1),m=function(e){Object(a.a)(s,e);var t=Object(c.a)(s);function s(e){var l;return Object(r.a)(this,s),(l=t.call(this,e)).setLoading=function(e){l.setState({loading:e})},l.nextPage=function(){var e=l.state.selected_page+1;l.pageNumbersList().length>l.state.selected_page&&(l.setState({selected_page:e}),l.LoadByPage(e,l.state.page_limit,l.state.selected_role_id,!1))},l.previousPage=function(){var e=1===l.state.selected_page?1:l.state.selected_page-1;l.setState({selected_page:e}),l.LoadByPage(e,l.state.page_limit,l.state.selected_role_id,!1)},l.pageNumbersList=function(){for(var e=null!==l.props.systemUsers.users?parseInt(l.props.systemUsers.users[0].total_users)/l.state.page_limit+(parseInt(l.props.systemUsers.users[0].total_users)%l.state.page_limit>0?1:0):0,t=[],s=1;s<=e;s++)t.push(s);return 0===t.length?[1]:t},l.LoadByPage=function(e,t,s,r){l.setState({selected_page:e}),null!==l.props.systemUsers.users&&void 0!==l.props.systemUsers.users.find((function(t){return t.page_number===e}))&&!0!==r||l.props.FC_LoadSystemUsers(s,t,e,r,l.setLoading)},l.FilteredData=function(){if(null!==l.props.systemUsers.users){var e=l.props.systemUsers.users.find((function(e){return e.page_number===l.state.selected_page}));if(void 0!==e){var t=e.users;return null!==l.state.selected_gender&&""!==l.state.selected_gender&&(t=t.filter((function(e){return e.sex===l.state.selected_gender}))),Object(h.v)(t,l.state.search_value)}}return[]},l.componentDidMount=function(){null===l.props.basic.roles&&l.props.FC_GetAllSystemRoles((function(e,t){})),l.LoadByPage(l.state.selected_page,l.state.page_limit,l.state.selected_role_id,!0)},l.changeRole=function(e){l.setState({selected_role_id:e,selected_page:1}),l.LoadByPage(1,l.state.page_limit,e,!0)},l.changePageLimit=function(e){l.setState({page_limit:parseInt(e),selected_page:1}),l.LoadByPage(1,parseInt(e),l.state.selected_role_id,!0)},l.state={loading:!1,selected_role_id:"3",selected_page:1,page_limit:100,selected_gender:null,search_value:"",selectedUser:null},l}return Object(l.a)(s,[{key:"render",value:function(){var e,t=this;return null===this.props.basic.roles||null===this.props.systemUsers.users||!0===this.state.loading?Object(b.jsxs)("div",{className:"bg-white rounded-md p-4 flex flex-col items-center justify-center m-5",children:[Object(b.jsx)(j.a,{}),Object(b.jsx)("div",{className:"text-xl",children:"Loading, please wait..."})]}):Object(b.jsx)(n.Fragment,{children:Object(b.jsx)("div",{children:Object(b.jsx)(o.a,{children:null===this.state.selectedUser?Object(b.jsxs)("div",{children:[Object(b.jsxs)("div",{className:"flex flex-row items-center justify-between gap-3",children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("span",{className:"text-3xl font-bold",children:"System users"}),Object(b.jsxs)("div",{className:"flex flex-row items-center gap-2 -mt-1",children:[Object(b.jsx)("span",{className:"text-base text-gray-500",children:"System users"}),""!==this.state.selected_role_id&&Object(b.jsx)(p.e,{className:"text-2xl -mx-2 text-gray-500"}),Object(b.jsx)("span",{className:"text-base font-bold text-primary-800 underline",children:null===(e=this.props.basic.roles.find((function(e){return e.role_id===t.state.selected_role_id})))||void 0===e?void 0:e.role}),null!==this.state.selected_gender&&""!==this.state.selected_gender&&Object(b.jsx)(p.e,{className:"text-2xl -mx-2 text-gray-500"}),null!==this.state.selected_gender&&""!==this.state.selected_gender&&Object(b.jsx)("span",{className:"text-base font-bold text-primary-800 underline",children:this.state.selected_gender})]})]}),Object(b.jsx)("div",{children:Object(b.jsxs)("div",{className:"flex flex-row items-center justify-end gap-3",children:[Object(b.jsxs)("div",{className:"text-right",children:[Object(b.jsx)("div",{className:"text-sm text-gray-500",children:"Total users"}),Object(b.jsx)("div",{className:"text-2xl -mt-1 font-bold",children:null!==this.props.systemUsers.users&&this.props.systemUsers.users.length>0?parseInt(this.props.systemUsers.users[0].total_users).toLocaleString():0})]}),Object(b.jsx)("div",{children:Object(b.jsx)(x.b,{to:"/register-administration-staff",className:"btn bg-accent-900 hover:bg-yellow-900 text-white cursor-pointer px-3 py-2 rounded font-bold",children:"Add new staff"})})]})})]}),Object(b.jsxs)("div",{className:"mt-3",children:[Object(b.jsx)("div",{className:"text-sm",children:"Filter by:"}),Object(b.jsxs)("div",{className:"flex flex-row items-center gap-3 w-full",children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:"font-bold text-sm",children:"Rows"}),Object(b.jsx)("div",{children:Object(b.jsx)("select",{onChange:function(e){return t.changePageLimit(e.target.value)},value:this.state.page_limit,className:"border border-gray-400 px-3 py-2 rounded",children:[10,20,50,100,500,1e3,5e3,1e4,5e4,1e6,1e8].map((function(e,t){return Object(b.jsx)("option",{value:e,children:e},t+1)}))})})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:"font-bold text-sm",children:"User role"}),Object(b.jsx)("div",{children:Object(b.jsxs)("select",{onChange:function(e){return t.changeRole(e.target.value)},value:this.state.selected_role_id,className:"border border-gray-400 px-3 py-2 rounded",children:[Object(b.jsx)("option",{value:"",children:"Choose user role"}),this.props.basic.roles.map((function(e,t){return Object(b.jsx)("option",{value:e.role_id,children:e.role},t+1)}))]})})]}),Object(b.jsxs)("div",{children:[console.log("Gender: ",this.state.selected_gender),Object(b.jsx)("div",{className:"font-bold text-sm",children:"Gender"}),Object(b.jsx)("div",{children:Object(b.jsxs)("select",{value:null===this.state.selected_gender?"":this.state.selected_gender,onChange:function(e){return t.setState({selected_gender:""!==e.target.value?e.target.value:null})},className:"border border-gray-400 px-3 py-2 rounded",children:[Object(b.jsx)("option",{value:"",children:"Choose gender"}),Object(b.jsx)("option",{value:"",children:"View by all"}),Object(b.jsx)("option",{value:"MALE",children:"MALE"}),Object(b.jsx)("option",{value:"FEMALE",children:"FEMALE"})]})})]}),Object(b.jsxs)("div",{className:"w-full",children:[Object(b.jsx)("div",{className:"font-bold text-sm",children:"Search on a page"}),Object(b.jsx)("div",{className:"w-full",children:Object(b.jsx)("input",{type:"text",onChange:function(e){return t.setState({search_value:e.target.value})},placeholder:"Search keyword...",value:this.state.search_value,className:"border border-gray-400 px-3 py-2 rounded w-full"})})]})]})]}),Object(b.jsx)("div",{className:"w-full overflow-x-auto my-5",children:Object(b.jsxs)("table",{className:"min-w-full",children:[Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{className:"border-b-2 border-gray-300 text-sm",children:[Object(b.jsx)("th",{className:"p-1 py-2 text-center",children:"#"}),Object(b.jsx)("th",{className:"p-1 py-2 text-left",children:"Full name"}),Object(b.jsx)("th",{className:"p-1 py-2 text-left",children:"Gender"}),Object(b.jsx)("th",{className:"p-1 py-2 text-left",children:"National ID"}),Object(b.jsx)("th",{className:"p-1 py-2 text-left",children:"Phone"}),Object(b.jsx)("th",{className:"p-1 py-2 text-left",children:"Username"}),Object(b.jsx)("th",{className:"p-1 py-2 text-left",children:"District"}),Object(b.jsx)("th",{className:"p-1 py-2 text-left",children:"School"}),Object(b.jsx)("th",{className:"p-1 py-2"})]})}),Object(b.jsx)("tbody",{children:null===this.props.systemUsers.users?Object(b.jsx)("tr",{children:Object(b.jsx)("td",{colSpan:10,children:"Loading..."})}):0===this.FilteredData().length?Object(b.jsx)("tr",{children:Object(b.jsx)("td",{colSpan:10,children:Object(b.jsx)("div",{className:"text-center text-2xl py-5 text-gray-600 bg-gray-200 rounded-xl my-4",children:"No result found!"})})}):this.FilteredData().map((function(e,s){return Object(b.jsxs)("tr",{className:"border-b text-sm ".concat((s+1)%2===0?"bg-gray-100":""," hover:bg-yellow-50 group"),children:[Object(b.jsx)("td",{className:"p-1 py-2 text-center",children:t.state.page_limit*t.state.selected_page-t.state.page_limit+(s+1)}),Object(b.jsx)("td",{className:"p-1 py-2 text-left",children:e.full_name}),Object(b.jsx)("td",{className:"p-1 py-2 text-left",children:e.sex}),Object(b.jsx)("td",{className:"p-1 py-2 text-left",children:e.nid}),Object(b.jsx)("td",{className:"p-1 py-2 text-left",children:e.phone_numbers}),Object(b.jsx)("td",{className:"p-1 py-2 text-left",children:e.username}),Object(b.jsx)("td",{className:"p-1 py-2 text-left",children:e.district_name}),Object(b.jsx)("td",{className:"p-1 py-2 text-left",children:e.school_name}),Object(b.jsx)("td",{className:"p-1 py-2 text-right",children:Object(b.jsx)("div",{onClick:function(){return t.setState({selectedUser:e})},title:"View user profile",className:"bg-blue-100 rounded px-3 py-2 text-center font-bold cursor-pointer group-hover:bg-primary-800 group-hover:text-white",children:"View"})})]},s+1)}))}),Object(b.jsx)("tfoot",{children:Object(b.jsx)("tr",{children:Object(b.jsx)("td",{colSpan:10,className:"pt-5",children:Object(b.jsxs)("div",{className:"flex flex-row items-center justify-between gap-3",children:[Object(b.jsxs)("div",{className:"text-gray-500",children:["Showing"," ",Object(b.jsx)("span",{className:"text-black",children:this.state.page_limit*this.state.selected_page-this.state.page_limit+1})," ","to"," ",Object(b.jsx)("span",{className:"text-black",children:this.state.page_limit*this.state.selected_page})," ","of"," ",Object(b.jsx)("span",{className:"text-black font-bold",children:null!==this.props.systemUsers.users&&this.props.systemUsers.users.length>0?parseInt(this.props.systemUsers.users[0].total_users).toLocaleString():0})," ","results"]}),Object(b.jsxs)("div",{className:"flex flex-row items-center",children:[Object(b.jsx)("div",{onClick:function(){return t.previousPage()},className:"bg-gray-100 rounded-l-md border border-gray-300 hover:border-primary-800 py-2 px-3 font-bold text-gray-800 hover:text-white hover:bg-primary-800 cursor-pointer",children:"Previous"}),Object(b.jsx)("div",{children:Object(b.jsx)("select",{value:this.state.selected_page,onChange:function(e){return t.LoadByPage(parseInt(e.target.value),t.state.page_limit,t.state.selected_role_id,!1)},className:"border border-gray-400 px-3 py-2 overflow-x-auto flex flex-row items-center text-center justify-center font-extrabold",children:this.pageNumbersList().map((function(e,t){return Object(b.jsx)("option",{value:e,children:e},t+1)}))})}),Object(b.jsx)("div",{onClick:function(){return t.nextPage()},className:"bg-gray-100 rounded-r-md border border-gray-300 hover:border-primary-800 py-2 px-3 font-bold text-gray-800 hover:text-white hover:bg-primary-800 cursor-pointer",children:"Next"})]})]})})})})]})})]}):Object(b.jsx)(u.UserProfile,{user_id:null===this.state.selectedUser.staff_code?void 0:this.state.selectedUser.staff_code,isExternal:!0,user_info:null===this.state.selectedUser.user_id||null===this.state.selectedUser.username?void 0:{user_id:this.state.selectedUser.user_id,username:this.state.selectedUser.username},close:function(){return t.setState({selectedUser:null})}})})})})}}]),s}(n.Component),g=Object(i.b)((function(e){return{auth:e.auth,basic:e.basic,schoolHierarchyStore:e.schoolHierarchyStore,systemUsers:e.systemUsers}}),{FC_GetAllPositions:d.A,FC_AllSchoolHierarchyDetails:d.f,FC_GetAllSystemRoles:d.B,FC_LoadSystemUsers:d.Jb,FC_Clean_users:d.p})(m)}}]);
//# sourceMappingURL=79.a2947b2a.chunk.js.map