(this.webpackJsonpTMIS=this.webpackJsonpTMIS||[]).push([[28],{340:function(e,t,a){"use strict";a(4);var c=a(122),s=a(2);t.a=function(e){var t=e.onChange,a=e.value,r=e.error,n=e.label,i=e.placeholder,l=e.disabled,o=void 0!==l&&l,d=e.name,h=e.Input_className,j=void 0===h?"":h,b=e.Label_className,u=void 0===b?"":b,m=e.InputContainer_className,x=void 0===m?"":m,p=e.MainContainer_className,g=void 0===p?"":p,O=e.size,_=void 0===O?"md":O,f=e.data;return Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("div",{className:"w-full my-2 ".concat(g),children:[n&&Object(s.jsx)("label",{htmlFor:"login-form-email",className:"text-primary-900 dark:text-primary-100 ".concat(u),children:n}),Object(s.jsxs)("div",{className:"rounded relative ".concat(x),children:[Object(s.jsx)("select",{name:d,placeholder:i,onChange:t,className:"\n                     w-full text-lg rounded border-2 \n                     ".concat(Object(c.a)(_),"\n                     ").concat(""!==r?"border-red-500 dark:text-white bg-red-100 dark:bg-red-900 dark:bg-opacity-30":"border-primary-800 dark:text-white bg-white dark:bg-primary-900 ","\n                     px-3 ").concat(j),value:a,disabled:o,children:f.map((function(e,t){return Object(s.jsx)("option",{value:e.value,children:e.title},t)}))}),""!==r&&Object(s.jsx)("p",{className:"text-sm text-red-600 dark:text-red-500",children:r})]})]})})}},350:function(e,t,a){"use strict";var c=a(127),s=a(33),r=a(4),n=a(17),i=a(18),l=a(34),o=a(2);t.a=function(e){var t=e.loading,a=(e.id,e.title),d=e.close,h=e.data,j=e.click,b=Object(r.useState)(""),u=Object(s.a)(b,2),m=u[0],x=u[1],p=Object(i.k)(h,m,Object(c.a)({},a,!0));return Object(o.jsxs)("div",{className:" bg-gray-100 shadow-lg border-gray-500 border-2 h-64 rounded-md flex flex-col",children:[Object(o.jsxs)("div",{className:"p-1 bg-white rounded flex items-center",children:[Object(o.jsx)("label",{htmlFor:"search-input-data",children:Object(o.jsx)(n.eb,{className:"text-2xl"})}),Object(o.jsx)("input",{type:"search",className:"py-1 px-1 flex-1",placeholder:"Search",value:m,id:"search-input-data",onChange:function(e){return x(e.target.value)}}),!1===t&&Object(o.jsx)("button",{onClick:function(){return d()},className:"px-2 py-0.5 rounded text-sm ml-3 bg-red-200 text-red-800",children:"Cancel"})]}),Object(o.jsx)("div",{className:"flex-1 p-2 overflow-y-auto border-t ",children:!0===t?Object(o.jsxs)("div",{className:"my-4",children:[Object(o.jsx)("div",{className:"mx-auto text-center",children:Object(o.jsx)(l.a,{})}),Object(o.jsx)("p",{className:"text-center text-gray-500",children:"Loading"})]}):Object(o.jsx)(r.Fragment,{children:0===p.length?Object(o.jsx)("section",{className:"p-4 text-center",children:Object(o.jsx)("h2",{className:"text-lg text-gray-400",children:"No results found"})}):p.map((function(e,t){return Object(o.jsx)("button",{onClick:function(){return j(e)},className:"block p-1 border-b w-full text-left border-gray-300 hover:text-white hover:bg-blue-600",type:"button",children:e[a]},t)}))})})]})}},577:function(e,t,a){"use strict";a.r(t),a.d(t,"RequestVacantPositions",(function(){return q}));var c=a(44),s=a(27),r=a(28),n=a(29),i=a(30),l=a(4),o=a.n(l),d=a(32),h=a(13),j=a(55),b=a(39),u=a(54),m=a(80),x=a(34),p=a(8),g=a(33),O=a(17),_=a(340),f=a(63),v=a(36),N=a(350),y=a(18),S=a(2),k={target:null,error:""},w=function(e){var t=e.close,a=e.loading_assets,s=e.assets,r=e.saveData,n=e.school_code,i=e.user_id,o=e.hierarchy_data,d=e.loading_hierarchy,u=Object(l.useState)([]),m=Object(g.a)(u,2),w=m[0],C=m[1],q=Object(l.useState)(""),z=Object(g.a)(q,2),T=z[0],A=z[1],I=Object(l.useState)(""),E=Object(g.a)(I,2),F=E[0],P=E[1],R=Object(l.useState)(!1),D=Object(g.a)(R,2),M=D[0],L=D[1],V=Object(l.useState)(!1),G=Object(g.a)(V,2),J=G[0],W=G[1],Q=Object(l.useState)(k),B=Object(g.a)(Q,2),H=B[0],K=B[1],U=Object(l.useState)(!1),X=Object(g.a)(U,2),Y=X[0],Z=X[1],$=w.reduce((function(e,t){return e+ +t.teaching_period}),0),ee=Object(y.k)(o,T,{level_code:!0,level_name:!0,combination_code:!0}),te=Object(l.useState)(null),ae=Object(g.a)(te,2),ce=ae[0],se=ae[1],re=Object(l.useState)(null),ne=Object(g.a)(re,2),ie=ne[0],le=ne[1],oe=function(e){console.log(e,w);var t=w.find((function(t){return t.school_study_hierarchy_id===e.school_study_hierarchy_id}));C(t?w.filter((function(t){return t.school_study_hierarchy_id!==e.school_study_hierarchy_id})):[].concat(Object(c.a)(w),[e]))};return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)(v.c,{backDrop:!0,theme:v.b.default,close:function(){null===ce&&null===ie||window.confirm("Once you close you will lose the selected data, \n do ypu want to close?"),t()},backDropClose:!1,widthSizeClass:v.a.large,displayClose:!0,title:"Add new post on school",padding:{title:!0,body:void 0,footer:void 0},children:["main-error"===H.target&&Object(S.jsx)(j.a,{theme:"danger",children:H.error}),"main-success"===H.target&&Object(S.jsx)(j.a,{theme:"success",children:H.error}),Object(S.jsx)("form",{onSubmit:function(e){return e.preventDefault(),null===ce?K({target:"position",error:"Required"}):null===ie?K({target:"specialization",error:"Required"}):""===F?K({target:"teaching-level",error:"Required"}):0===w.length?(K({target:"subjects",error:"Please select subject(s)"}),void setTimeout((function(){K({target:null,error:""})}),2e3)):(K(k),Z(!0),void Object(h.Fb)({district_code:n.substring(0,2),school_code:n,occupation:ce.position_code,specialization_id:ie.specialization_id,subjects:w.map((function(e){return e.school_study_hierarchy_id})),education_level:ce.qualification_id,need_post:"",requested_by:i,approved_by:"",approved_date:"",status:"WAITING",total_period:$,teaching_level:F,teaching_level_id:F},(function(e,a,c){if(!0===e){var i=null===s||void 0===s?void 0:s.teaching_level.find((function(e){return e.teaching_level_id===F}));r({school_need_post_id:(null===a||void 0===a?void 0:a.id)+"",district_code:n,district_name:"",school_code:n,school_name:"",occupation:ce.position_code,position_name:ce.position_name,specialization_id:ie.specialization_id,specialization_name:ie.specialization_name,education_level:"",qualification_name:ce.qualification_name,need_post:"",status:"WAITING",total_period:$,teaching_level:i?i.teaching_level:"",teaching_level_id:F}),Z(!1),K({target:"main-success",error:"New request created successfully"}),setTimeout((function(){t()}),1e3)}else Z(!1),K({target:"main-error",error:"Error: ".concat(c)})})))},children:!0===a?Object(S.jsx)("div",{className:"py-8 text-center mx-auto",children:Object(S.jsx)(x.a,{})}):null===s?Object(S.jsx)("div",{className:"py-8 text-center text-lg text-red-600",children:"No data found!"}):Object(S.jsxs)("div",{className:"border-t p-4",children:[Object(S.jsx)("div",{className:"pb-3",children:M?Object(S.jsx)(N.a,{loading:!1,id:"position_code",title:"title",close:function(){return L(!M)},data:s.school_positions.map((function(e){return Object(p.a)(Object(p.a)({},e),{},{title:"".concat(e.position_code," - ").concat(e.position_name," (").concat(e.qualification_name,")")})})),click:function(e){se(e),L(!1)}}):Object(S.jsx)("div",{onClick:function(){return!1===Y&&L(!M)},children:Object(S.jsx)(f.a,{onChange:function(e){},value:ce?"".concat(ce.position_code," - ").concat(ce.position_name," (").concat(ce.qualification_name,")"):"",error:"position"===H.target?H.error:"",label:"Position",placeholder:"Position",name:"",disabled:!0})})}),Object(S.jsx)("div",{className:"pb-3",onClick:function(){return!1===Y&&L(!M)},children:Object(S.jsx)(f.a,{onChange:function(e){},value:ce?"".concat(ce.qualification_name):"",error:"position"===H.target?H.error:"",label:"Level of Education",placeholder:"Select the position",name:"",disabled:!0})}),Object(S.jsx)("div",{className:"pb-3",children:J?Object(S.jsx)(N.a,{loading:!1,id:"id",title:"title",close:function(){return W(!J)},data:s.specializations.map((function(e){return Object(p.a)(Object(p.a)({},e),{},{title:"".concat(e.specialization_name),id:e.specialization_id})})),click:function(e){W(!1),le(e)}}):Object(S.jsx)("div",{onClick:function(){return!1===Y&&W(!J)},children:Object(S.jsx)(f.a,{onChange:function(e){},value:ie?ie.specialization_name:"",error:"specialization"===H.target?H.error:"",label:"Specialization",placeholder:"Specialization",name:"specialization_name",disabled:!0})})}),Object(S.jsx)("div",{className:"pb-3",children:Object(S.jsx)(_.a,{onChange:function(e){return P(e.target.value)},value:F,error:"teaching-level"===H.target?H.error:"",label:"Teaching level",placeholder:"Teaching level",name:"teaching_level",data:[{title:"",value:""}].concat(Object(c.a)(s.teaching_level.map((function(e){return{title:e.teaching_level+"",value:e.teaching_level_id+""}}))))})}),!0===d?Object(S.jsxs)("div",{className:"py-8 text-center pb-2 bg-gray-100 mb-3 mt-1 rounded",children:[Object(S.jsx)(x.a,{}),Object(S.jsx)("h4",{className:"text-gray-500",children:"Loading subjects"})]}):Object(S.jsxs)("div",{className:"pb-2 bg-gray-100 mb-3 mt-1 rounded  ".concat("subjects"===H.target?"border-red-500 border-2":""),children:[Object(S.jsxs)("div",{className:"pb-1 flex items-center px-2",children:[Object(S.jsx)("section",{className:"flex-1",children:Object(S.jsx)(f.a,{onChange:function(e){return A(e.target.value)},value:T,error:"",label:"",placeholder:"Search subject",name:"",size:"sm"})}),Object(S.jsxs)("section",{className:"px-2 rounded bg-gray-100",children:[Object(S.jsx)("span",{className:"text-sm text-gray-400",children:"Subjects:"}),Object(S.jsx)("h4",{className:"text-xl -mt-1 font-bold",children:w.length})]}),Object(S.jsxs)("section",{className:"px-2 rounded bg-gray-100",children:[Object(S.jsx)("span",{className:"text-sm text-gray-400",children:"Total periods:"}),Object(S.jsx)("h4",{className:"text-xl -mt-1 font-bold",children:$})]})]}),Object(S.jsx)("div",{className:"h-56 overflow-y-auto",children:Object(S.jsxs)("table",{className:"w-full",children:[Object(S.jsx)("thead",{children:Object(S.jsxs)("tr",{children:[Object(S.jsx)("th",{className:"border p-1"}),Object(S.jsx)("th",{className:"border p-1",children:"Course name"}),Object(S.jsx)("th",{className:"border p-1",children:"Combination"}),Object(S.jsx)("th",{className:"border p-1",children:"Grade name"}),Object(S.jsx)("th",{className:"border p-1",children:"Teaching period"})]})}),Object(S.jsx)("tbody",{className:"",children:ee.map((function(e,t){var a=w.find((function(t){return e.school_study_hierarchy_id===t.school_study_hierarchy_id}));return Object(S.jsxs)("tr",{className:"cursor-pointer ".concat(void 0===a?"":"bg-green-200 bg-opacity-40"),onClick:oe.bind(undefined,e),children:[Object(S.jsx)("td",{className:"border p-1 text-center text-2xl ".concat(void 0===a?"":"text-green-500"),children:void 0===a?Object(S.jsx)(O.l,{}):Object(S.jsx)(O.k,{})}),Object(S.jsx)("td",{className:"border p-1",children:e.course_name}),Object(S.jsx)("td",{className:"border p-1",children:e.combination_name}),Object(S.jsx)("td",{className:"border p-1",children:e.grade_name}),Object(S.jsx)("td",{className:"border p-1",children:e.teaching_period})]},t)}))})]})})]}),"subjects"===H.target&&Object(S.jsx)("span",{className:"text-red-800 text-center",children:H.error}),Object(S.jsx)("div",{className:"pb-2 text-right",children:"main-success"!==H.target&&Object(S.jsx)(b.a,{type:"submit",loading:Y,children:"Request New vacant"})})]})})]})})},C=function(e){Object(n.a)(a,e);var t=Object(i.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).cleanError=function(){return r.setState({error:{target:null,msg:""}})},r.addNewItem=function(e){return r.setState({data:[].concat(Object(c.a)(r.state.data),[e])})},r.removeItem=function(e){window.confirm("Are you sure you want to remove this record?")&&(r.setState({delete_loading:!0,deleting_item:""}),Object(h.l)(e,(function(t,a){!0===t?r.setState({delete_loading:!1,deleting_item:"",error:{target:"main-success",msg:"Record removed successfully"},data:r.state.data.filter((function(t){return t.school_need_post_id!==e}))}):(r.setState({delete_loading:!1,deleting_item:"",error:{target:"main-error",msg:"Error: ".concat(a)}}),setTimeout((function(){r.setState({error:{msg:"",target:null}})}),2e3))})))},r.state={error:{target:null,msg:""},loading_assets:!1,create_request:!1,assets:null,data:[],loading_data:!1,hierarchy_data:[],loading_hierarchy:!1,delete_loading:!1,deleting_item:""},r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=this;if(null===this.props.auth.school)return this.setState({error:{target:"main-error",msg:"No school assigned to you"}});this.setState({loading_assets:!0,loading_data:!0,loading_hierarchy:!0}),Object(h.M)(this.props.auth.school.school_code,(function(t,a,c){!0===t?e.setState({loading_assets:!1,assets:a}):e.setState({loading_assets:!1,error:{target:"main-error",msg:"Error: ".concat(c)}})})),Object(h.mb)(this.props.auth.school.school_code,(function(t,a,c){!0===t?e.setState({data:a,loading_data:!1}):e.setState({data:[],loading_data:!1,error:{target:"main-error",msg:"Error: ".concat(c)}})})),Object(h.t)(this.props.auth.school.school_code,(function(t,a,c){!0===t?e.setState({hierarchy_data:a,loading_hierarchy:!1}):e.setState({hierarchy_data:[],loading_hierarchy:!1,error:{target:"main-error",msg:"Error: ".concat(c)}})}))}},{key:"render",value:function(){var e=this,t=this.state.data.filter((function(e){return"A0"===e.qualification_name})).length,a=this.state.data.filter((function(e){return"A1"===e.qualification_name})).length,c=this.state.data.filter((function(e){return"A2"===e.qualification_name})).length;return Object(S.jsxs)(S.Fragment,{children:["main-error"===this.state.error.target&&Object(S.jsx)(j.a,{theme:"danger",fixed:!0,onClick:this.cleanError,children:this.state.error.msg}),"main-success"===this.state.error.target&&Object(S.jsx)(j.a,{theme:"success",fixed:!0,onClick:this.cleanError,children:this.state.error.msg}),!0===this.state.create_request&&null!==this.props.auth.school&&this.props.auth.user&&Object(S.jsx)(w,{close:function(){return e.setState({create_request:!1})},loading_assets:this.state.loading_assets,assets:this.state.assets,saveData:this.addNewItem,school_code:this.props.auth.school.school_code,school_name:this.props.auth.school.school_name,user_id:this.props.auth.user.user_id,hierarchy_data:this.state.hierarchy_data,loading_hierarchy:this.state.loading_hierarchy}),Object(S.jsx)("section",{className:"sticky top-1 z-50 mx-auto",children:Object(S.jsx)(u.a,{children:Object(S.jsxs)("div",{className:"w-full flex items-center",children:[Object(S.jsxs)("section",{className:"flex-1",children:[Object(S.jsx)(m.a,{size:"md",children:"Vacant posts to be filled"}),Object(S.jsx)("p",{className:"m-0 text-gray-400 text-sm",children:"Vacant posts to be filled"})]}),Object(S.jsx)("section",{children:Object(S.jsx)(b.a,{type:"button",onClick:function(){return e.setState({create_request:!e.state.create_request})},children:"Add vacant"})})]})})}),Object(S.jsxs)(u.a,{children:[Object(S.jsxs)("div",{className:"flex gap-2 mb-2 text-center",children:[Object(S.jsxs)("section",{className:"border p-1 px-6 rounded bg-gray-100",children:[Object(S.jsx)("span",{children:"A0"}),Object(S.jsx)("h2",{className:"font-bold text-2xl -mt-1",children:t})]}),Object(S.jsxs)("section",{className:"border p-1 px-6 rounded bg-gray-100",children:[Object(S.jsx)("span",{children:"A1"}),Object(S.jsx)("h2",{className:"font-bold text-2xl -mt-1",children:a})]}),Object(S.jsxs)("section",{className:"border p-1 px-6 rounded bg-gray-100",children:[Object(S.jsx)("span",{children:"A2"}),Object(S.jsx)("h2",{className:"font-bold text-2xl -mt-1",children:c})]}),Object(S.jsx)("div",{className:"flex-1"}),Object(S.jsxs)("section",{className:"border p-1 px-6 rounded bg-gray-100",children:[Object(S.jsx)("span",{children:"Total"}),Object(S.jsx)("h2",{className:"font-bold text-2xl -mt-1",children:c+a+t})]})]}),Object(S.jsxs)("table",{className:"w-full",children:[Object(S.jsx)("thead",{children:Object(S.jsxs)("tr",{className:"text-left",children:[Object(S.jsx)("th",{className:"p-2 border",children:"#"}),Object(S.jsx)("th",{className:"p-2 border",children:"Code"}),Object(S.jsx)("th",{className:"p-2 border",children:"Position name"}),Object(S.jsx)("th",{className:"p-2 border",children:"Qualification "}),Object(S.jsx)("th",{className:"p-2 border",children:"Specialization"}),Object(S.jsx)("th",{className:"p-2 border",children:"Total Period"}),Object(S.jsx)("th",{className:"p-2 border",children:"Teaching level"}),Object(S.jsx)("th",{className:"p-2 border",children:"Status"}),Object(S.jsx)("th",{className:"p-2 border"})]})}),Object(S.jsx)("tbody",{children:!0===this.state.loading_data?Object(S.jsx)("tr",{children:Object(S.jsx)("td",{className:"py-8 text-center",colSpan:10,children:Object(S.jsx)(x.a,{})})}):0===this.state.data.length?Object(S.jsx)("tr",{children:Object(S.jsx)("td",{className:"py-8 text-center",colSpan:10,children:Object(S.jsx)("h2",{className:"text-2xl font-bold text-gray-600",children:"No results found"})})}):Object(S.jsx)(S.Fragment,{children:this.state.data.map((function(t,a){return Object(S.jsxs)("tr",{children:[Object(S.jsx)("td",{className:"border p-2",children:a+1}),Object(S.jsx)("td",{className:"border p-2",children:t.school_code}),Object(S.jsx)("td",{className:"border p-2",children:t.position_name}),Object(S.jsx)("td",{className:"border p-2",children:t.qualification_name}),Object(S.jsx)("td",{className:"border p-2",children:t.specialization_name}),Object(S.jsx)("td",{className:"border p-2",children:t.total_period}),Object(S.jsx)("td",{className:"border p-2",children:t.teaching_level}),Object(S.jsx)("td",{className:"border p-2 text-center",children:Object(S.jsx)("span",{className:"p-1 rounded-lg text-xs ".concat("APPROVED"===t.status?"bg-green-100 text-green-700":"bg-gray-200"),children:t.status})}),Object(S.jsx)("td",{className:"border p-2 text-center",children:Object(S.jsx)(b.a,{theme:"danger-light",type:"button",onClick:e.removeItem.bind(e,t.school_need_post_id),disabled:e.state.delete_loading,loading:e.state.deleting_item===t.school_need_post_id,children:"Remove"})})]},a)}))})})]})]})]})}}]),a}(o.a.Component),q=Object(d.b)((function(e){return{auth:e.auth}}),{})(C)}}]);
//# sourceMappingURL=28.d2eb7b0f.chunk.js.map