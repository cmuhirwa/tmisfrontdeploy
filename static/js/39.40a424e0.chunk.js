(this.webpackJsonpTMIS=this.webpackJsonpTMIS||[]).push([[39],{376:function(e,o,s){"use strict";var t=s(3),i=s(8),c=s(26),n=s(7),l=s(43),a=s(27),r=s(28),d=s(29),h=s(30),p=s(4),u=s(17),b=s(61),x=s(354),j=s(15),m=s(9),f=s.n(m),_=s(10),v=s(18),O=s(38),g=s(12),y=s(44),w=s(36),N=s(2),S=function(e){Object(d.a)(s,e);var o=Object(h.a)(s);function s(e){var r;return Object(a.a)(this,s),(r=o.call(this,e)).addPositionToSchool=function(e){r.setState({schoolPositionsTemp:[e].concat(Object(l.a)(r.state.schoolPositionsTemp.filter((function(o){return o.position_id!==e.position_id}))))})},r.FilterByPositionsHavingTeacher=function(){return r.state.schoolPositionsTemp.sort((function(e,o){var s=0,t=r.props.schoolPositions.find((function(o){return o.position_code===e.position_code}));return void 0!==t&&(s=parseInt(t.total_on_position)),s>0?-1:1}))},r.addSchoolPositions=Object(n.a)(Object(t.a)().mark((function e(){var o,s,n,l;return Object(t.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==window.confirm("Are you sure do you want to add these positions?")){e.next=23;break}if(!(r.state.schoolPositionsTemp.length>0&&void 0===r.props.school?r.props.auth.school:r.props.school)){e.next=23;break}Object(_.a)(),o=[],r.setState({loading:!0}),s=Object(c.a)(r.state.schoolPositionsTemp);try{for(s.s();!(n=s.n()).done;)l=n.value,o.push({school_code:void 0===r.props.school?r.props.auth.school.school_code:r.props.school.school_code,position_code:l.position_code})}catch(t){s.e(t)}finally{s.f()}return console.log("Positions codes: ",o),e.prev=8,e.next=11,f.a.post("".concat(j.d,"/schoolposition/assign"),o);case 11:r.props.appendPositionsToSchool(r.state.schoolPositionsTemp),r.setState({schoolPositionsTemp:[]}),r.setState({loading:!1}),r.setState({success:"Positions added successfully!",error:""}),alert("Positions added successfully!"),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(8),r.setState({loading:!1}),r.setState({error:Object(g.a)(e.t0)}),console.log("Err: ",Object(i.a)({},e.t0));case 23:case"end":return e.stop()}}),e,null,[[8,18]])}))),r.RemoveSchoolPosition=function(){var e=Object(n.a)(Object(t.a)().mark((function e(o,s){var c,n,l,a,d,h,p,u;return Object(t.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.setState({loading:!0}),e.prev=1,e.next=4,f.a.post("".concat(j.d,"/schoolposition/delete/").concat(o),{school_code:s});case 4:e.sent&&(r.setState({success:"Positions added successfully!",error:""}),r.props.removePositionsToSchool(o)),e.next=14;break;case 8:e.prev=8,e.t0=e.catch(1),console.log("error res: ",null===(c=e.t0.response)||void 0===c||null===(n=c.data)||void 0===n?void 0:n.users),void 0!==(null===(l=e.t0.response)||void 0===l||null===(a=l.data)||void 0===a?void 0:a.users)&&e.t0.response.data.users.length>0?(d=r.props.schoolPositions.find((function(e){return e.school_has_position_id===o})),void 0!==(h=r.props.positions.find((function(e){return e.position_code===(null===d||void 0===d?void 0:d.position_code)})))?r.setState({selected_position_users_on_delete:{position:h,data:null===(p=e.t0.response)||void 0===p||null===(u=p.data)||void 0===u?void 0:u.users}}):r.setState({error:"Invalid Position selected!"})):r.setState({error:Object(g.a)(e.t0)}),r.setState({loading:!1}),console.log("Err: ",Object(i.a)({},e.t0));case 14:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(o,s){return e.apply(this,arguments)}}(),r.PositionsSortByHavingTeacher=function(){var e=[];return e=(e=r.props.positions.sort((function(e,o){var s=r.props.schoolPositions.find((function(o){return o.position_code===e.position_code})),t=r.props.schoolPositions.find((function(e){return e.position_code===o.position_code}));return void 0!==s&&void 0!==t?parseInt(s.total_on_position)>parseInt(t.total_on_position)?-1:1:0}))).filter((function(e){return void 0===r.props.schoolPositions.find((function(o){return o.position_code===e.position_code}))})),Object(v.k)(e,r.state.searchPositionValue)},r.state={searchPositionValue:"",schoolPositionsTemp:[],edit:!1,loading:!1,success:"",error:"",selected_position_users_on_delete:null},r}return Object(r.a)(s,[{key:"render",value:function(){var e,o,s=this;return Object(N.jsxs)(p.Fragment,{children:[Object(N.jsx)("div",{children:Object(N.jsxs)("div",{className:"bg-white dark:bg-dark-800 p-3 rounded overflow-y-auto",style:null===this.state.selected_position_users_on_delete?{}:{maxHeight:"80vh"},children:[Object(N.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[Object(N.jsxs)("div",{className:"flex flex-row items-center gap-2 justify-between w-full",children:[Object(N.jsx)("span",{className:"text-2xl font-bold text-primary-800",children:!0===this.state.edit?"Assign positions to school":"School positions list"}),Object(N.jsx)("div",{children:Object(N.jsxs)(O.a,{onClick:function(){return s.setState({edit:!s.state.edit})},theme:!0===this.state.edit?"default":"accent",className:"flex flex-row items-center gap-3 animate__animated ".concat(!1===this.state.edit?"animate__zoomIn":"animate__fadeInLeft"),children:[Object(N.jsx)("div",{children:!0===this.state.edit?Object(N.jsx)(u.f,{className:"text-2xl"}):Object(N.jsx)(u.d,{className:"text-2xl"})}),Object(N.jsx)("span",{children:!0===this.state.edit?"Back to list":"Add new positions"})]})})]}),void 0!==this.props.close&&Object(N.jsx)("div",{children:Object(N.jsx)("div",{onClick:function(){return s.props.close&&s.props.close()},className:"bg-gray-100 hover:bg-yellow-100 flex items-center justify-center p-1 cursor-pointer rounded-full",children:Object(N.jsx)(u.n,{className:"text-3xl"})})})]}),""!==this.state.success&&Object(N.jsx)("div",{onClick:function(){return s.setState({success:""})},className:"bg-green-600 text-white font-bold pl-4 pr-2 py-2 text-lg rounded-md my-2 fixed right-10 cursor-pointer shadow-xl animate__animated animate__bounceInRight",children:Object(N.jsxs)("div",{className:"flex flex-row justify-between items-center gap-8",children:[Object(N.jsxs)("div",{children:["Success: ",this.state.success]}),Object(N.jsx)("div",{children:Object(N.jsx)(u.n,{className:"text-2xl text-red-600 bg-red-100 rounded-full"})})]})}),""!==this.state.error&&Object(N.jsx)("div",{onClick:function(){return s.setState({error:""})},className:"bg-red-600 text-white font-bold pl-4 pr-2 py-2 text-lg rounded-md my-2 fixed right-10 cursor-pointer shadow-xl animate__animated animate__bounceInRight",children:Object(N.jsxs)("div",{className:"flex flex-row justify-between items-center gap-8",children:[Object(N.jsxs)("div",{children:["Error: ",this.state.error]}),Object(N.jsx)("div",{children:Object(N.jsx)(u.n,{className:"text-2xl text-red-600 bg-red-100 rounded-full"})})]})}),Object(N.jsxs)("div",{className:"grid md:grid-cols-".concat(!0===this.state.edit?"2":"1"),children:[Object(N.jsxs)("div",{className:"col-span-1 border-r pr-2 ".concat(!0===this.state.edit?"":"hidden"),children:[Object(N.jsx)("div",{className:"",children:Object(N.jsx)(b.a,{onChange:function(e){return s.setState({searchPositionValue:e.target.value})},error:"",placeholder:"Search position...",value:this.state.searchPositionValue,type:"search",name:"post",label:"Search"})}),Object(N.jsx)("div",{className:"h-screen overflow-y-auto",children:0===this.PositionsSortByHavingTeacher().length?Object(N.jsx)("div",{children:"No positions found!"}):this.PositionsSortByHavingTeacher().map((function(e,o){var t;return Object(N.jsxs)("div",{className:"border border-gray-300 px-3 py-2 flex flex- justify-between group bg-white hover:bg-blue-50 hover:border-blue-300 gap-3  items-center cursor-pointer my-1 rounded",onClick:function(){s.addPositionToSchool(e)},children:[Object(N.jsx)("div",{className:"",children:Object(N.jsx)("div",{className:"flex flex-row items-center justify-between",children:Object(N.jsxs)("div",{className:"flex flex-row gap-3 items-center text-base font-bold",children:[Object(N.jsx)("div",{children:Object(N.jsx)("div",{className:"flex items-center justify-center font-normal rounded-full h-8 -ml-1 w-8 border border-blue-400 bg-blue-100 text-sm",children:o+1})}),Object(N.jsxs)("div",{className:"flex flex-col",children:[Object(N.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[Object(N.jsxs)("span",{className:"font-light",children:[e.position_code,"-"]}),Object(N.jsxs)("span",{className:"",children:[e.position_name," (",e.qualification_name,")"]})]}),Object(N.jsxs)("div",{className:"text-sm font-light text-gray-500 group-hover:text-accent-900 -mt-1",children:["Level name: ",e.school_level_name]})]})]})})}),Object(N.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[void 0!==s.props.schoolPositions.find((function(o){return o.position_code===e.position_code}))&&Object(N.jsxs)("div",{className:"bg-yellow-100 rounded-full text-sm font-bold px-2 border border-yellow-400 truncate",children:["Total:"," ",null===(t=s.props.schoolPositions.find((function(o){return o.position_code===e.position_code})))||void 0===t?void 0:t.total_on_position]}),Object(N.jsx)("div",{className:"bg-blue-100 text-primary px-3 py-1 rounded cursor-pointer text-base text-primary-800 group-hover:text-white group-hover:bg-primary-800",children:"Select"})]})]},o+1)}))})]}),Object(N.jsxs)("div",{className:"col-span-1 px-3",children:[" ",Object(N.jsx)("div",{className:"flex flex-col border-b pb-3 border-accent-900 mt-2",children:Object(N.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[Object(N.jsxs)("span",{className:"text-accent-900 text-xl font-bold",children:[void 0===this.props.school?null===(e=this.props.auth.school)||void 0===e?void 0:e.school_name:this.props.school.school_name," ","(",void 0===this.props.school?null===(o=this.props.auth.school)||void 0===o?void 0:o.school_code:this.props.school.school_code,")"]}),Object(N.jsx)("div",{className:"font-bold text-2xl",children:[].concat(Object(l.a)(this.state.schoolPositionsTemp),Object(l.a)(this.props.schoolPositions)).length})]})}),Object(N.jsx)("div",{className:"mt-3",children:0===[].concat(Object(l.a)(this.state.schoolPositionsTemp),Object(l.a)(this.props.schoolPositions)).length?Object(N.jsxs)("div",{className:"flex flex-col bg-gray-100 w-full justify-center items-center rounded-md p-4",children:[Object(N.jsx)("div",{className:"text-7xl text-gray-400",children:Object(N.jsx)(x.c,{})}),Object(N.jsx)("span",{className:"text-3xl text-black",children:"School positions not found"}),Object(N.jsx)("span",{className:"text-sm text-gray-600",children:"This school has no positions assigned to it. Please select positions"})]}):Object(N.jsxs)("div",{children:[0!==this.state.schoolPositionsTemp.length&&Object(N.jsx)("div",{className:"text-xl text-primary-800 my-3 font-bold",children:"New pending"}),this.state.schoolPositionsTemp.map((function(e,o){return Object(N.jsx)("div",{className:"border rounded-md px-3 py-2 mb-2 group cursor-pointer ".concat(void 0!==s.state.schoolPositionsTemp.find((function(o){return o.position_id===e.position_id}))?"bg-yellow-50 border-yellow-400":"bg-blue-50 border-blue-400 hover:bg-blue-100"," animate__animated animate__zoomIn"),children:Object(N.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[Object(N.jsx)("div",{className:"",children:Object(N.jsx)("div",{className:"flex flex-row items-center justify-between",children:Object(N.jsxs)("div",{className:"flex flex-row gap-3 items-center text-base font-bold",children:[Object(N.jsx)("div",{children:Object(N.jsx)("div",{className:"flex items-center justify-center font-normal rounded-full h-8 -ml-1 w-8 border border-blue-400 bg-blue-100 text-sm",children:o+1})}),Object(N.jsxs)("div",{className:"flex flex-col",children:[Object(N.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[Object(N.jsxs)("span",{className:"font-light",children:[e.position_code,"-"]}),Object(N.jsxs)("span",{className:"",children:[e.position_name," (",e.qualification_name,")"]})]}),Object(N.jsxs)("div",{className:"text-sm font-light text-gray-500 group-hover:text-accent-900 -mt-1",children:["Level name: ",e.school_level_name]})]})]})})}),Object(N.jsx)("div",{className:"",children:Object(N.jsx)("div",{onClick:function(){s.setState({schoolPositionsTemp:s.state.schoolPositionsTemp.filter((function(o){return o.position_id!==e.position_id}))})},className:"bg-white text-accent-900 px-3 py-1 rounded cursor-pointer text-base border border-yellow-400",children:"Remove"})})]})},o+1)})),0!==this.state.schoolPositionsTemp.length&&Object(N.jsx)("div",{children:Object(N.jsx)(O.a,{onClick:function(){s.addSchoolPositions()},theme:"accent",children:"Submit positions"})}),0!==this.props.schoolPositions.length&&Object(N.jsx)("div",{className:"font-bold text-lg text-gray-500 my-3",children:"List of school position"}),this.props.schoolPositions.map((function(e,o){var t;return Object(N.jsxs)("div",{className:"border rounded-md px-3 py-2 mb-2 group cursor-pointer ".concat(void 0!==s.state.schoolPositionsTemp.find((function(o){return o.position_code===e.position_code}))?"bg-yellow-50 border-yellow-400":"bg-gray-100 hover:bg-blue-100"," flex flex-row items-center justify-between gap-4"),children:[Object(N.jsx)("div",{className:"",children:Object(N.jsx)("div",{className:"flex flex-row items-center justify-between",children:Object(N.jsxs)("div",{className:"flex flex-row gap-3 items-center text-base font-bold",children:[Object(N.jsx)("div",{children:Object(N.jsx)("div",{className:"flex items-center justify-center font-normal rounded-full h-8 -ml-1 w-8 border border-blue-400 bg-blue-100 text-sm",children:o+1})}),Object(N.jsxs)("div",{className:"flex flex-col",children:[Object(N.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[Object(N.jsxs)("span",{className:"font-light",children:[e.position_code,"-"]}),Object(N.jsxs)("span",{className:"",children:[e.position_name," (",e.qualification_name,")"]})]}),Object(N.jsxs)("div",{className:"text-sm font-light text-gray-500 group-hover:text-accent-900 -mt-1",children:["Level name: ",e.school_level_name]})]})]})})}),Object(N.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[Object(N.jsxs)("div",{className:"bg-yellow-100 rounded-full text-sm font-bold px-2 border border-yellow-400 truncate",children:["Total:"," ",null===(t=s.props.schoolPositions.find((function(o){return o.position_code===e.position_code})))||void 0===t?void 0:t.total_on_position]}),void 0!==s.props.schoolPositions.find((function(o){return o.position_code===e.position_code}))&&parseInt(s.props.schoolPositions.find((function(o){return o.position_code===e.position_code})).total_on_position)<=0&&Object(N.jsx)("div",{onClick:function(){""!==e.school_code&&!0===window.confirm("Are you sure do you want to remove this position")&&s.RemoveSchoolPosition(e.school_has_position_id,e.school_code)},className:"bg-white text-red-800 group-hover:text-white group-hover:bg-red-600 px-3 py-1 font-bold text-center rounded -mr-1",children:"Delete"}),void 0!==s.props.schoolPositions.find((function(o){return o.position_code===e.position_code}))&&parseInt(s.props.schoolPositions.find((function(o){return o.position_code===e.position_code})).total_on_position)>0&&Object(N.jsx)("div",{onClick:function(){return s.RemoveSchoolPosition(e.school_has_position_id,e.school_code)},className:"bg-blue-100 border border-white text-primary-800 group-hover:border-primary-800 hover:border-primary-800 group-hover:bg-primary-800 group-hover:text-white px-3 py-1 font-bold text-center rounded -mr-1",children:"Staffs"})]})]},o+1)}))]})})]})]})]})}),null!==this.state.selected_position_users_on_delete&&Object(N.jsx)(y.c,{backDrop:!0,theme:y.b.default,close:function(){return s.setState({selected_position_users_on_delete:null})},backDropClose:!1,widthSizeClass:y.a.extraLarge,displayClose:!1,padding:{body:!0},children:!0===this.state.loading?Object(N.jsxs)("div",{className:"bg-white rounded p-4",children:[Object(N.jsx)(w.a,{}),Object(N.jsx)("div",{className:"text-xl font-light ml-4 -mt-10",children:"Loading, please wait..."})]}):Object(N.jsxs)("div",{className:"bg-white",children:[Object(N.jsxs)("div",{className:"flex flex-row gap-3 justify-between",children:[Object(N.jsxs)("div",{children:[Object(N.jsx)("div",{className:"font-extrabold text-2xl",children:this.state.selected_position_users_on_delete.position.position_name}),Object(N.jsx)("div",{children:"List of staffs for the selected position"})]}),Object(N.jsx)("div",{onClick:function(){return s.setState({selected_position_users_on_delete:null})},className:"bg-accent-800 font-bold cursor-pointer px-3 py-2 rounded truncate w-max h-10 flex items-center justify-center",children:"Close window"})]}),Object(N.jsx)("div",{className:"mt-3",children:Object(N.jsxs)("table",{className:"w-full text-left text-base font-light",children:[Object(N.jsx)("thead",{className:"bg-primary-100",children:Object(N.jsxs)("tr",{children:[Object(N.jsx)("th",{className:"px-3 py-1",children:"#"}),Object(N.jsx)("th",{className:"px-3 py-1",children:"Staff code"}),Object(N.jsx)("th",{className:"px-3 py-1",children:"Full name"}),Object(N.jsx)("th",{className:"px-3 py-1",children:"NID"}),Object(N.jsx)("th",{className:"px-3 py-1",children:"Phone number"})]})}),Object(N.jsx)("tbody",{children:this.state.selected_position_users_on_delete.data.map((function(e,o){return Object(N.jsxs)("tr",{className:"".concat(o%2!==0?"bg-gray-100":""),children:[Object(N.jsx)("td",{className:"px-3 py-1",children:o+1}),Object(N.jsx)("td",{className:"px-3 py-1",children:e.staff_code}),Object(N.jsx)("td",{className:"px-3 py-1",children:e.full_name}),Object(N.jsx)("td",{className:"px-3 py-1",children:e.nid}),Object(N.jsx)("td",{className:"px-3 py-1",children:e.phone_numbers})]},o+1)}))})]})}),Object(N.jsx)("div",{className:"mt-3 w-full",children:Object(N.jsxs)("div",{className:"flex flex-row gap-2 w-full bg-accent-400 rounded-md p-4 border border-yellow-400",children:[Object(N.jsx)("div",{children:Object(N.jsx)(u.x,{className:"text-5xl"})}),Object(N.jsxs)("div",{className:"text-xl font-light text-black flex flex-col",children:[Object(N.jsx)("span",{className:"font-extrabold",children:"You can not remove this position!"}),Object(N.jsx)("span",{className:"text-base",children:"If you want to remove this position, you need to check these staffs before. Thus, if you decided to remove it, please remove these staffs before removing this position!"})]})]})})]})})]})}}]),s}(p.Component);o.a=S},548:function(e,o,s){"use strict";s.r(o),s.d(o,"_AssignSchoolPosition",(function(){return b})),s.d(o,"AssignSchoolPosition",(function(){return x}));var t=s(27),i=s(28),c=s(29),n=s(30),l=s(4),a=s(53),r=s(376),d=s(32),h=s(13),p=s(36),u=s(2),b=function(e){Object(c.a)(s,e);var o=Object(n.a)(s);function s(e){var i;return Object(t.a)(this,s),(i=o.call(this,e)).componentDidMount=function(){null===i.props.basic.positions&&i.props.FC_GetAllPositions((function(e,o){i.setState({loading_data:!0}),!0===e&&i.setState({loading_data:!1}),console.log(e)})),i.props.basic.academic_calender&&i.props.auth.school&&Object(h.S)(i.props.auth.school.school_code,i.props.basic.academic_calender.academic_year_id,(function(e,o,s){var t;null!==o&&(i.setState({loading_data:!0}),!0===e&&null!==i.props.auth.school&&(i.setState({schoolPositionsShow:{school_code:null===(t=i.props.auth.school)||void 0===t?void 0:t.school_code,school_id:i.props.auth.school.school_code,school_positions:o.school_positions,school:{school_id:i.props.auth.school.school_code,school_code:i.props.auth.school.school_code,school_name:i.props.auth.school.school_name,school_category:i.props.auth.school.schoolcategory,school_status:i.props.auth.school.schoolstatus,region_code:i.props.auth.school.regioncode}}}),i.setState({loading_data:!1})))}))},i.state={loading_data:!1,schoolPositionsShow:null},i}return Object(i.a)(s,[{key:"render",value:function(){var e=this;return!0===this.state.loading_data||null===this.props.basic.positions||null===this.state.schoolPositionsShow?Object(u.jsx)(a.a,{children:Object(u.jsxs)("div",{className:"mx-auto p-8 flex flex-col items-center justify-center",children:[Object(u.jsx)("div",{children:"Loading, please wait..."}),Object(u.jsx)(p.a,{})]})}):Object(u.jsx)(a.a,{children:Object(u.jsx)("div",{className:"",children:null!==this.state.schoolPositionsShow&&null!==this.props.basic.positions&&Object(u.jsx)(r.a,{auth:this.props.auth,positions:this.props.basic.positions,schoolPositions:this.state.schoolPositionsShow.school_positions,school:this.state.schoolPositionsShow.school,appendPositionsToSchool:function(o){e.state.schoolPositionsShow&&e.props.basic.academic_calender&&Object(h.S)(e.state.schoolPositionsShow.school_code,e.props.basic.academic_calender.academic_year_id,(function(o,s,t){null!==s&&(e.setState({loading_data:!0}),!0===o&&(e.state.schoolPositionsShow&&e.setState({schoolPositionsShow:{school_code:e.state.schoolPositionsShow.school_code,school_id:e.state.schoolPositionsShow.school_id,school_positions:s.school_positions,school:e.state.schoolPositionsShow.school}}),e.setState({loading_data:!1})))}))},removePositionsToSchool:function(o){e.state.schoolPositionsShow&&e.props.basic.academic_calender&&Object(h.S)(e.state.schoolPositionsShow.school_code,e.props.basic.academic_calender.academic_year_id,(function(o,s,t){null!==s&&(e.setState({loading_data:!0}),!0===o&&(e.state.schoolPositionsShow&&e.setState({schoolPositionsShow:{school_code:e.state.schoolPositionsShow.school_code,school_id:e.state.schoolPositionsShow.school_id,school_positions:s.school_positions,school:e.state.schoolPositionsShow.school}}),e.setState({loading_data:!1})))}))}})})})}}]),s}(l.Component),x=Object(d.b)((function(e){return{auth:e.auth,basic:e.basic,schoolHierarchyStore:e.schoolHierarchyStore}}),{FC_GetAllPositions:h.n,FC_AllSchoolHierarchyDetails:h.c})(b)}}]);
//# sourceMappingURL=39.40a424e0.chunk.js.map