(this.webpackJsonpTMIS=this.webpackJsonpTMIS||[]).push([[36],{361:function(e,t,s){"use strict";s(4);var i=s(1);t.a=function(e){var t=function(){for(var t=[],s=0;s<e.cols;s++)t.push(s);return t.map((function(e){return Object(i.jsx)("td",{className:"p-3 text-center whitespace-nowrap",children:Object(i.jsx)("div",{className:"w-full h-4 rounded bg-gray-200 animate__animated animate__pulse animate__delay-5s animate__infinite"})},e)}))};return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("tr",{className:"border-b border-gray-200",children:t()},228),Object(i.jsx)("tr",{className:"border-b border-gray-200",children:t()},22648),Object(i.jsx)("tr",{className:"border-b border-gray-200",children:t()},229768)]})}},421:function(e,t,s){"use strict";var i=s(28),c=s(4),r=s(16),a=s(15),n=s(1);t.a=function(e){var t=Object(c.useState)(""),s=Object(i.a)(t,2),o=s[0],l=s[1];return Object(n.jsx)("div",{className:"absolute animate__animated animate__fadeIn animate__faster",style:{width:"500px"},children:Object(n.jsxs)("div",{className:"bg-white rounded shadow-xl mb-10",children:[Object(n.jsxs)("div",{className:"p-3 flex flex-row items-center justify-between gap-3",children:[Object(n.jsx)("input",{type:"search",value:o,onChange:function(e){return l(e.target.value)},placeholder:"Type district name...",className:"bg-white rounded px-3 py-2 border border-primary-800 w-full"}),Object(n.jsx)("div",{onClick:function(){return e.setVisibility(!1)},children:Object(n.jsx)("div",{className:"h-8 w-8 rounded-full bg-red-100 hover:bg-red-200 flex items-center justify-center",children:Object(n.jsx)(r.r,{className:"text-red-600 text-2xl cursor-pointer"})})})]}),Object(n.jsx)("div",{className:"max-h-80 overflow-y-auto pb-3",children:0===Object(a.v)(e.districts,o).length?Object(n.jsx)("div",{className:"text-gray-500 font-extrabold text-xl text-center p-4",children:"No data found!"}):Object(a.v)(e.districts,o).map((function(t,s){return Object(n.jsx)("div",{onClick:function(){e.onChange(t.district_code),e.setVisibility(!1)},className:"border-b py-2 px-3 group ".concat(e.selected_district===t.district_code?"bg-blue-200 font-extrabold text-primary-800":""," hover:bg-primary-800 hover:text-white cursor-pointer hover:border-blue-500"),children:Object(n.jsxs)("div",{className:"flex flex-row items-center gap-4",children:[Object(n.jsx)("div",{children:e.selected_district===t.district_code?Object(n.jsx)(r.o,{className:"text-2xl"}):Object(n.jsx)(r.Eb,{className:"text-2xl"})}),Object(n.jsx)("div",{children:t.district_name})]})},s+1)}))})]})})}},633:function(e,t,s){"use strict";s.r(t),s.d(t,"DoPlacement",(function(){return C}));var i=s(41),c=s(19),r=s(20),a=s(21),n=s(22),o=s(4),l=s(54),d=s(36),b=s(37),u=s(13),j=s(140),h=s(23),x=s(53),m=s(92),_=s(25),p=s(361),f=s(5),O=s(15),v=s(421),g=s(28),N=s(16),w=s(1),y=function(e){var t=Object(o.useState)(""),s=Object(g.a)(t,2),i=s[0],c=s[1];return Object(w.jsx)("div",{className:"absolute animate__animated animate__fadeIn animate__faster",style:{width:"500px"},children:Object(w.jsxs)("div",{className:"bg-white rounded shadow-xl mb-10",children:[Object(w.jsxs)("div",{className:"p-3 flex flex-row items-center justify-between gap-3",children:[Object(w.jsx)("input",{type:"search",value:i,onChange:function(e){return c(e.target.value)},placeholder:"Type district name...",className:"bg-white rounded px-3 py-2 border border-primary-800 w-full"}),Object(w.jsx)("div",{onClick:function(){return e.setVisibility(!1)},children:Object(w.jsx)("div",{className:"h-8 w-8 rounded-full bg-red-100 hover:bg-red-200 flex items-center justify-center",children:Object(w.jsx)(N.r,{className:"text-red-600 text-2xl cursor-pointer"})})})]}),Object(w.jsx)("div",{className:"max-h-80 overflow-y-auto pb-3",children:0===Object(O.v)(e.positions,i).length?Object(w.jsx)("div",{className:"text-gray-500 font-extrabold text-xl text-center p-4",children:"No data found!"}):Object(O.v)(e.positions,i).map((function(t,s){return Object(w.jsx)("div",{onClick:function(){e.onChange(t.position_code),e.setVisibility(!1)},className:"border-b py-2 px-3 group ".concat(e.selected_position===t.position_code?"bg-blue-200 font-extrabold text-primary-800":""," hover:bg-primary-800 hover:text-white cursor-pointer hover:border-blue-500"),children:Object(w.jsxs)("div",{className:"flex flex-row items-center gap-4",children:[Object(w.jsx)("div",{children:e.selected_position===t.position_code?Object(w.jsx)(N.o,{className:"text-2xl"}):Object(w.jsx)(N.Eb,{className:"text-2xl"})}),Object(w.jsx)("div",{children:t.position_name})]})},s+1)}))})]})})},S=function(e){Object(a.a)(s,e);var t=Object(n.a)(s);function s(e){var r;return Object(c.a)(this,s),(r=t.call(this,e)).FC_GetDistrictDistribution=function(e){r.props.basic.academic_calender&&Object(u.J)({academic_id:r.props.basic.academic_calender.academic_year_id,district_id:e},(function(e,t,s){r.setState({loadingDistribution:!0,distributionList:null}),null!==t&&!0===e?r.setState({loadingDistribution:!1,distributionList:t}):!0===e&&r.setState({loadingDistribution:!1})}))},r.FC_ChangeCustomVacant=function(e,t){var s=Object(i.a)(r.state.customVacant),c=s.findIndex((function(e){return e.selected_request_id===r.state.selected_request_id})),a=Object(O.r)(t)||Number(t)<0?"0":t;c>=0?s[c]={selected_request_id:r.state.selected_request_id,new_value:Number(a)>Number(e)?e.toString():a}:s.push({selected_request_id:r.state.selected_request_id,new_value:Number(a)>Number(e)?e.toString():a}),console.log("================new_value_copy===================="),console.log({new_value_copy:a}),console.log("================new_value_copy===================="),r.setState({customVacant:s,selected_request_id:"",new_value:""})},r.FC_GetDistributionValue=function(e){var t=r.state.customVacant.find((function(t){return t.selected_request_id===e.post_request_id}));return t?t.new_value:e.dde_post_distribution.toString()},r.FC_FilterByPosition=function(e,t){return e?e.academic_distributed.filter((function(e){return e.position_code.toString()===t.toString()})):[]},r.FC_CalculateRequests=function(e){var t=0;return e.forEach((function(e){t+=Number(r.FC_GetDistributionValue(e))})),t},r.FC_GetRequestsForTRS=function(e){var t=0,s=[];return e.forEach((function(e){t=Number(r.FC_GetDistributionValue(e)),s.push({post_request_id:e.post_request_id,school_code:e.school_code,district_code:e.district_code,sector_code:e.school_code.substring(0,4),province_code:e.school_code.substring(0,1),gender:"",in_education:!1,disability:!1,academic_year_id:r.props.basic.academic_calender?r.props.basic.academic_calender.academic_year_id:"",available_places:[{position_code:e.position_code,requested_teacher:t}]}),t=0})),s},r.submitDataRequestTRS=function(e){var t=r.FC_GetRequestsForTRS(e);r.setState({loading_candidates_from_trs:!0,error:null}),Object(u.Vb)(r.state.selected_position,t,(function(e,t,s){!0===e&&null!==t?r.setState({loading_candidates_from_trs:!1,error:{target:"main-error",msg:s},collected_teachers:t,collected_candidates_open:!0}):r.setState({loading_candidates_from_trs:!1,error:{target:"main-error",msg:s}})}))},r.state={loading:!0,loadingDistribution:!1,loading_candidates_from_trs:!1,districts:null,showDistrictsList:!1,selected_district:"",showPositionList:!1,selected_position:"",distributionList:null,searchData:"",error:null,selected_request_id:"",new_value:"0",customVacant:[],waiting_list_total:null,collected_teachers:[],collected_candidates_open:!1},r}return Object(r.a)(s,[{key:"componentDidMount",value:function(){var e=this;this.props.auth.role&&"4"===this.props.auth.role.role_id.toString()&&(Object(j.b)((function(t,s,i){e.setState({loading:t}),null!==s&&!1===t&&e.setState({loading:!1,districts:s})})),null===this.props.basic.positions&&this.props.FC_GetAllPositions((function(t,s){e.setState({loading:t})})),null!==this.state.waiting_list_total&&0!==this.state.waiting_list_total.length||Object(u.Hb)((function(t,s,i){e.setState({loading:!0}),!0===t?e.setState({loading:!1,waiting_list_total:s}):!1===t&&e.setState({loading:!1})})))}},{key:"render",value:function(){var e,t,s,i,c=this,r=null===(e=this.props.auth.role)||void 0===e?void 0:e.access;if(!1===Object(f.c)(r,f.b.DO_PLACEMENT))return Object(w.jsx)(b.a,{to:"/dashboard"});if(!0===this.state.loading)return Object(w.jsxs)(x.a,{className:"flex flex-col items-center justify-center",children:[Object(w.jsx)(_.a,{}),Object(w.jsxs)("div",{children:["Loading, please wait... ",null===(i=this.props.auth.role)||void 0===i?void 0:i.role_id]})]});var a=null===(t=this.state.districts)||void 0===t?void 0:t.find((function(e){return e.district_code===c.state.selected_district})),n=null===(s=this.props.basic.positions)||void 0===s?void 0:s.find((function(e){return e.position_code===c.state.selected_position})),d=this.FC_FilterByPosition(this.state.distributionList,this.state.selected_position),u=this.FC_CalculateRequests(d),j=this.state.waiting_list_total?this.state.waiting_list_total.find((function(e){return e._id.toString()===c.state.selected_position.toString()})):void 0;return!0===this.state.collected_candidates_open?Object(w.jsxs)(x.a,{className:"animate__animated animate__zoomIn animate__faster",children:[Object(w.jsx)("div",{className:"flex border-b p-2",children:Object(w.jsx)("div",{className:"flex-1 text-center",children:Object(w.jsx)(m.a,{size:"md",children:"List of teachers form TRS waiting list"})})}),Object(w.jsx)("div",{className:"p-2",children:Object(w.jsx)("div",{className:"grid grid-cols-2 gap-3 w-full",children:[{title:"Position",value:"(".concat(null===n||void 0===n?void 0:n.position_code,") ").concat(null===n||void 0===n?void 0:n.position_name),special:!1},{title:"Total vacant post",value:u,special:!1}].map((function(e,t){return Object(w.jsxs)("div",{className:"bg-gray-50 py-1 px-2 border rounded flex-1 ",children:[Object(w.jsxs)("span",{className:"text-gray-500 block",children:[e.title,":"]})," ",Object(w.jsx)("b",{children:e.value})]},t)}))})}),Object(w.jsxs)("div",{className:"p-2",children:[Object(w.jsxs)("table",{className:"w-full",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{className:"p-2 border",children:"#"}),Object(w.jsx)("th",{className:"p-2 border",children:"NID"}),Object(w.jsx)("th",{className:"p-2 border",children:"Names"}),Object(w.jsx)("th",{className:"p-2 border",children:"Phone"}),Object(w.jsx)("th",{className:"p-2 border",children:"Email"}),Object(w.jsx)("th",{className:"p-2 border",children:"Gender"}),Object(w.jsx)("th",{className:"p-2 border",children:"School"})]})}),Object(w.jsx)("tbody",{children:this.state.collected_teachers.length<=0?Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{colSpan:6,className:"py-5 text-center",children:[Object(w.jsx)(m.a,{children:"No candidates found!"}),Object(w.jsx)("p",{children:"No results found"})]})}):this.state.collected_teachers.map((function(e,t){var s,i,c,r,a,n,o,l,b,u=d.find((function(t){return t.school_code.toString()===(null===e||void 0===e?void 0:e.school_code.toString())}));return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{className:"p-2 border",children:t+1}),Object(w.jsx)("td",{className:"p-2 border",children:null===e||void 0===e||null===(s=e.user_info)||void 0===s?void 0:s.n_id}),Object(w.jsxs)("td",{className:"p-2 border",children:[null===e||void 0===e||null===(i=e.user_info)||void 0===i||null===(c=i.user_info)||void 0===c?void 0:c.fname," ",null===e||void 0===e||null===(r=e.user_info)||void 0===r||null===(a=r.user_info)||void 0===a?void 0:a.lname]}),Object(w.jsx)("td",{className:"p-2 border",children:null===e||void 0===e||null===(n=e.user_info)||void 0===n?void 0:n.phone_number}),Object(w.jsx)("td",{className:"p-2 border",children:null===e||void 0===e||null===(o=e.user_info)||void 0===o?void 0:o.email}),Object(w.jsx)("td",{className:"p-2 border",children:null===e||void 0===e||null===(l=e.user_info)||void 0===l||null===(b=l.user_info)||void 0===b?void 0:b.sex}),Object(w.jsx)("td",{className:"p-2 border",children:u?"".concat(u.school_code," - ")+u.school_name:""})]},t)}))})]}),Object(w.jsx)("div",{className:"p-2 text-right",children:Object(w.jsx)(h.a,{onClick:function(){return c.setState({collected_candidates_open:!1,collected_teachers:[],customVacant:[],selected_position:""})},theme:"primary-light",className:"mt-1",children:"Add teacher to others position / district"})})]})]}):Object(w.jsxs)(w.Fragment,{children:[!Object(O.r)(this.state.selected_district.toString())&&!Object(O.r)(this.state.selected_position.toString())&&j&&Object(w.jsxs)("div",{className:"fixed bottom-0 right-0 flex left-0 bg-white shadow-lg border-t-2 px-3 items-center",children:[Object(w.jsx)("div",{className:"main-side-spacer"}),Object(w.jsxs)("div",{className:"flex-1 p-2 flex justify-between items-center",children:[Object(w.jsxs)("div",{className:"flex items-center",children:[Object(w.jsxs)("div",{className:"px-2 bg-gray-50 rounded",children:[Object(w.jsx)("span",{className:"text-sm",children:"Waiting list"}),Object(w.jsx)("h3",{className:"font-bold text-2xl -mt-1",children:j.waiting})]}),Object(w.jsxs)("div",{className:"mr-4 bg-green-50 ".concat(j.waiting>=u&&u>0?"text-green-700":"text-red-700"," px-2"),children:[Object(w.jsx)("span",{className:"text-sm",children:"Total requests"}),Object(w.jsx)("h3",{className:"font-bold text-2xl -mt-1",children:u})]})]}),Object(w.jsx)("div",{className:"",children:j.waiting>=u&&u>0?Object(w.jsx)(h.a,{theme:"accent",onClick:function(){return c.submitDataRequestTRS(d)},loading:this.state.loading_candidates_from_trs,className:"animate__animated animate__zoomIn animate__faster",children:"Do placement"}):Object(w.jsx)("span",{className:"text-red-500",children:0===u?"Vacant post is zero!":"Vacant post is greater than waiting list!"})})]})]}),Object(w.jsxs)(x.a,{children:[Object(w.jsx)("div",{className:"flex items-start",children:Object(w.jsxs)("div",{className:"flex-1 mb-3",children:[Object(w.jsx)("div",{className:"text-primary-800 text-2xl font-extrabold mb-2",children:"Do placement"}),Object(w.jsx)(m.a,{size:"sm",theme:"accent",children:Object(w.jsxs)("b",{children:[a?"".concat(a.district_name):"",n?" / ".concat(n.position_name):""]})})]})}),Object(w.jsxs)("div",{className:"flex flex-col sm:flex-row items-start gap-3 justify-between",children:[Object(w.jsx)("div",{className:"flex flex-row items-center gap-3 w-full",children:null===this.state.districts?Object(w.jsx)("div",{className:"font-bold",children:"Loading, please wait..."}):Object(w.jsxs)("div",{className:"w-full",children:[Object(w.jsxs)("div",{onClick:function(){return c.setState({showDistrictsList:!c.state.showDistrictsList})},className:"border font-bold ".concat(!1===this.state.showDistrictsList?"border-gray-400 hover:border-primary-800 hover:bg-blue-100":"border"," hover:text-primary-800 w-full rounded px-3 py-2 bg-white cursor-pointer flex flex-row items-center gap-3 justify-between"),children:[Object(w.jsxs)("div",{className:"flex flex-row items-center gap-3",children:[""!==this.state.selected_district&&a&&Object(w.jsx)("div",{className:"rounded-full px-2 bg-blue-200 text-primary-800",children:Object(O.w)(a.district_name)}),Object(w.jsx)("span",{children:""===this.state.selected_district?"Choose a district":"Change district"})]}),Object(w.jsx)("div",{children:!1===this.state.showDistrictsList?Object(w.jsx)(l.a,{className:"text-xl"}):Object(w.jsx)(l.b,{className:"text-xl"})})]}),!0===this.state.showDistrictsList&&Object(w.jsx)(v.a,{onChange:function(e){c.setState({selected_district:e}),c.FC_GetDistrictDistribution(e)},districts:this.state.districts,selected_district:this.state.selected_district,setVisibility:function(e){c.setState({showDistrictsList:e})}})]})}),Object(w.jsx)("div",{className:"flex flex-row items-center gap-3 w-full",children:null===this.props.basic.positions?Object(w.jsx)("div",{className:"font-bold",children:"Loading, please wait..."}):Object(w.jsxs)("div",{className:"w-full",children:[Object(w.jsxs)("div",{onClick:function(){return c.setState({showPositionList:!c.state.showPositionList})},className:"border font-bold ".concat(!1===this.state.showPositionList?"border-gray-400 hover:border-primary-800 hover:bg-blue-100":"border"," hover:text-primary-800 w-full rounded px-3 py-2 bg-white cursor-pointer flex flex-row items-center gap-3 justify-between"),children:[Object(w.jsxs)("div",{className:"flex flex-row items-center gap-3",children:[""!==this.state.selected_position&&n&&Object(w.jsx)("div",{className:"rounded-full px-2 bg-blue-200 text-primary-800",children:Object(O.w)(n.position_name)}),Object(w.jsx)("span",{children:""===this.state.selected_position?"Choose a position":"Change position"})]}),Object(w.jsx)("div",{children:!1===this.state.showPositionList?Object(w.jsx)(l.a,{className:"text-xl"}):Object(w.jsx)(l.b,{className:"text-xl"})})]}),!0===this.state.showPositionList&&Object(w.jsx)(y,{onChange:function(e){c.setState({selected_position:e})},positions:this.props.basic.positions,selected_position:this.state.selected_position,setVisibility:function(e){c.setState({showPositionList:e})}})]})})]}),Object(w.jsxs)("div",{children:[(Object(O.r)(this.state.selected_district.toString())||Object(O.r)(this.state.selected_position.toString()))&&Object(w.jsx)("div",{onClick:function(){return c.setState({showDistrictsList:!c.state.showDistrictsList})},className:"underline px-5 py-5 cursor-pointer rounded-md mt-5 bg-blue-50 text-gray-900 font-extrabold text-center w-full text-2xl",children:Object(O.r)(this.state.selected_district)?"No district selected!":"No position selected!"}),!Object(O.r)(this.state.selected_district.toString())&&!Object(O.r)(this.state.selected_position.toString())&&Object(w.jsx)("div",{className:"my-3",children:Object(w.jsxs)("table",{className:"w-full text-left table-auto",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{className:"p-2 border",children:"#"}),Object(w.jsx)("th",{className:"p-2 border",children:"School name"}),Object(w.jsx)("th",{className:"p-2 border",children:"Post name"}),Object(w.jsxs)("th",{className:"p-2 border",children:["Existing post","(","s",")"]}),Object(w.jsx)("th",{className:"p-2 border ",children:"Vacant posts"})]})}),Object(w.jsx)("tbody",{children:this.state.loadingDistribution?Object(w.jsx)(p.a,{cols:5}):null===this.state.distributionList||0===this.state.distributionList.academic_distributed.length||0===d.length?Object(w.jsx)("tr",{children:Object(w.jsx)("td",{colSpan:5,className:"p-6 border rounded border-opacity-25 animate__animated animate__fadeIn text-center",children:Object(w.jsx)(m.a,{size:"md",children:"No results found"})})}):d.map((function(e,t){var s=c.FC_GetDistributionValue(e);return Object(w.jsx)(o.Fragment,{children:Object(w.jsxs)("tr",{className:"border rounded hover:bg-blue-500 hover:bg-opacity-20",children:[Object(w.jsx)("td",{className:"p-2 border",children:t+1},t),Object(w.jsx)("td",{className:"p-2 border",children:e.school_name}),Object(w.jsx)("td",{className:"p-2 border",children:e.position_name}),Object(w.jsx)("td",{className:"p-2 border",children:e.existing_post}),c.state.selected_request_id===e.post_request_id?Object(w.jsx)("td",{className:" border  w-20 relative",children:Object(w.jsx)("input",{type:"number",className:"w-full p-1 border-4 rounded-t border-primary-800 font-bold bg-transparent",value:c.state.new_value,onChange:function(e){Number(e.target.value)<0?c.setState({new_value:"0"}):c.setState({new_value:e.target.value})},onBlur:function(t){return c.FC_ChangeCustomVacant(e.dde_post_distribution,t.target.value)},max:e.dde_post_distribution,autoFocus:!0,min:0})}):Object(w.jsx)("td",{className:"p-2 border w-20 font-bold bg-green-100 bg-opacity-40 text-green-800 cursor-pointer",onClick:function(){return c.setState({selected_request_id:e.post_request_id,new_value:s})},children:s})]})},t)}))})]})})]})]})]})}}]),s}(o.Component),C=Object(d.b)((function(e){return{auth:e.auth,basic:e.basic}}),{FC_GetAllPositions:u.A})(S)}}]);
//# sourceMappingURL=36.ffa00396.chunk.js.map