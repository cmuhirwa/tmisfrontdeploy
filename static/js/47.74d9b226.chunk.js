(this.webpackJsonpTMIS=this.webpackJsonpTMIS||[]).push([[47],{566:function(e,t,s){"use strict";s.r(t),s.d(t,"ApproveDocuments",(function(){return k}));var c=s(28),a=s(29),i=s(30),r=s(31),n=s(3),l=s.n(n),d=s(53),o=s(17),u=s(27),m=s(16),h=s(51),b=s(47),j=s(50),x=s(79),_=s(61),g=s(55),p=s(52),f=s(32),O=s(2),v=function(e){var t=Object(n.useState)(!0),s=Object(f.a)(t,2),c=s[0],a=s[1],i=Object(n.useState)(null),r=Object(f.a)(i,2),l=r[0],d=r[1];return Object(n.useEffect)((function(){var t;c&&(null===(t=e.file_url)||null!==t.match(/^ *$/)?d({element:"PDF_FILE",msg:"File url is required"}):null!==l&&d(null),a(!1))}),[l,c,e.file_url]),Object(O.jsx)("div",{className:"w-full",children:l?Object(O.jsx)(h.a,{theme:"danger",children:l.msg}):Object(O.jsx)("object",{data:e.file_url,type:"application/pdf",className:e.class_name,onLoad:function(){return e.setLoadingFile(!1)},children:Object(O.jsx)("iframe",{src:"https://docs.google.com/viewer?url=".concat(e.file_url,"&embedded=true"),className:e.class_name,title:e.frame_title,onLoad:function(){return e.setLoadingFile(!1)},children:Object(O.jsx)("p",{className:"text-2xl opacity-50",children:"This browser does not support PDF!"})})})})},N=s(15),y=s(19),S={target:null,msg:""},w=function(e){Object(i.a)(s,e);var t=Object(r.a)(s);function s(e){var a;return Object(c.a)(this,s),(a=t.call(this,e)).setDocumentDecision=function(e,t){var s;if(window.confirm("Are you sure you want to ".concat(!0===t?"Approve":"Reject"," this document?"))){if(!a.props.auth.user||!a.props.auth.user.user_id)return a.setState({error:{target:"main-error",msg:"Your id is not valid, please refresh your browser"}});if(!e)return a.setState({error:{msg:"No selected document",target:"main-error"}});a.setState({loading_document_decision:!0}),Object(m.d)({disability:t,residence:!1,teacher_transfer_id:e,user_id:null===(s=a.props.auth.user)||void 0===s?void 0:s.user_id},(function(s,c,i){a.setState({loading_document_decision:!1,documents:!0===s?a.state.documents.filter((function(t){return t.teacher_transfer_id!==e})):a.state.documents,error:!0===s?{msg:"The document have been ".concat(!0===t?"Approved":"Rejected"),target:"main-success"}:{msg:"Error: ".concat(i),target:"main-error"}}),a.clearAlert()}))}},a.changeStatus=function(e){a.state.status!==e&&a.state.selected_district&&(a.setState({status:e}),a.loadingData(a.state.selected_district.district_code,1,e))},a.clearAlert=function(){return setTimeout((function(){a.setState({error:S})}),3e3)},a.paginateData=function(e){a.state.selected_district&&a.loadingData(a.state.selected_district.district_code,e)},a.loadingData=function(e,t,s){a.setState({loading:!0,selected_document_id:null,documents:[]}),Object(m.w)({district_code:e,limit:a.state.limit,page:t,status:s||a.state.status},(function(e,s,c){a.setState({loading:!1,documents:null!==s&&void 0!==s&&s.teacher_docs?null===s||void 0===s?void 0:s.teacher_docs:[],total:null!==s&&void 0!==s&&s.total_transfer?s.total_transfer:0,next:null!==s&&void 0!==s&&s.next?+(null===s||void 0===s?void 0:s.next):0,previous:null!==s&&void 0!==s&&s.previous?+(null===s||void 0===s?void 0:s.previous):0,error:e?S:{target:"main-error",msg:"Error: ".concat(c)},page:t})}))},a.getTotalDistrictsNumber=function(){a.setState({loading_disabled_by_district:!0,documents_by_districts:[],total_disabled_by_district:"0",total_validated:"0"}),Object(m.wb)((function(e,t,s){a.setState({loading_disabled_by_district:!1,documents_by_districts:t?t.districts:[],total_disabled_by_district:t?t.total:"0",total_validated:t?t.total_validated:"0",error:e?{msg:"",target:null}:{msg:s,target:"main-error"}})}))},a.openLink=function(e){e&&window.open("".concat(N.e,"/").concat(e))},a.state={loading:!1,loading_districts:!1,districts:[],search_district:"",error:S,documents:[],limit:10,page:1,total:0,selected_user:"",decision_disability:null,decision_residence:null,selected_district:null,status:"remain",selected_document_id:"",next:null,previous:null,loading_document_file:!0,loading_document_decision:!1,loading_disabled_by_district:!0,total_disabled_by_district:"0",documents_by_districts:[],total_validated:"0"},a}return Object(a.a)(s,[{key:"componentDidMount",value:function(){var e=this;Object(m.v)((function(t,s,c){e.setState({districts:s,loading_districts:!1,error:!0===t?S:{target:"main-error",msg:"Districts: ".concat(c)},documents:[]})})),this.getTotalDistrictsNumber()}},{key:"selectDistrict",value:function(e){this.setState({selected_district:e,page:1,total:0,documents:[]}),null!==e&&this.loadingData(e.district_code,this.state.page,this.state.status),null===e&&this.getTotalDistrictsNumber()}},{key:"render",value:function(){var e=this,t=(this.state.total/this.state.limit).toFixed(0),s=this.state.documents.find((function(t){return t.teacher_transfer_id===e.state.selected_document_id})),c=Object(y.i)(this.state.districts,this.state.search_district,{district_code:!0,district_name:!0});return null===this.state.selected_district?Object(O.jsx)(j.a,{className:"animate__animated animate__zoomIn animate__faster",children:Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{className:"flex items-center",children:[Object(O.jsx)("h1",{className:"flex-1 text-2xl font-bold",children:"Documents validation"}),Object(O.jsx)("section",{className:"p-1 bg-green-100 rounded mx-2",children:Object(O.jsxs)("span",{className:"text-sm text-green-800",children:["Total:"," ",Object(O.jsx)("b",{className:"text-black",children:this.state.total_disabled_by_district})]})}),Object(O.jsx)("section",{className:"p-1 bg-green-100 rounded",children:Object(O.jsxs)("span",{className:"text-sm text-green-800",children:["Total validated:"," ",Object(O.jsx)("b",{className:"text-black",children:this.state.total_validated})]})})]}),Object(O.jsx)("div",{className:"p-2",children:Object(O.jsx)(_.a,{error:"",label:"",name:"",onChange:function(t){return e.setState({search_district:t.target.value})},placeholder:"Search district by name",value:this.state.search_district})}),!0===this.state.loading_districts?Object(O.jsx)("div",{className:"py-8 text-center text-8xl text-accent-900",children:Object(O.jsx)(g.a,{className:"mx-auto"})}):this.state.districts.length>=1?Object(O.jsx)(O.Fragment,{children:c.length<=0?Object(O.jsxs)("div",{className:"py-4 text-center",children:[Object(O.jsx)("h2",{className:"text-lg",children:"No results found!"}),Object(O.jsx)("p",{className:"text-gray-500",children:"Please use a correct district name"})]}):Object(O.jsx)("div",{className:"grid lg:grid-cols-2 gap-2 ",children:c.map((function(t){var s=e.state.documents_by_districts.find((function(e){return e.district_code===t.district_code}));return Object(O.jsxs)("div",{onClick:e.selectDistrict.bind(e,t),className:"p-2 flex items-center cursor-pointer rounded border  px-3 hover:text-yellow-600 hover:border-yellow-600 hover:bg-yellow-50 bg-white text-lg",children:[Object(O.jsxs)("h4",{className:"flex-1 text-lg",children:[" ",Object(O.jsx)("b",{children:t.district_name})," district"]}),s&&"0"!==s.total&&Object(O.jsx)("span",{className:"bg-yellow-100 text-yellow-700 font-bold py-0.5 inline-block text-sm px-1.5 rounded-full",children:null===s||void 0===s?void 0:s.total}),s&&"0"!==s.total&&Object(O.jsx)("button",{className:"",children:Object(O.jsx)(o.H,{})})]},t.district_code)}))})}):Object(O.jsxs)("div",{className:"py-4 text-center",children:[Object(O.jsx)("h2",{className:"text-8xl text-gray-400 text-center",children:Object(O.jsx)(d.f,{className:"inline"})}),Object(O.jsx)("h2",{className:"text-center p-4 text-gray-400 font-bold text-2xl",children:Object(O.jsx)("p",{children:"No results found on"})})," "]})]})}):Object(O.jsxs)(O.Fragment,{children:["main-success"===this.state.error.target&&Object(O.jsx)(h.a,{theme:"success",fixed:!0,onClick:function(){return e.setState({error:S})},children:this.state.error.msg}),"main-error"===this.state.error.target&&Object(O.jsx)(h.a,{theme:"danger",fixed:!0,onClick:function(){return e.setState({error:S})},children:this.state.error.msg}),void 0!==s&&this.state.selected_document_id&&Object(O.jsx)(p.c,{backDrop:!0,theme:p.b.default,close:function(){return e.setState({selected_document_id:null})},backDropClose:!1,widthSizeClass:p.a.maxWidth,displayClose:!0,title:"".concat(s.full_name,"'s document"),padding:{title:!0,body:void 0,footer:void 0},children:Object(O.jsxs)("div",{className:" border-t h-full flex",children:[Object(O.jsx)("div",{className:"flex-1 bg-gray-600",children:Object(O.jsx)(v,{file_url:"".concat(N.e,"/").concat(s.disability_surpoting_document),class_name:"w-full h-100vh",frame_title:"User document",setLoadingFile:function(){return e.setState({loading_document_file:!1})},full_height:!0})}),Object(O.jsxs)("div",{className:"w-96",children:[Object(O.jsx)("h2",{className:"text-gray-500 p-1 px-2 bg-gray-100 text-2xl text-center",children:"Teacher's information"}),"main-success"===this.state.error.target&&Object(O.jsx)(h.a,{theme:"success",onClick:function(){return e.setState({error:S})},children:this.state.error.msg}),"main-error"===this.state.error.target&&Object(O.jsx)(h.a,{theme:"danger",onClick:function(){return e.setState({error:S})},children:this.state.error.msg}),Object(O.jsxs)("section",{className:"border-b py-4",children:[Object(O.jsx)("h2",{className:"text-8xl text-gray-500",children:Object(O.jsx)(o.c,{className:"mx-auto"})}),Object(O.jsx)("h3",{className:"text-center font-bold text-xl",children:s.full_name})]}),Object(O.jsx)("div",{className:"p-2",children:[{title:"DOB: ",value:s.dob},{title:"Hire date: ",value:s.hire_date},{title:"Martial Status: ",value:s.martial_status},{title:"Position name: ",value:s.position_name},{title:"Qualification: ",value:s.qualification_name},{title:"Residence: ",value:s.resident_district_name},{title:"Role: ",value:s.role},{title:"School name: ",value:s.school_name}].map((function(e,t){var s=e.title,c=e.value;return Object(O.jsxs)("div",{className:"flex items-center px-1 py-1.5 border-b",children:[Object(O.jsx)("section",{className:"text-gray-600 pr-2",children:s}),Object(O.jsx)("section",{className:"font-bold",children:c})]},t)}))}),Object(O.jsxs)("div",{className:"py-2 text-center flex gap-2 px-3",children:[Object(O.jsx)(b.a,{size:"sm",theme:"default",onClick:this.openLink.bind(this,s.disability_surpoting_document),children:"Open document in a new tab"}),Object(O.jsx)("a",{href:"".concat(N.e,"/").concat(s.disability_surpoting_document),rel:"noreferrer",target:"_blank",download:!0,children:Object(O.jsx)(b.a,{size:"sm",theme:"primary-light",children:"Download"})})]}),Object(O.jsx)("div",{className:"p-2",children:Object(O.jsx)(b.a,{className:"w-full",theme:"success-light",size:"lg",onClick:this.setDocumentDecision.bind(this,s.teacher_transfer_id,!0),loading:this.state.loading_document_decision,children:"Yes, the document is valid"})}),Object(O.jsx)("div",{className:"p-2",children:Object(O.jsx)(b.a,{className:"w-full",theme:"danger-light",size:"lg",onClick:this.setDocumentDecision.bind(this,s.teacher_transfer_id,!1),loading:this.state.loading_document_decision,children:"No, the document is not valid"})})]})]})}),Object(O.jsxs)("div",{className:"animate__animated animate__zoomIn animate__faster pt-2",children:[Object(O.jsxs)("div",{className:"container mx-auto px-2 flex items-center",children:[Object(O.jsx)(b.a,{onClick:this.selectDistrict.bind(this,null),theme:"default",children:"Back"}),Object(O.jsx)(x.a,{className:"flex-1 m-0",children:"Document validation"}),Object(O.jsx)("section",{children:Object(O.jsxs)("div",{className:"flex flex-1 gap-1 mr-2 bg-yellow-100 p-1 rounded border border-yellow-400",children:[Object(O.jsx)(b.a,{size:"sm",theme:"remain"===this.state.status?"accent":"accent-light",onClick:this.changeStatus.bind(this,"remain"),children:"Remain"}),Object(O.jsx)(b.a,{size:"sm",theme:"complete"===this.state.status?"accent":"accent-light",onClick:this.changeStatus.bind(this,"complete"),children:"Completed"})]})}),Object(O.jsxs)("section",{className:"text-center bg-accent-800 bg-opacity-20 text-accent-900 px-4 rounded",children:[Object(O.jsx)("span",{className:"text-sm block text-gray-500 -mb-1",children:"Total:"}),Object(O.jsx)("h3",{className:"font-bold text-xl",children:this.state.total})]})]}),Object(O.jsxs)(j.a,{children:[Object(O.jsxs)("table",{className:"w-full",children:[Object(O.jsx)("thead",{className:"text-left bg-white",children:Object(O.jsxs)("tr",{className:"bg-accent-900 bg-opacity-10",children:[Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"#"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"Names"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"School Code"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"School name"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"Position code"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"Position name"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"Qualification"})]})}),Object(O.jsx)("tbody",{children:!0===this.state.loading?Object(O.jsx)("tr",{className:" ",children:Object(O.jsx)("td",{colSpan:8,className:"py-4 text-center border",children:Object(O.jsx)(g.a,{})})}):this.state.documents.length<=0?Object(O.jsx)("tr",{children:Object(O.jsx)("td",{colSpan:8,className:"py-4 text-center border",children:Object(O.jsx)("h1",{className:"text-2xl text-gray-400",children:"No data found"})})}):this.state.documents.map((function(t,s){return Object(O.jsxs)("tr",{className:"bg-white cursor-pointer hover:bg-yellow-400 hover:bg-opacity-30",onClick:function(){return e.setState({selected_document_id:t.teacher_transfer_id})},children:[Object(O.jsx)("td",{className:"border p-2",children:s+1}),Object(O.jsx)("td",{className:"p-2 border",children:t.full_name}),Object(O.jsx)("td",{className:"p-2 border",children:t.school_from_id}),Object(O.jsx)("td",{className:"p-2 border",children:t.school_name}),Object(O.jsx)("td",{className:"p-2 border",children:t.position_id}),Object(O.jsx)("td",{className:"p-2 border text-sm",children:t.position_name}),Object(O.jsx)("td",{className:"p-2 border",children:t.qualification_name})]},s)}))})]}),Object(O.jsx)("div",{className:"flex gap-3 mx-auto pt-3",children:Array(+t).fill("0").map((function(t,s){return Object(O.jsx)("button",{className:"p-2 py-1 ".concat(+e.state.page===s+1?"bg-accent-800 text-black font-bold":"bg-opacity-25"," rounded-full bg-accent-800 "),onClick:e.paginateData.bind(e,s+1),children:s+1})}))})]})]})]})}}]),s}(l.a.Component),k=Object(u.b)((function(e){return{auth:e.auth}}),{})(w)}}]);
//# sourceMappingURL=47.74d9b226.chunk.js.map