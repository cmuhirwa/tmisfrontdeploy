(this.webpackJsonpTMIS=this.webpackJsonpTMIS||[]).push([[7],{356:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return _})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return p}));var a=r(3),c=r(6),s=r(7),n=r.n(s),i=r(13),o=r(12),d=r(9),l=r(11),u=function(e,t){return t(!0,null,""),function(){var r=Object(c.a)(Object(a.a)().mark((function r(c){var s,u;return Object(a.a)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,c({type:i.a.GET_ALL_TRANSFER,payload:[]}),Object(d.a)(),r.next=5,n.a.get("".concat(o.e,"/teachertransfers/requesteddde/").concat(e));case 5:s=r.sent,u=s.data.filter((function(e){return"APPROVED"===e.requested_status})),c({type:i.a.GET_ALL_TRANSFER,payload:u}),t(!1,u,""),r.next=14;break;case 11:r.prev=11,r.t0=r.catch(0),t(!1,null,Object(l.a)(r.t0));case 14:case"end":return r.stop()}}),r,null,[[0,11]])})));return function(e){return r.apply(this,arguments)}}()},_=function(){var e=Object(c.a)(Object(a.a)().mark((function e(t){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t(!1,[{district_code:"11",district_name:"Nyarugenge"},{district_code:"12",district_name:"Gasabo"},{district_code:"13",district_name:"Kicukiro"},{district_code:"21",district_name:"Nyanza"},{district_code:"22",district_name:"Gisagara"},{district_code:"23",district_name:"Nyaruguru"},{district_code:"24",district_name:"Huye"},{district_code:"25",district_name:"Nyamagabe"},{district_code:"26",district_name:"Ruhango"},{district_code:"27",district_name:"Muhanga"},{district_code:"28",district_name:"Kamonyi"},{district_code:"31",district_name:"Karongi"},{district_code:"32",district_name:"Rutsiro"},{district_code:"33",district_name:"Rubavu"},{district_code:"34",district_name:"Nyabihu"},{district_code:"35",district_name:"Ngororero"},{district_code:"36",district_name:"Rusizi"},{district_code:"37",district_name:"Nyamasheke"},{district_code:"41",district_name:"Rulindo"},{district_code:"42",district_name:"Gakenke"},{district_code:"43",district_name:"Musanze"},{district_code:"44",district_name:"Burera"},{district_code:"45",district_name:"Gicumbi"},{district_code:"51",district_name:"Rwamagana"},{district_code:"52",district_name:"Nyagatare"},{district_code:"53",district_name:"Gatsibo"},{district_code:"54",district_name:"Kayonza"},{district_code:"55",district_name:"Kirehe"},{district_code:"56",district_name:"Ngoma"},{district_code:"57",district_name:"Bugesera"}],"");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(c.a)(Object(a.a)().mark((function e(t,r){var c,s,i;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(!0,c=0,null,""),e.prev=2,Object(d.a)(),(s=new FormData).append("teacher_supporting_document",t),e.next=8,n.a.post("".concat(o.e,"/teachertransfers/uploadSupportingDocument"),s,{onUploadProgress:function(e){c=+(null===e||void 0===e?void 0:e.loaded)/+e.total*100,r(!0,c,null,"")}});case 8:i=e.sent,console.log("Uploaded document: ",i.data),r(!1,c,i.data,""),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),console.error(e.t0),r(!1,c,"",Object(l.a)(e.t0));case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t,r){return e.apply(this,arguments)}}(),p=function(e,t,r){r(!0,"");return function(){var s=Object(c.a)(Object(a.a)().mark((function c(s){var u,_;return Object(a.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r(!0,""),console.log("==================doc_title=================="),console.log({doc_title:""}),console.log("==================doc_title=================="),r(!0,""),(u=new FormData).append("teacher_transfer_id",e),u.append("mayor_letter",t),console.log("==================*********************=================="),console.log({doc_title:""}),console.log("==================*********************=================="),a.prev=11,Object(d.a)(),a.next=15,n.a.post("".concat(o.e,"/teachertransfers/outgoing"),u);case 15:_=a.sent,console.log("Uploaded document: ",_.data),s({type:i.a.UPLOAD_SIGNED_DOCUMENT,payload:{teacher_transfer_id:e,mayor_letter:_.data.mayor_letter}}),r(!1,""),a.next=25;break;case 21:a.prev=21,a.t0=a.catch(11),console.error(a.t0),r(!1,Object(l.a)(a.t0));case 25:case"end":return a.stop()}}),c,null,[[11,21]])})));return function(e){return s.apply(this,arguments)}}()}},363:function(e,t,r){"use strict";r(4);var a=r(1);t.a=function(e){var t=function(){for(var t=[],r=0;r<e.cols;r++)t.push(r);return t.map((function(e){return Object(a.jsx)("td",{className:"p-3 text-center whitespace-nowrap",children:Object(a.jsx)("div",{className:"w-full h-4 rounded bg-gray-200 animate__animated animate__pulse animate__delay-5s animate__infinite"})},e)}))};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("tr",{className:"border-b border-gray-200",children:t()},228),Object(a.jsx)("tr",{className:"border-b border-gray-200",children:t()},22648),Object(a.jsx)("tr",{className:"border-b border-gray-200",children:t()},229768)]})}},395:function(e,t,r){"use strict";r(4);var a=r(46),c=r(12),s=r(19),n=r(1);t.a=function(e){var t="uploaded"===e.linkFor?"".concat(c.f,"/").concat(e.first_id):"".concat(c.e,"/generateletter/").concat(e.linkFor,"/").concat(e.first_id,"/").concat(e.last_id);return Object(n.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:Object(n.jsxs)(s.a,{theme:"primary-light",size:"sm",className:"flex items-center gap-1",children:[Object(n.jsx)(a.a,{}),Object(n.jsx)("span",{children:e.title})]})})}},486:function(e,t,r){"use strict";var a=r(20),c=r(21),s=r(22),n=r(23),i=r(4),o=r.n(i),d=r(36),l=r(356),u=r(47),_=r(19),m=r(395),p=r(139),h=r(39),b=r(363),f=r(17),j=r(27),O=r(65),g=r(1),x=Object(d.b)(null,{FC_UploadSignedDocument:l.d})((function(e){var t=o.a.useState(null),r=Object(j.a)(t,2),a=r[0],c=r[1],s=o.a.useState(null),n=Object(j.a)(s,2),i=n[0],d=n[1],l=o.a.useState(!1),m=Object(j.a)(l,2),p=m[0],h=m[1];return Object(g.jsxs)("div",{className:"animate__animated animate__zoomIn animate__faster absolute p-1 bg-primary-800 rounded -mt-2 z-40 w-auto mx-2 sm:mx-0 sm:w-80 right-0 pb-2",children:[a&&"main-success"===a.target&&Object(g.jsx)(u.a,{theme:"success",fixed:!0,children:a&&a.msg}),a&&"main-error"===a.target&&Object(g.jsx)(u.a,{theme:"danger",fixed:!0,children:a&&a.msg}),Object(g.jsx)("div",{className:"px-2",children:Object(g.jsx)(O.b,{disabled:p,labelColor:"text-gray-300",label:"Signed document",name:"approved_doc",className:"p-2",onChange:function(e){return function(e){if(c(null),null===e.target.files)return d(null),c({msg:"Please select a valid file",target:"approved_doc"});var t=e.target.files[0];return"application/pdf"!==t.type?(d(null),c({msg:"The system accept pdf only",target:"approved_doc"})):t.size<=0?(d(null),c({msg:"Invalid file, Please choose a real file",target:"approved_doc"})):(d(t),void c(null))}(e)},error:a&&"approved_doc"===a.target?a.msg:"",type:"file",accept:O.a.PDF})}),Object(g.jsxs)("div",{className:"flex justify-between gap-2 px-2",children:[Object(g.jsx)(_.a,{theme:"default",onClick:function(){e.setSelectedUserId(""),d(null)},disabled:p,children:"Cancel"}),Object(g.jsx)("div",{className:"flex gap-2",children:Object(g.jsx)(_.a,{theme:"success",disabled:p,onClick:function(t){null!==i?e.FC_UploadSignedDocument(e.selectedUserId,i,(function(t,r){h(t),t||Object(f.j)(r)?Object(f.j)(r)&&(c({target:"main-success",msg:"Document uploaded successfully!"}),d(null),setTimeout((function(){e.setSelectedUserId("")}),1e3)):c({target:"main-error",msg:r})})):c({target:"approved_doc",msg:"Required!"})},children:"Upload"})})]})]})})),v=function(e){Object(s.a)(r,e);var t=Object(n.a)(r);function r(e){var c;return Object(a.a)(this,r),(c=t.call(this,e)).componentDidMount=function(){var e,t,r="";if(c.props.district_code)r=c.props.district_code;else{if(null===(e=c.props.auth.district)||void 0===e||!e.district_code)return c.setState({error:{target:"main-error",msg:"No district assigned to you"}});r=null===(t=c.props.auth.district)||void 0===t?void 0:t.district_code}c.setState({selected_district_id:r}),c.props.FC_GetAllTransfers(r,(function(e,t,r){c.setState({loading:e}),!e&&t?c.setState({loading:e}):e||Object(f.j)(r)||c.setState({error:{target:"main-error",msg:r}})}))},c.getTransferById=function(e){if(c.props.transfer.allTransfers)return c.props.transfer.allTransfers.find((function(t){return t.teacher_transfer_id.toString()===e}))},c.FC_DisplaySchools=function(e){return e.map((function(e,t){return Object(g.jsxs)("p",{children:[t+1," ",e.school_name]})}))},c.state={loading:!0,error:null,search:"",selectedUserId:"",selected_district_id:""},c}return Object(c.a)(r,[{key:"render",value:function(){var e=this;return Object(g.jsxs)(g.Fragment,{children:[null!==this.state.error&&"main-error"===this.state.error.target&&Object(g.jsx)(u.a,{fixed:!0,theme:"danger",children:this.state.error.msg}),Object(g.jsxs)("div",{className:"mt-3",children:[Object(g.jsxs)("div",{className:"border border-t mt-2 mb-1 flex items-center px-3 rounded",children:[Object(g.jsx)("div",{className:"flex-1 pr-2",children:Object(g.jsx)(h.a,{error:"",label:"Search",type:"search",name:"",onChange:function(t){return e.setState({search:t.target.value})},placeholder:"Search",value:this.state.search,size:"sm"})}),Object(g.jsx)("div",{className:"p-2",children:this.props.transfer.allTransfers&&this.props.transfer.allTransfers.length>=1&&Object(g.jsx)(p.a,{fileData:this.props.transfer.allTransfers.map((function(e){var t,r,a,c,s,n;return{approved_school_id:e.approved_school_id,Approved_school_name:null===(t=e.approved_school_info)||void 0===t?void 0:t.school_name,Approved_school_code:null===(r=e.approved_school_info)||void 0===r?void 0:r.school_code,Approved_school_district:null===(a=e.approved_school_info)||void 0===a?void 0:a.district_name,position_code:e.position_code,position_name:e.position_name,qualification_name:e.qualification_name,requested_comment:e.requested_comment,school_from_name:null===(c=e.school_from_info)||void 0===c?void 0:c.school_name,school_from_code:null===(s=e.school_from_info)||void 0===s?void 0:s.school_code,school_from_district:null===(n=e.school_from_info)||void 0===n?void 0:n.district_name,teacher_id:e.teacher_id,teacher_comment:e.teacher_comment,teacher_last_name:e.teacher_last_name,teacher_full_name:e.teacher_full_name,teacher_phone_number:e.teacher_phone_number,transfer_reason:e.transfer_reason,transfer_type:e.transfer_type}})),fileName:"INCOMING TRANSFERS",btnName:"Download EXCEL"})})]}),Object(g.jsx)("div",{className:"w-full overflow-x-auto mt-4",children:Object(g.jsxs)("table",{className:"w-full",children:[Object(g.jsx)("thead",{className:"bg-blue-50 text-blue-800 font-bold text-base text-left",children:Object(g.jsxs)("tr",{children:[Object(g.jsx)("th",{className:"p-2 border",children:"#"}),Object(g.jsx)("th",{className:"p-2 border",children:"Full Name"}),Object(g.jsx)("th",{className:"p-2 border",children:"Phone"}),Object(g.jsx)("th",{className:"p-2 border",children:"Current School"}),Object(g.jsx)("th",{className:"p-2 border",children:"Approved School"}),Object(g.jsx)("th",{className:"p-2 border",children:"Position"}),Object(g.jsx)("th",{className:"p-2 border",children:"Qualification"}),this.props.hideActions?null:Object(g.jsx)("th",{className:"p-2 border"})]})}),Object(g.jsx)("tbody",{children:this.state.loading?Object(g.jsx)(b.a,{cols:8}):null===this.props.transfer.allTransfers?Object(g.jsx)("tr",{className:"border-t border-b",children:Object(g.jsx)("td",{colSpan:8,className:"p-6 border rounded border-opacity-25 animate__animated animate__fadeIn text-center",children:"Something went wrong! Please try again."})}):this.props.transfer.allTransfers.length<=0?Object(g.jsx)("tr",{children:Object(g.jsx)("td",{colSpan:8,className:"p-6 border rounded border-opacity-25 animate__animated animate__fadeIn text-center",children:"No results found"})}):Object(f.n)(this.props.transfer.allTransfers,this.state.search).map((function(t,r){return Object(g.jsxs)("tr",{className:"border-t border-b hover:bg-gray-50",children:[Object(g.jsx)("td",{className:"p-2 border",children:r+1}),Object(g.jsx)("td",{className:"p-2 border",children:t.teacher_full_name}),Object(g.jsx)("td",{className:"p-2 border",children:t.teacher_phone_number}),Object(g.jsx)("td",{className:"p-2 border",children:t.school_from_info?t.school_from_info.school_name:""}),Object(g.jsx)("td",{className:"p-2 border",children:t.requested_school_info?e.FC_DisplaySchools(t.requested_school_info):""}),Object(g.jsxs)("td",{className:"p-2 border",children:[t.position_code," ",t.position_name]}),Object(g.jsx)("td",{className:"p-2 border",children:t.qualification_name}),e.props.hideActions?null:Object(g.jsx)(g.Fragment,{children:e.state.selectedUserId===t.teacher_transfer_id.toString()?Object(g.jsx)("td",{className:"p-2 border",children:Object(g.jsx)(x,{selectedUserId:e.state.selectedUserId,setSelectedUserId:function(t){return e.setState({selectedUserId:t})}})}):Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)("td",{className:"p-2 border-1 flex gap-2",children:[null===t.mayor_letter||Object(f.j)(t.mayor_letter)?Object(g.jsx)(_.a,{size:"sm",theme:"success-light",onClick:function(r){return e.setState({selectedUserId:t.teacher_transfer_id.toString()})},children:"Upload signed letter"}):t.requested_status,null===t.mayor_letter||Object(f.j)(t.mayor_letter)?Object(g.jsx)(m.a,{linkFor:"transfer",first_id:t.teacher_transfer_id,last_id:t.teacher_id,title:"Transfer letter"}):t.mayor_letter&&!Object(f.j)(t.mayor_letter)&&Object(g.jsx)(m.a,{linkFor:"uploaded",first_id:t.mayor_letter,last_id:"",title:"Transfer letter"})]})})})]},t.teacher_transfer_id)}))})]})})]})]})}}]),r}(i.Component);t.a=Object(d.b)((function(e){return{auth:e.auth,basic:e.basic,transfer:e.transfer}}),{FC_GetAllTransfers:l.a})(v)}}]);
//# sourceMappingURL=7.c14c14b5.chunk.js.map