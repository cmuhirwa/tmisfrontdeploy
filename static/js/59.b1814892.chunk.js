(this.webpackJsonpTMIS=this.webpackJsonpTMIS||[]).push([[59],{624:function(e,t,s){"use strict";s.r(t),s.d(t,"ApproveNewVacantTobeFilled",(function(){return w}));var c=s(19),a=s(20),l=s(21),r=s(22),n=s(4),i=s.n(n),o=s(36),d=s(13),h=s(47),b=s(23),j=s(53),x=s(92),m=s(39),u=s(25),p=s(15),O=s(1),g=function(e){var t=e.data;return Object(O.jsx)(j.a,{className:"bg-blue-dark",children:Object(O.jsx)("div",{className:"p-2 flex flex-col lg:flex-row gap-3 text-center",children:t.map((function(e){return Object(O.jsx)("div",{className:"flex w-full p-2 border rounded border-opacity-40 border-blue-200 ",children:Object(O.jsxs)("div",{className:"flex-1",children:[Object(O.jsx)("h3",{className:"text-blue-200 text-lg font-bold",children:e.qualification_name}),Object(O.jsxs)("div",{className:"flex gap-2",children:[Object(O.jsxs)("div",{className:"p-0.5 bg-green-800 bg-opacity-20 px-2 rounded flex-1 border-green-400 border border-opacity-40",children:[Object(O.jsx)("label",{className:"text-sm text-green-400",children:"Approved"}),Object(O.jsx)("h1",{className:"text-white text-xl -mt-1 font-bold ",children:e.APPROVED})]}),Object(O.jsxs)("div",{className:"p-0.5 bg-yellow-800 bg-opacity-20 px-2 rounded flex-1 border-yellow-400 border border-opacity-40",children:[Object(O.jsx)("label",{className:"text-sm text-yellow-400",children:"Waiting"}),Object(O.jsx)("h1",{className:"text-white text-xl -mt-1 font-bold ",children:e.WAITING})]}),Object(O.jsxs)("div",{className:"p-0.5 bg-red-800 bg-opacity-20 px-2 rounded flex-1 border-red-400 border border-opacity-40",children:[Object(O.jsx)("label",{className:"text-sm text-red-400",children:"Rejected"}),Object(O.jsx)("h1",{className:"text-white text-xl -mt-1 font-bold ",children:e.REJECTED})]}),Object(O.jsxs)("div",{className:"p-0.5 bg-blue-800 bg-opacity-20 px-2 rounded flex-1 border-blue-400 border border-opacity-40",children:[Object(O.jsx)("label",{className:"text-sm text-blue-400",children:"Total"}),Object(O.jsx)("h1",{className:"text-white text-xl -mt-1 font-bold ",children:e.TOTAL})]})]})]})})}))})})},f=s(11),N=s(41),_=s(16),v=function(e){Object(l.a)(s,e);var t=Object(r.a)(s);function s(e){var a;return Object(c.a)(this,s),(a=t.call(this,e)).cleanError=function(){return a.setState({error:{target:null,msg:""}})},a.addNewItem=function(e){return a.setState({data:[].concat(Object(N.a)(a.state.data),[e])})},a.selectItem=function(e){!0!==a.state.submit_status_loading&&(a.state.selected_posts.find((function(t){return t===e}))?a.setState({selected_posts:a.state.selected_posts.filter((function(t){return t!==e}))}):a.setState({selected_posts:[].concat(Object(N.a)(a.state.selected_posts),[e])}))},a.submitSelected=function(e){console.log("Yes we are submitting"),a.setState({submit_status_loading:!0}),Object(d.i)({school_need_post_id:a.state.selected_posts,status:e},(function(t,s,c){!0===t?a.setState({submit_status_loading:!1,data:a.state.data.map((function(t){return a.state.selected_posts.find((function(e){return e===t.school_need_post_id}))?Object(f.a)(Object(f.a)({},t),{},{status:e}):t})),error:{target:"main-success",msg:"Data updated successfully"}}):a.setState({submit_status_loading:!1,error:{target:"main-error",msg:"Error: ".concat(c)}})}))},a.state={error:{target:null,msg:""},loading_assets:!1,create_request:!1,assets:null,data:[],loading_data:!1,loading_hierarchy:!1,delete_loading:!1,deleting_item:"",selected_posts:[],submit_status_loading:!1},a}return Object(a.a)(s,[{key:"componentDidMount",value:function(){var e,t,s=this;this.setState({loading_data:!0,loading_hierarchy:!0}),console.log({school_code:null===(e=this.props.school)||void 0===e?void 0:e.school_code}),Object(d.Fb)((null===(t=this.props.school)||void 0===t?void 0:t.school_code)+"",(function(e,t,c){!0===e?s.setState({data:t,loading_data:!1}):s.setState({data:[],loading_data:!1,error:{target:"main-error",msg:"Error: ".concat(c)}})}))}},{key:"render",value:function(){var e,t,s=this,c=this.state.data.filter((function(e){return"A0"===e.qualification_name})).length,a=this.state.data.filter((function(e){return"A1"===e.qualification_name})).length,l=this.state.data.filter((function(e){return"A2"===e.qualification_name})).length;return Object(O.jsxs)(O.Fragment,{children:["main-error"===this.state.error.target&&Object(O.jsx)(h.a,{theme:"danger",fixed:!0,onClick:this.cleanError,children:this.state.error.msg}),"main-success"===this.state.error.target&&Object(O.jsx)(h.a,{theme:"success",fixed:!0,onClick:this.cleanError,children:this.state.error.msg}),Object(O.jsxs)(j.a,{className:"flex items-center sticky top-1 z-50 mx-auto",children:[Object(O.jsx)("section",{className:"pr-3",children:Object(O.jsx)(b.a,{theme:"primary-light",onClick:this.props.close,children:"Back"})}),Object(O.jsx)("div",{className:"w-full flex items-center",children:Object(O.jsxs)("section",{className:"flex-1",children:[Object(O.jsx)(x.a,{size:"md",children:"Vacant posts to be filled "}),Object(O.jsx)("p",{className:"m-0 text-gray-400 text-lg",children:Object(O.jsxs)("b",{className:"text-blue-500",children:[null===(e=this.props.school)||void 0===e?void 0:e.school_code," - ",null===(t=this.props.school)||void 0===t?void 0:t.school_name]})})]})}),Object(O.jsxs)("div",{className:"flex gap-1 border p-1 px-1.5 rounded  text-center",children:[Object(O.jsxs)("section",{className:"border p-0.5 px-3 rounded bg-gray-100 flex items-center",children:[Object(O.jsx)("span",{className:"text-sm text-gray-500 pr-2",children:"A0: "}),Object(O.jsx)("h2",{className:"font-bold text-blue-700",children:c})]}),Object(O.jsxs)("section",{className:"border p-0.5 px-3 rounded bg-gray-100 flex items-center",children:[Object(O.jsx)("span",{className:"text-sm text-gray-500 pr-2",children:"A1: "}),Object(O.jsx)("h2",{className:"font-bold text-blue-700",children:a})]}),Object(O.jsxs)("section",{className:"border p-0.5 px-3 rounded bg-gray-100 flex items-center",children:[Object(O.jsx)("span",{className:"text-sm text-gray-500 pr-2",children:"A2: "}),Object(O.jsx)("h2",{className:"font-bold text-blue-700",children:l})]}),Object(O.jsx)("div",{className:"flex-1"}),Object(O.jsxs)("section",{className:"border p-0.5 px-3 rounded bg-gray-100 flex items-center",children:[Object(O.jsx)("span",{className:"text-sm text-gray-500 pr-2",children:"Total: "}),Object(O.jsx)("h2",{className:"font-bold text-blue-700",children:l+a+c})]})]}),0!==this.state.selected_posts.length&&Object(O.jsx)("div",{className:"flex ml-1 gap-1 border p-1 px-1.5 rounded  text-center",children:!0===this.state.submit_status_loading?Object(O.jsxs)(b.a,{className:"w-52 animate__animated animate__fadeIn",theme:"default",loading:!0,children:["Reject request ","(".concat(this.state.selected_posts.length,")")]}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)(b.a,{className:"w-52",theme:"danger-light",onClick:this.submitSelected.bind(this,"REJECTED"),loading:this.state.submit_status_loading,children:["Reject request ","(".concat(this.state.selected_posts.length,")")]}),Object(O.jsxs)(b.a,{className:"w-52",theme:"success",onClick:this.submitSelected.bind(this,"APPROVED"),loading:this.state.submit_status_loading,children:["Approve request ","(".concat(this.state.selected_posts.length,")")]})]})})]}),Object(O.jsx)(j.a,{children:Object(O.jsxs)("table",{className:"w-full",children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{className:"text-left",children:[Object(O.jsx)("th",{className:"p-2 border"}),Object(O.jsx)("th",{className:"p-2 border",children:"Position code"}),Object(O.jsx)("th",{className:"p-2 border",children:"Position name"}),Object(O.jsx)("th",{className:"p-2 border",children:"Qualification "}),Object(O.jsx)("th",{className:"p-2 border",children:"Specialization"}),Object(O.jsx)("th",{className:"p-2 border",children:"Total Period"}),Object(O.jsx)("th",{className:"p-2 border",children:"Teaching level"}),Object(O.jsx)("th",{className:"p-2 border",children:"Status"})]})}),Object(O.jsx)("tbody",{children:!0===this.state.loading_data?Object(O.jsx)("tr",{children:Object(O.jsx)("td",{className:"py-8 text-center",colSpan:10,children:Object(O.jsx)(u.a,{})})}):0===this.state.data.length?Object(O.jsx)("tr",{children:Object(O.jsx)("td",{className:"py-8 text-center",colSpan:10,children:Object(O.jsx)("h2",{className:"text-2xl font-bold text-gray-600",children:"No results found"})})}):Object(O.jsx)(O.Fragment,{children:this.state.data.map((function(e,t){var c=s.state.selected_posts.find((function(t){return t===e.school_need_post_id}));return Object(O.jsxs)("tr",{className:"".concat(c?"bg-blue-200 bg-opacity-30":""),children:[Object(O.jsx)("td",{className:"border p-2 text-3xl cursor-pointer ".concat(c?"text-blue-600":""),onClick:s.selectItem.bind(s,e.school_need_post_id),children:c?Object(O.jsx)(O.Fragment,{children:!0===s.state.submit_status_loading?Object(O.jsx)(_.k,{className:"animate__animated animate__zoomIn animate__infinite text-blue-400 "}):Object(O.jsx)(_.m,{})}):Object(O.jsx)(_.n,{className:"text-gray-400"})}),Object(O.jsx)("td",{className:"border p-2",children:e.occupation}),Object(O.jsx)("td",{className:"border p-2",children:e.position_name}),Object(O.jsx)("td",{className:"border p-2",children:e.qualification_name}),Object(O.jsx)("td",{className:"border p-2",children:e.specialization_name}),Object(O.jsx)("td",{className:"border p-2",children:e.total_period}),Object(O.jsx)("td",{className:"border p-2",children:e.teaching_level}),Object(O.jsx)("td",{className:"border p-2 text-center",children:Object(O.jsx)("span",{className:"p-1 rounded-lg text-xs ".concat("APPROVED"===e.status?"bg-green-100 text-green-700":"bg-gray-200"),children:e.status})})]},t)}))})})]})})]})}}]),s}(i.a.Component),y=Object(o.b)((function(e){return{auth:e.auth}}),{})(v),T={msg:"",target:null},S=function(e){Object(l.a)(s,e);var t=Object(r.a)(s);function s(e){var a;return Object(c.a)(this,s),(a=t.call(this,e)).loadApp=function(){if(null===a.props.auth.district)return a.setState({error:{target:"main-error",msg:"No district assigned to you!"}});a.setState({loading_schools:!0}),Object(d.G)(a.props.auth.district.district_code,(function(e,t,s){e?a.setState({data:t?t.total_needed:[],total_checked:t?t.total_checked:[],loading_schools:!1}):a.setState({loading_schools:!1,data:[],error:{target:"main-error",msg:"Error: ".concat(s)}}),a.clearError()}))},a.clearError=function(){return setTimeout((function(){a.setState({error:T})}),3e3)},a.changeTab=function(e){a.setState({selected_tab:e})},a.state={loading_schools:!1,selected_school:null,data:[],error:T,search:"",selected_tab:"SUBMITTED",total_checked:[]},a}return Object(a.a)(s,[{key:"componentDidMount",value:function(){this.loadApp()}},{key:"render",value:function(){var e=this,t=this.state.data;"ALL"===this.state.selected_tab&&(t=this.state.data),"SUBMITTED"===this.state.selected_tab&&(t=this.state.data.filter((function(e){return+e.TOTAL>=1}))),"NON-SUBMITTED"===this.state.selected_tab&&(t=this.state.data.filter((function(e){return 0===+e.TOTAL})));var s=Object(p.v)(t,this.state.search,{school_code:!0,school_name:!0}),c=0,a=0,l=0,r=this.state.data.filter((function(e){return 0!==+e.TOTAL})).length,n=this.state.data.length-r,i=this.state.data.length;return null!==this.state.selected_school&&this.state.selected_school?Object(O.jsx)(y,{school:this.state.selected_school,close:function(){e.setState({selected_school:null}),window.scroll(0,0),e.loadApp()}}):Object(O.jsxs)(O.Fragment,{children:["main-error"===this.state.error.target&&Object(O.jsx)(h.a,{theme:"danger",fixed:!0,children:this.state.error.msg}),"main-success"===this.state.error.target&&Object(O.jsx)(h.a,{theme:"success",fixed:!0,children:this.state.error.msg}),Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(g,{data:this.state.total_checked}),Object(O.jsx)("section",{className:"sticky top-1 z-50 mx-auto",children:Object(O.jsxs)(j.a,{children:[Object(O.jsxs)("div",{className:"flex w-full items-center",children:[Object(O.jsxs)("div",{className:"flex-1",children:[Object(O.jsxs)(x.a,{size:"md",children:["Vacant posts to be filled ","(Approval)"]}),Object(O.jsx)("p",{className:"m-0 text-gray-500",children:"Choose a school to begin with"})]}),Object(O.jsx)("div",{className:"flex-1",children:Object(O.jsx)(m.a,{onChange:function(t){return e.setState({search:t.target.value})},value:this.state.search,error:"",label:"",placeholder:"Search by School code or school name",name:"",size:"sm"})})]}),Object(O.jsxs)("div",{className:"border-t flex gap-2 pt-1",children:[Object(O.jsxs)(b.a,{size:"sm",theme:"SUBMITTED"===this.state.selected_tab?"success":"primary-light",onClick:this.changeTab.bind(this,"SUBMITTED"),children:["Submitted schools",Object(O.jsx)("b",{className:"inline-block p-0.1 px-1 ml-1 rounded-lg bg-green-800 text-white text-xs",children:r})]}),Object(O.jsxs)(b.a,{size:"sm",theme:"ALL"===this.state.selected_tab?"primary":"primary-light",onClick:this.changeTab.bind(this,"ALL"),children:["All schools",Object(O.jsx)("b",{className:"inline-block p-0.1 px-1 ml-1 rounded-lg bg-blue-800 text-white text-xs",children:i})]}),Object(O.jsxs)(b.a,{size:"sm",theme:"NON-SUBMITTED"===this.state.selected_tab?"danger":"primary-light",onClick:this.changeTab.bind(this,"NON-SUBMITTED"),children:["Non submitted schools"," ",Object(O.jsx)("b",{className:"inline-block p-0.1 px-1 ml-1 rounded-lg bg-red-800 text-white text-xs",children:n})]})]})]})}),Object(O.jsxs)(j.a,{children:[Object(O.jsx)("div",{className:"flex w-full gap-2  pb-2",children:Object(O.jsx)("div",{className:"flex-1"})}),Object(O.jsxs)("table",{className:"w-full",children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{className:"text-left",children:[Object(O.jsx)("th",{className:"p-2 border",children:"#"}),Object(O.jsx)("th",{className:"p-2 border",children:"School code"}),Object(O.jsx)("th",{className:"p-2 border",children:"School name"}),Object(O.jsx)("th",{className:"p-2 border",children:"Rejected"}),Object(O.jsx)("th",{className:"p-2 border",children:"Approved"}),Object(O.jsx)("th",{className:"p-2 border",children:"Total"}),Object(O.jsx)("th",{className:"p-2 border"})]})}),Object(O.jsxs)("tbody",{children:[!0===this.state.loading_schools?Object(O.jsx)("tr",{children:Object(O.jsx)("td",{className:"py-8 text-center",colSpan:10,children:Object(O.jsx)(u.a,{})})}):0===s.length?Object(O.jsx)("tr",{children:Object(O.jsx)("td",{className:"py-8 text-center",colSpan:10,children:Object(O.jsx)("h1",{className:"text-2xl",children:"No results found!"})})}):s.map((function(t,s){return a+=+t.APPROVED,l+=+t.TOTAL,c+=+t.REJECTED,Object(O.jsxs)("tr",{className:"hover:bg-yellow-50",children:[Object(O.jsx)("td",{className:"p-2 border",children:s+1}),Object(O.jsx)("td",{className:"p-2 border",children:t.school_code}),Object(O.jsx)("td",{className:"p-2 border",children:t.school_name}),Object(O.jsx)("td",{className:"p-2 border font-bold text-red-700",children:t.REJECTED}),Object(O.jsx)("td",{className:"p-2 border font-bold text-green-700",children:t.APPROVED}),Object(O.jsx)("td",{className:"p-2 border font-bold",children:t.TOTAL}),Object(O.jsx)("td",{className:"p-2 border",children:Object(O.jsx)(b.a,{size:"sm",theme:"accent-light",className:"w-full",onClick:function(){e.setState({selected_school:t}),window.scrollTo(0,0)},children:"Select"})})]},s)})),s.length>=2&&""===this.state.search&&Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{className:"p-2",colSpan:3}),Object(O.jsx)("td",{className:"p-2 bg-red-100 border text-red-600 text-xl font-bold",children:c}),Object(O.jsx)("td",{className:"p-2 border bg-green-100 text-green-700 text-xl font-bold",children:a}),Object(O.jsx)("td",{className:"p-2 border bg-blue-100 text-blue-600 text-xl font-bold",children:l})]})]})]})]})]})]})}}]),s}(i.a.Component),w=Object(o.b)((function(e){return{auth:e.auth}}),{})(S)}}]);
//# sourceMappingURL=59.b1814892.chunk.js.map