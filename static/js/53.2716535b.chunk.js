(this.webpackJsonpTMIS=this.webpackJsonpTMIS||[]).push([[53,68],{491:function(t,e,s){"use strict";s.r(e),s.d(e,"OutgoingTransfers",(function(){return y}));var r=s(11),a=s(19),i=s(20),c=s(21),n=s(22),o=s(4),l=s.n(o),d=s(36),h=s(13),j=s(47),u=s(23),b=s(53),_=s(92),m=s(25),x=s(28),p=s(93),f=s(27),O=s(1),g=function(t){var e=t.close,s=t.district_id,r=t.district_name,a=Object(o.useState)(!0),i=Object(x.a)(a,2),c=i[0],n=i[1],l=Object(o.useState)([]),d=Object(x.a)(l,2),u=d[0],b=d[1],_=Object(o.useState)(""),g=Object(x.a)(_,2),v=g[0],N=g[1];return Object(o.useEffect)((function(){!0===c&&Object(h.X)(s,(function(t,e,s){n(!1),b(e),N(s),console.log({data:e})}))}),[c,s]),Object(O.jsx)(f.d,{backDrop:!0,theme:f.c.default,close:e,backDropClose:!1,widthSizeClass:f.b.large,displayClose:!0,padding:{title:!0,body:!1,footer:!1},title:"Export report",children:Object(O.jsxs)("div",{className:"border-t p-4 py-8",children:[""!==v&&Object(O.jsx)(j.a,{theme:"danger",children:v}),!0===c?Object(O.jsxs)("div",{className:"text-xl text-center",children:[Object(O.jsx)(m.a,{}),Object(O.jsx)("h2",{className:"text-2xl font-bold pt-2",children:"Preparing report"}),Object(O.jsx)("h4",{className:"text-gray-500 text-sm",children:"Please wait..."})]}):Object(O.jsxs)("div",{className:"text-center",children:[Object(O.jsxs)("h1",{className:"text-3xl",children:["Your ",Object(O.jsx)("b",{children:"Outgoing Transfer"})," report is ready"]}),Object(O.jsx)("h1",{children:"You can download it now"}),Object(O.jsx)("div",{className:"inline-block pt-5",children:Object(O.jsx)(p.a,{fileData:u.map((function(t){var e,s,r,a,i,c;return{teacher_id:t.teacher_id,teacher_first_name:t.teacher_first_name,teacher_last_name:t.teacher_last_name,teacher_full_name:t.teacher_full_name,teacher_phone_number:t.teacher_phone_number,position_code:t.position_code,position_name:t.position_name,qualification:t.qualification_name,school_from_code:null===(e=t.school_from_info)||void 0===e?void 0:e.school_code,school_form_name:null===(s=t.school_from_info)||void 0===s?void 0:s.school_name,district_from_name:null===(r=t.school_from_info)||void 0===r?void 0:r.district_name,approved_school_code:null===(a=t.approved_school_info)||void 0===a?void 0:a.school_code,approved_school_name:null===(i=t.approved_school_info)||void 0===i?void 0:i.school_name,approved_district_name:null===(c=t.approved_school_info)||void 0===c?void 0:c.district_name,transfer_reason:t.transfer_reason,transfer_type:t.transfer_type,teacher_requested_transfer_date:t.teacher_requested_transfer_date}})),fileName:"OUTGOING TRANSFERS - ".concat(s," ").concat(r||""),btnName:"Download EXCEL"})})]})]})})},v={target:null,msg:""},N=function(t){Object(c.a)(s,t);var e=Object(n.a)(s);function s(t){var i;return Object(a.a)(this,s),(i=e.call(this,t)).setOpenDownload=function(){return i.setState({open_download_excel:!i.state.open_download_excel})},i.loadingData=function(t,e,s){i.setState({loading:!0,selected_transfer_id:null,data:[],transfer_issue:""}),Object(h.W)({district_code:t,limit:i.state.limit,page:e,status:s||i.state.status},(function(t,s,r){i.setState({loading:!1,data:null!==s&&void 0!==s&&s.district_transfer_request?null===s||void 0===s?void 0:s.district_transfer_request:[],total:null!==s&&void 0!==s&&s.total_transfer?s.total_transfer:0,next:null!==s&&void 0!==s&&s.next?+(null===s||void 0===s?void 0:s.next):0,previous:null!==s&&void 0!==s&&s.previous?+(null===s||void 0===s?void 0:s.previous):0,error:t?v:{target:"main-error",msg:"Error: ".concat(r)},page:e})}))},i.paginateData=function(t){var e;null!==(e=i.props.auth.district)&&void 0!==e&&e.district_code&&i.loadingData(i.state.selected_district,t)},i.submitIssue=function(){return i.state.transfer_issue.length<=20||""===i.state.selected_transfer_id||null===i.state.selected_transfer_id?i.setState({error:{target:"request-input",msg:"Your message is too short, minimum characters are 20"}}):(i.setState({loading_request:!0}),void Object(h.hc)({teacher_transfer_id:i.state.selected_transfer_id,transfer_issue_comment:i.state.transfer_issue},(function(t,e,s){i.setState({loading_request:!1,error:!0===t?{target:"main-success",msg:"The request has been submitted successfully."}:{target:"main-error",msg:s},data:i.state.data.map((function(t){return t.teacher_transfer_id===i.state.selected_transfer_id?Object(r.a)(Object(r.a)({},t),{},{transfer_issue_comment:i.state.transfer_issue}):t}))})})))},i.changeStatus=function(t){i.state.status!==t&&i.props.auth.district&&(i.setState({status:t}),i.loadingData(i.state.selected_district,1,t))},i.state={loading:!1,error:v,data:[],limit:14,page:1,total:0,next:0,previous:0,selected_transfer_id:null,transfer_issue:"",loading_request:!1,status:"NO-ISSUE",open_download_excel:!1,selected_district:""},i}return Object(i.a)(s,[{key:"componentDidMount",value:function(){if(this.props.district_id)this.setState({selected_district:this.props.district_id}),this.loadingData(this.props.district_id,this.state.page,this.state.status);else{if(!this.props.auth.district||!this.props.auth.district.district_code)return this.setState({error:{target:"main-error",msg:"There is no district assigned to you!"}});this.setState({selected_district:this.props.auth.district.district_code}),this.loadingData(this.props.auth.district.district_code,this.state.page,this.state.status)}}},{key:"render",value:function(){var t=this,e=(this.state.total/this.state.limit).toFixed(0);return Object(O.jsxs)(O.Fragment,{children:[!0===this.state.open_download_excel&&this.props.auth.district&&Object(O.jsx)(g,{district_id:this.state.selected_district,close:this.setOpenDownload,district_name:this.props.district_title?this.props.district_title:null}),"main-success"===this.state.error.target&&Object(O.jsx)(j.a,{theme:"success",fixed:!0,children:this.state.error.msg}),"main-error"===this.state.error.target&&Object(O.jsx)(j.a,{theme:"danger",fixed:!0,children:this.state.error.msg}),Object(O.jsxs)("div",{className:"container mx-auto px-4 flex items-center",children:[Object(O.jsx)("div",{className:"flex-1",children:Object(O.jsx)(_.a,{className:"",children:"Outgoing transfers"})}),Object(O.jsx)("section",{className:"pr-3",children:Object(O.jsx)(u.a,{onClick:this.setOpenDownload,theme:"success",children:"Generate Excel"})}),Object(O.jsxs)("section",{className:"text-center p-1 bg-accent-800 bg-opacity-20 text-accent-900 px-4 rounded",children:[Object(O.jsx)("span",{className:"text-sm block text-gray-500 -mb-1",children:"Total:"}),Object(O.jsx)("h3",{className:"font-bold text-xl",children:this.state.total})]})]}),Object(O.jsxs)(b.a,{transparent:!0,children:[Object(O.jsxs)("table",{className:"w-full",children:[Object(O.jsx)("thead",{className:"text-left bg-white",children:Object(O.jsxs)("tr",{className:"bg-accent-900 bg-opacity-10",children:[Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"#"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"Names"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"School Code"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"School name"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"Position code"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"Position name"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"Qualification"})]})}),Object(O.jsx)("tbody",{children:!0===this.state.loading?Object(O.jsx)("tr",{className:" ",children:Object(O.jsx)("td",{colSpan:8,className:"py-4 text-center border",children:Object(O.jsx)(m.a,{})})}):this.state.data.length<=0?Object(O.jsx)("tr",{children:Object(O.jsx)("td",{colSpan:8,className:"py-4 text-center border",children:Object(O.jsx)("h1",{className:"text-2xl text-gray-400",children:"No data found"})})}):this.state.data.map((function(t,e){var s,r;return Object(O.jsxs)("tr",{className:"bg-white hover:bg-yellow-400 hover:bg-opacity-30",children:[Object(O.jsx)("td",{className:"border p-2",children:e+1}),Object(O.jsx)("td",{className:"p-2 border",children:t.teacher_full_name}),Object(O.jsx)("td",{className:"p-2 border",children:null===(s=t.school_from_info)||void 0===s?void 0:s.school_code}),Object(O.jsx)("td",{className:"p-2 border",children:null===(r=t.school_from_info)||void 0===r?void 0:r.school_name}),Object(O.jsx)("td",{className:"p-2 border",children:t.position_code}),Object(O.jsx)("td",{className:"p-2 border text-sm",children:t.position_name}),Object(O.jsx)("td",{className:"p-2 border",children:t.qualification_name})]},e)}))})]}),Object(O.jsx)("div",{className:"flex gap-3 mx-auto pt-3",children:Array(+e).fill("0").map((function(e,s){return Object(O.jsx)("button",{className:"p-2 py-1 ".concat(+t.state.page===s+1?"bg-accent-800 text-black font-bold":"bg-opacity-25"," rounded-full bg-accent-800 "),onClick:t.paginateData.bind(t,s+1),children:s+1})}))})]})]})}}]),s}(l.a.Component),y=Object(d.b)((function(t){return{auth:t.auth}}),{})(N)},600:function(t,e,s){"use strict";s.r(e),s.d(e,"ExternalTransferReport",(function(){return O}));var r=s(19),a=s(20),i=s(21),c=s(22),n=s(4),o=s.n(n),l=s(16),d=s(36),h=s(140),j=s(23),u=s(53),b=s(92),_=s(25),m=s(491),x=s(1),p={error:"",target:null},f=function(t){Object(i.a)(s,t);var e=Object(c.a)(s);function s(t){var a;return Object(r.a)(this,s),(a=e.call(this,t)).state={loading_district:!1,districts:[],error:p,selected_district:null},a}return Object(a.a)(s,[{key:"selectDistrict",value:function(t){this.setState({selected_district:t})}},{key:"componentDidMount",value:function(){var t=this;this.setState({loading_district:!0,error:p}),Object(h.b)((function(e,s,r){console.log({status:e,data:s,msg:r}),null!==s?t.setState({loading_district:!1,districts:s}):t.setState({loading_district:!1,districts:[],error:{target:"MAIN-ERROR",error:"Error: ".concat(r)}})}))}},{key:"render",value:function(){var t=this;return null!==this.state.selected_district?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"sticky top-1 z-50 mx-auto",children:Object(x.jsxs)(u.a,{className:"flex",children:[Object(x.jsx)("section",{children:Object(x.jsx)(j.a,{onClick:this.selectDistrict.bind(this,null),children:"Back"})}),Object(x.jsxs)("section",{className:"text-2xl pl-3 flex-1",children:[this.state.selected_district.district_name," district"]})]})}),Object(x.jsx)(m.OutgoingTransfers,{district_id:this.state.selected_district.district_code,district_title:this.state.selected_district.district_name+" district"})]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(u.a,{children:Object(x.jsxs)("div",{className:"w-full flex",children:[Object(x.jsx)("section",{className:"flex-1",children:Object(x.jsx)(b.a,{children:"Outgoing transfers"})}),Object(x.jsx)("section",{})]})}),Object(x.jsx)(u.a,{children:!0===this.state.loading_district?Object(x.jsx)("div",{className:"py-8 text-center",children:Object(x.jsx)(_.a,{})}):0===this.state.districts.length?Object(x.jsx)("div",{className:"text-center py-8",children:Object(x.jsx)(b.a,{children:"No results found"})}):Object(x.jsx)("div",{className:"w-full lg:grid lg:grid-cols-2 gap-2",children:this.state.districts.map((function(e){return Object(x.jsxs)("div",{onClick:t.selectDistrict.bind(t,e),className:"flex px-3 py-1  mb-3 lg:mb-0 hover:text-white hover:bg-yellow-600 hover:bg-opacity-50 rounded-md items-center bg-yellow-50 border-yellow-700 border",children:[Object(x.jsx)("h4",{className:"flex-1 text-lg",children:e.district_name}),Object(x.jsx)("section",{className:"text-2xl text-yellow-600",children:Object(x.jsx)(l.h,{})})]},e.district_code)}))})})]})}}]),s}(o.a.Component),O=Object(d.b)((function(t){return{auth:t.auth}}),{})(f)}}]);
//# sourceMappingURL=53.2716535b.chunk.js.map