(this.webpackJsonpTMIS=this.webpackJsonpTMIS||[]).push([[42],{349:function(e,t,a){"use strict";var s=a(124),c=a(33),r=a(4),n=a(17),i=a(18),o=a(36),l=a(2);t.a=function(e){var t=e.loading,a=(e.id,e.title),d=e.close,h=e.data,j=e.click,b=Object(r.useState)(""),u=Object(c.a)(b,2),m=u[0],x=u[1],p=Object(i.k)(h,m,Object(s.a)({},a,!0));return Object(l.jsxs)("div",{className:" bg-gray-100 shadow-lg border-gray-500 border-2 h-64 rounded-md flex flex-col",children:[Object(l.jsxs)("div",{className:"p-1 bg-white rounded flex items-center",children:[Object(l.jsx)("label",{htmlFor:"search-input-data",children:Object(l.jsx)(n.db,{className:"text-2xl"})}),Object(l.jsx)("input",{type:"search",className:"py-1 px-1 flex-1",placeholder:"Search",value:m,id:"search-input-data",onChange:function(e){return x(e.target.value)}}),!1===t&&Object(l.jsx)("button",{onClick:function(){return d()},className:"px-2 py-0.5 rounded text-sm ml-3 bg-red-200 text-red-800",children:"Cancel"})]}),Object(l.jsx)("div",{className:"flex-1 p-2 overflow-y-auto border-t ",children:!0===t?Object(l.jsxs)("div",{className:"my-4",children:[Object(l.jsx)("div",{className:"mx-auto text-center",children:Object(l.jsx)(o.a,{})}),Object(l.jsx)("p",{className:"text-center text-gray-500",children:"Loading"})]}):Object(l.jsx)(r.Fragment,{children:0===p.length?Object(l.jsx)("section",{className:"p-4 text-center",children:Object(l.jsx)("h2",{className:"text-lg text-gray-400",children:"No results found"})}):p.map((function(e,t){return Object(l.jsx)("button",{onClick:function(){return j(e)},className:"block p-1 border-b w-full text-left border-gray-300 hover:text-white hover:bg-blue-600",type:"button",children:e[a]},t)}))})})]})}},576:function(e,t,a){"use strict";a.r(t),a.d(t,"RequestVacantPositions",(function(){return C}));var s=a(43),c=a(27),r=a(28),n=a(29),i=a(30),o=a(4),l=a.n(o),d=a(32),h=a(13),j=a(54),b=a(38),u=a(53),m=a(79),x=a(36),p=a(9),O=a(33),g=a(17),_=a(61),f=a(44),N=a(349),y=a(18),v=a(2),S={target:null,error:""},w=function(e){var t=e.close,a=e.loading_assets,c=e.assets,r=e.saveData,n=e.school_code,i=e.user_id,l=e.hierarchy_data,d=Object(o.useState)([]),u=Object(O.a)(d,2),m=u[0],w=u[1],k=Object(o.useState)(""),C=Object(O.a)(k,2),q=C[0],z=C[1],A=Object(o.useState)(!1),T=Object(O.a)(A,2),E=T[0],I=T[1],D=Object(o.useState)(!1),P=Object(O.a)(D,2),R=P[0],F=P[1],G=Object(o.useState)(S),M=Object(O.a)(G,2),J=M[0],L=M[1],V=Object(o.useState)(!1),W=Object(O.a)(V,2),B=W[0],K=W[1],Q=m.reduce((function(e,t){return e+ +t.teaching_period}),0),H=Object(y.k)(l,q,{level_code:!0,level_name:!0,combination_code:!0}),U=Object(o.useState)(null),X=Object(O.a)(U,2),Y=X[0],Z=X[1],$=Object(o.useState)(null),ee=Object(O.a)($,2),te=ee[0],ae=ee[1],se=function(e){console.log(e,m);var t=m.find((function(t){return t.school_study_hierarchy_id===e.school_study_hierarchy_id}));w(t?m.filter((function(t){return t.school_study_hierarchy_id!==e.school_study_hierarchy_id})):[].concat(Object(s.a)(m),[e]))};return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)(f.c,{backDrop:!0,theme:f.b.default,close:function(){null===Y&&null===te||window.confirm("Once you close you will lose the selected data, \n do ypu want to close?"),t()},backDropClose:!1,widthSizeClass:f.a.large,displayClose:!0,title:"Add new post on school",padding:{title:!0,body:void 0,footer:void 0},children:["main-error"===J.target&&Object(v.jsx)(j.a,{theme:"danger",children:J.error}),"main-success"===J.target&&Object(v.jsx)(j.a,{theme:"success",children:J.error}),Object(v.jsx)("form",{onSubmit:function(e){return e.preventDefault(),null===Y?L({target:"position",error:"Required"}):null===te?L({target:"specialization",error:"Required"}):0===m.length?(L({target:"subjects",error:"Please select subject(s)"}),void setTimeout((function(){L({target:null,error:""})}),2e3)):(L(S),K(!0),void Object(h.Bb)({district_code:n.substring(0,2),school_code:n,occupation:Y.position_code,specialization_id:te.specialization_id,subjects:m.map((function(e){return e.school_study_hierarchy_id})),education_level:"1",need_post:"",requested_by:i,approved_by:"",approved_date:"",status:"WAITING",total_period:Q},(function(e,a,s){!0===e?(r({school_need_post_id:(null===a||void 0===a?void 0:a.id)+"",district_code:n,district_name:"",school_code:n,school_name:"",occupation:Y.position_code,position_name:Y.position_name,specialization_id:te.specialization_id,specialization_name:te.specialization_name,education_level:"",qualification_name:Y.qualification_name,need_post:"",status:"WAITING",total_period:Q}),K(!1),L({target:"main-success",error:"New request created successfully"}),setTimeout((function(){t()}),1e3)):(K(!1),L({target:"main-error",error:"Error: ".concat(s)}))})))},children:!0===a?Object(v.jsx)("div",{className:"py-8 text-center mx-auto",children:Object(v.jsx)(x.a,{})}):null===c?Object(v.jsx)("div",{className:"py-8 text-center text-lg text-red-600",children:"No data found!"}):Object(v.jsxs)("div",{className:"border-t p-4",children:[Object(v.jsx)("div",{className:"pb-3",children:E?Object(v.jsx)(N.a,{loading:!1,id:"position_code",title:"title",close:function(){return I(!E)},data:c.school_positions.map((function(e){return Object(p.a)(Object(p.a)({},e),{},{title:"".concat(e.position_code," - ").concat(e.position_name," (").concat(e.qualification_name,")")})})),click:function(e){Z(e),I(!1)}}):Object(v.jsx)("div",{onClick:function(){return!1===B&&I(!E)},children:Object(v.jsx)(_.a,{onChange:function(e){},value:Y?"".concat(Y.position_code," - ").concat(Y.position_name," (").concat(Y.qualification_name,")"):"",error:"position"===J.target?J.error:"",label:"Position",placeholder:"Position",name:"",disabled:!0})})}),Object(v.jsx)("div",{className:"pb-3",onClick:function(){return!1===B&&I(!E)},children:Object(v.jsx)(_.a,{onChange:function(e){},value:Y?"".concat(Y.qualification_name):"",error:"position"===J.target?J.error:"",label:"Level of Education",placeholder:"Select the position",name:"",disabled:!0})}),Object(v.jsx)("div",{className:"pb-3",children:R?Object(v.jsx)(N.a,{loading:!1,id:"id",title:"title",close:function(){return F(!R)},data:c.specializations.map((function(e){return Object(p.a)(Object(p.a)({},e),{},{title:"".concat(e.specialization_name),id:e.specialization_id})})),click:function(e){F(!1),ae(e)}}):Object(v.jsx)("div",{onClick:function(){return!1===B&&F(!R)},children:Object(v.jsx)(_.a,{onChange:function(e){},value:te?te.specialization_name:"",error:"specialization"===J.target?J.error:"",label:"Specialization",placeholder:"Specialization",name:"specialization_name",disabled:!0})})}),Object(v.jsxs)("div",{className:"pb-2 bg-gray-100 mb-3 mt-1 rounded  ".concat("subjects"===J.target?"border-red-500 border-2":""),children:[Object(v.jsxs)("div",{className:"pb-1 flex items-center px-2",children:[Object(v.jsx)("section",{className:"flex-1",children:Object(v.jsx)(_.a,{onChange:function(e){return z(e.target.value)},value:q,error:"",label:"",placeholder:"Search subject",name:"",size:"sm"})}),Object(v.jsxs)("section",{className:"px-2 rounded bg-gray-100",children:[Object(v.jsx)("span",{className:"text-sm text-gray-400",children:"Subjects:"}),Object(v.jsx)("h4",{className:"text-xl -mt-1 font-bold",children:m.length})]}),Object(v.jsxs)("section",{className:"px-2 rounded bg-gray-100",children:[Object(v.jsx)("span",{className:"text-sm text-gray-400",children:"Total periods:"}),Object(v.jsx)("h4",{className:"text-xl -mt-1 font-bold",children:Q})]})]}),Object(v.jsx)("div",{className:"h-56 overflow-y-auto",children:Object(v.jsxs)("table",{className:"w-full",children:[Object(v.jsx)("thead",{children:Object(v.jsxs)("tr",{children:[Object(v.jsx)("th",{className:"border p-1"}),Object(v.jsx)("th",{className:"border p-1",children:"Course name"}),Object(v.jsx)("th",{className:"border p-1",children:"Combination"}),Object(v.jsx)("th",{className:"border p-1",children:"Grade name"}),Object(v.jsx)("th",{className:"border p-1",children:"Teaching period"})]})}),Object(v.jsx)("tbody",{className:"",children:H.map((function(e,t){var a=m.find((function(t){return e.school_study_hierarchy_id===t.school_study_hierarchy_id}));return Object(v.jsxs)("tr",{className:"cursor-pointer ".concat(void 0===a?"":"bg-green-200 bg-opacity-40"),onClick:se.bind(undefined,e),children:[Object(v.jsx)("td",{className:"border p-1 text-center text-2xl ".concat(void 0===a?"":"text-green-500"),children:void 0===a?Object(v.jsx)(g.k,{}):Object(v.jsx)(g.j,{})}),Object(v.jsx)("td",{className:"border p-1",children:e.course_name}),Object(v.jsx)("td",{className:"border p-1",children:e.combination_name}),Object(v.jsx)("td",{className:"border p-1",children:e.grade_name}),Object(v.jsx)("td",{className:"border p-1",children:e.teaching_period})]},t)}))})]})})]}),"subjects"===J.target&&Object(v.jsx)("span",{className:"text-red-800 text-center",children:J.error}),Object(v.jsx)("div",{className:"pb-2 text-right",children:"main-success"!==J.target&&Object(v.jsx)(b.a,{type:"submit",loading:B,children:"Request New vacant"})})]})})]})})},k=function(e){Object(n.a)(a,e);var t=Object(i.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).cleanError=function(){return r.setState({error:{target:null,msg:""}})},r.addNewItem=function(e){return r.setState({data:[].concat(Object(s.a)(r.state.data),[e])})},r.removeItem=function(e){window.confirm("Are you sure you want to remove this record?")&&(r.setState({delete_loading:!0,deleting_item:""}),Object(h.k)(e,(function(t,a){!0===t?r.setState({delete_loading:!1,deleting_item:"",error:{target:"main-success",msg:"Record removed successfully"},data:r.state.data.filter((function(t){return t.school_need_post_id!==e}))}):(r.setState({delete_loading:!1,deleting_item:"",error:{target:"main-error",msg:"Error: ".concat(a)}}),setTimeout((function(){r.setState({error:{msg:"",target:null}})}),2e3))})))},r.state={error:{target:null,msg:""},loading_assets:!1,create_request:!1,assets:null,data:[],loading_data:!1,hierarchy_data:[],loading_hierarchy:!1,delete_loading:!1,deleting_item:""},r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=this;if(null===this.props.auth.school)return this.setState({error:{target:"main-error",msg:"No school assigned to you"}});this.setState({loading_assets:!0,loading_data:!0,loading_hierarchy:!0}),Object(h.K)(this.props.auth.school.school_code,(function(t,a,s){!0===t?e.setState({loading_assets:!1,assets:a}):e.setState({loading_assets:!1,error:{target:"main-error",msg:"Error: ".concat(s)}})})),Object(h.jb)(this.props.auth.school.school_code,(function(t,a,s){!0===t?e.setState({data:a,loading_data:!1}):e.setState({data:[],loading_data:!1,error:{target:"main-error",msg:"Error: ".concat(s)}})})),Object(h.s)(this.props.auth.school.school_code,(function(t,a,s){!0===t?e.setState({hierarchy_data:a,loading_hierarchy:!1}):e.setState({hierarchy_data:[],loading_hierarchy:!1,error:{target:"main-error",msg:"Error: ".concat(s)}})}))}},{key:"render",value:function(){var e=this,t=this.state.data.filter((function(e){return"A0"===e.qualification_name})).length,a=this.state.data.filter((function(e){return"A1"===e.qualification_name})).length,s=this.state.data.filter((function(e){return"A2"===e.qualification_name})).length;return Object(v.jsxs)(v.Fragment,{children:["main-error"===this.state.error.target&&Object(v.jsx)(j.a,{theme:"danger",fixed:!0,onClick:this.cleanError,children:this.state.error.msg}),"main-success"===this.state.error.target&&Object(v.jsx)(j.a,{theme:"success",fixed:!0,onClick:this.cleanError,children:this.state.error.msg}),!0===this.state.create_request&&null!==this.props.auth.school&&this.props.auth.user&&Object(v.jsx)(w,{close:function(){return e.setState({create_request:!1})},loading_assets:this.state.loading_assets,assets:this.state.assets,saveData:this.addNewItem,school_code:this.props.auth.school.school_code,school_name:this.props.auth.school.school_name,user_id:this.props.auth.user.user_id,hierarchy_data:this.state.hierarchy_data}),Object(v.jsx)(u.a,{children:Object(v.jsxs)("div",{className:"w-full flex items-center",children:[Object(v.jsxs)("section",{className:"flex-1",children:[Object(v.jsx)(m.a,{size:"md",children:"Describe needed posts"}),Object(v.jsx)("p",{className:"m-0 text-gray-400 text-sm",children:"Specify all the position without the vacant"})]}),Object(v.jsx)("section",{children:Object(v.jsx)(b.a,{type:"button",onClick:function(){return e.setState({create_request:!e.state.create_request})},children:"Add new vacant"})})]})}),Object(v.jsxs)(u.a,{children:[Object(v.jsxs)("div",{className:"flex gap-2 mb-2",children:[Object(v.jsxs)("section",{className:"border p-1 px-6 rounded bg-gray-100",children:[Object(v.jsx)("span",{children:"A0"}),Object(v.jsx)("h2",{className:"font-bold text-2xl -mt-1",children:t})]}),Object(v.jsxs)("section",{className:"border p-1 px-6 rounded bg-gray-100",children:[Object(v.jsx)("span",{children:"A1"}),Object(v.jsx)("h2",{className:"font-bold text-2xl -mt-1",children:a})]}),Object(v.jsxs)("section",{className:"border p-1 px-6 rounded bg-gray-100",children:[Object(v.jsx)("span",{children:"A2"}),Object(v.jsx)("h2",{className:"font-bold text-2xl -mt-1",children:s})]}),Object(v.jsx)("div",{className:"flex-1"}),Object(v.jsxs)("section",{className:"border p-1 px-6 rounded bg-gray-100",children:[Object(v.jsx)("span",{children:"Total"}),Object(v.jsx)("h2",{className:"font-bold text-2xl -mt-1",children:s+a+t})]})]}),Object(v.jsxs)("table",{className:"w-full",children:[Object(v.jsx)("thead",{children:Object(v.jsxs)("tr",{className:"text-left",children:[Object(v.jsx)("th",{className:"p-2 border",children:"#"}),Object(v.jsx)("th",{className:"p-2 border",children:"Code"}),Object(v.jsx)("th",{className:"p-2 border",children:"Position name"}),Object(v.jsx)("th",{className:"p-2 border",children:"Qualification "}),Object(v.jsx)("th",{className:"p-2 border",children:"Specialization"}),Object(v.jsx)("th",{className:"p-2 border",children:"Total Period"}),Object(v.jsx)("th",{className:"p-2 border",children:"Status"}),Object(v.jsx)("th",{className:"p-2 border"})]})}),Object(v.jsx)("tbody",{children:!0===this.state.loading_data?Object(v.jsx)("tr",{children:Object(v.jsx)("td",{className:"py-8 text-center",colSpan:10,children:Object(v.jsx)(x.a,{})})}):0===this.state.data.length?Object(v.jsx)("tr",{children:Object(v.jsx)("td",{className:"py-8 text-center",colSpan:10,children:Object(v.jsx)("h2",{className:"text-2xl font-bold text-gray-600",children:"No results found"})})}):Object(v.jsx)(v.Fragment,{children:this.state.data.map((function(t,a){return Object(v.jsxs)("tr",{children:[Object(v.jsx)("td",{className:"border p-2",children:a+1}),Object(v.jsx)("td",{className:"border p-2",children:t.school_code}),Object(v.jsx)("td",{className:"border p-2",children:t.position_name}),Object(v.jsx)("td",{className:"border p-2",children:t.qualification_name}),Object(v.jsx)("td",{className:"border p-2",children:t.specialization_name}),Object(v.jsx)("td",{className:"border p-2",children:t.total_period}),Object(v.jsx)("td",{className:"border p-2 text-center",children:Object(v.jsx)("span",{className:"p-1 rounded-lg text-xs ".concat("APPROVED"===t.status?"bg-green-100 text-green-700":"bg-gray-200"),children:t.status})}),Object(v.jsx)("td",{className:"border p-2 text-center",children:Object(v.jsx)(b.a,{theme:"danger-light",type:"button",onClick:e.removeItem.bind(e,t.school_need_post_id),disabled:e.state.delete_loading,loading:e.state.deleting_item===t.school_need_post_id,children:"Remove"})})]},a)}))})})]})]})]})}}]),a}(l.a.Component),C=Object(d.b)((function(e){return{auth:e.auth}}),{})(k)}}]);
//# sourceMappingURL=42.3b4dcf62.chunk.js.map