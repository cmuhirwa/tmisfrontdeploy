(this.webpackJsonpTMIS=this.webpackJsonpTMIS||[]).push([[59],{581:function(e,t,s){"use strict";s.r(t),s.d(t,"ApproveDocuments",(function(){return k}));var c=s(19),i=s(20),a=s(21),r=s(22),n=s(4),l=s.n(n),d=s(46),o=s(15),m=s(36),h=s(13),u=s(47),b=s(23),j=s(53),x=s(92),_=s(39),g=s(24),p=s(27),f=s(95),O=s(12),v=s(16),N=s(1),y={target:null,msg:""},S=function(e){Object(a.a)(s,e);var t=Object(r.a)(s);function s(e){var i;return Object(c.a)(this,s),(i=t.call(this,e)).setDocumentDecision=function(e,t){var s;if(window.confirm("Are you sure you want to ".concat(!0===t?"Approve":"Reject"," this document?"))){if(!i.props.auth.user||!i.props.auth.user.user_id)return i.setState({error:{target:"main-error",msg:"Your id is not valid, please refresh your browser"}});if(!e)return i.setState({error:{msg:"No selected document",target:"main-error"}});i.setState({loading_document_decision:!0}),Object(h.g)({disability:t,residence:!1,teacher_transfer_id:e,user_id:null===(s=i.props.auth.user)||void 0===s?void 0:s.user_id},(function(s,c,a){i.setState({loading_document_decision:!1,documents:!0===s?i.state.documents.filter((function(t){return t.teacher_transfer_id!==e})):i.state.documents,error:!0===s?{msg:"The document have been ".concat(!0===t?"Approved":"Rejected"),target:"main-success"}:{msg:"Error: ".concat(a),target:"main-error"}}),i.clearAlert()}))}},i.changeStatus=function(e){i.state.status!==e&&i.state.selected_district&&(i.setState({status:e}),i.loadingData(i.state.selected_district.district_code,1,e))},i.clearAlert=function(){return setTimeout((function(){i.setState({error:y})}),3e3)},i.paginateData=function(e){i.state.selected_district&&i.loadingData(i.state.selected_district.district_code,e)},i.loadingData=function(e,t,s){i.setState({loading:!0,selected_document_id:null,documents:[]}),Object(h.L)({district_code:e,limit:i.state.limit,page:t,status:s||i.state.status},(function(e,s,c){i.setState({loading:!1,documents:null!==s&&void 0!==s&&s.teacher_docs?null===s||void 0===s?void 0:s.teacher_docs:[],total:null!==s&&void 0!==s&&s.total_transfer?s.total_transfer:0,next:null!==s&&void 0!==s&&s.next?+(null===s||void 0===s?void 0:s.next):0,previous:null!==s&&void 0!==s&&s.previous?+(null===s||void 0===s?void 0:s.previous):0,error:e?y:{target:"main-error",msg:"Error: ".concat(c)},page:t})}))},i.getTotalDistrictsNumber=function(){i.setState({loading_disabled_by_district:!0,documents_by_districts:[],total_disabled_by_district:"0",total_validated:"0"}),Object(h.lc)((function(e,t,s){i.setState({loading_disabled_by_district:!1,documents_by_districts:t?t.districts:[],total_disabled_by_district:t?t.total:"0",total_validated:t?t.total_validated:"0",error:e?{msg:"",target:null}:{msg:s,target:"main-error"}})}))},i.openLink=function(e){e&&window.open("".concat(O.f,"/").concat(e))},i.state={loading:!1,loading_districts:!1,districts:[],search_district:"",error:y,documents:[],limit:10,page:1,total:0,selected_user:"",decision_disability:null,decision_residence:null,selected_district:null,status:"remain",selected_document_id:"",next:null,previous:null,loading_document_file:!0,loading_document_decision:!1,loading_disabled_by_district:!0,total_disabled_by_district:"0",documents_by_districts:[],total_validated:"0"},i}return Object(i.a)(s,[{key:"componentDidMount",value:function(){var e=this;Object(h.K)((function(t,s,c){e.setState({districts:s,loading_districts:!1,error:!0===t?y:{target:"main-error",msg:"Districts: ".concat(c)},documents:[]})})),this.getTotalDistrictsNumber()}},{key:"selectDistrict",value:function(e){this.setState({selected_district:e,page:1,total:0,documents:[]}),null!==e&&this.loadingData(e.district_code,this.state.page,this.state.status),null===e&&this.getTotalDistrictsNumber()}},{key:"render",value:function(){var e=this,t=(this.state.total/this.state.limit).toFixed(0),s=this.state.documents.find((function(t){return t.teacher_transfer_id===e.state.selected_document_id})),c=Object(v.n)(this.state.districts,this.state.search_district,{district_code:!0,district_name:!0});return null===this.state.selected_district?Object(N.jsx)(j.a,{className:"animate__animated animate__zoomIn animate__faster",children:Object(N.jsxs)("div",{children:[Object(N.jsxs)("div",{className:"flex items-center",children:[Object(N.jsx)("h1",{className:"flex-1 text-2xl font-bold",children:"Documents validation"}),Object(N.jsx)("section",{className:"p-1 bg-green-100 rounded mx-2",children:Object(N.jsxs)("span",{className:"text-sm text-green-800",children:["Total:"," ",Object(N.jsx)("b",{className:"text-black",children:this.state.total_disabled_by_district})]})}),Object(N.jsx)("section",{className:"p-1 bg-green-100 rounded",children:Object(N.jsxs)("span",{className:"text-sm text-green-800",children:["Total validated:"," ",Object(N.jsx)("b",{className:"text-black",children:this.state.total_validated})]})})]}),Object(N.jsx)("div",{className:"p-2",children:Object(N.jsx)(_.a,{error:"",label:"",name:"",onChange:function(t){return e.setState({search_district:t.target.value})},placeholder:"Search district by name",value:this.state.search_district})}),!0===this.state.loading_districts?Object(N.jsx)("div",{className:"py-8 text-center text-8xl text-accent-900",children:Object(N.jsx)(g.a,{className:"mx-auto"})}):this.state.districts.length>=1?Object(N.jsx)(N.Fragment,{children:c.length<=0?Object(N.jsxs)("div",{className:"py-4 text-center",children:[Object(N.jsx)("h2",{className:"text-lg",children:"No results found!"}),Object(N.jsx)("p",{className:"text-gray-500",children:"Please use a correct district name"})]}):Object(N.jsx)("div",{className:"grid lg:grid-cols-2 gap-2 ",children:c.map((function(t){var s=e.state.documents_by_districts.find((function(e){return e.district_code===t.district_code}));return Object(N.jsxs)("div",{onClick:e.selectDistrict.bind(e,t),className:"p-2 flex items-center cursor-pointer rounded border  px-3 hover:text-yellow-600 hover:border-yellow-600 hover:bg-yellow-50 bg-white text-lg",children:[Object(N.jsxs)("h4",{className:"flex-1 text-lg",children:[" ",Object(N.jsx)("b",{children:t.district_name})," district"]}),s&&"0"!==s.total&&Object(N.jsx)("span",{className:"bg-yellow-100 text-yellow-700 font-bold py-0.5 inline-block text-sm px-1.5 rounded-full",children:null===s||void 0===s?void 0:s.total}),s&&"0"!==s.total&&Object(N.jsx)("button",{className:"",children:Object(N.jsx)(o.U,{})})]},t.district_code)}))})}):Object(N.jsxs)("div",{className:"py-4 text-center",children:[Object(N.jsx)("h2",{className:"text-8xl text-gray-400 text-center",children:Object(N.jsx)(d.i,{className:"inline"})}),Object(N.jsx)("h2",{className:"text-center p-4 text-gray-400 font-bold text-2xl",children:Object(N.jsx)("p",{children:"No results found on"})})," "]})]})}):Object(N.jsxs)(N.Fragment,{children:["main-success"===this.state.error.target&&Object(N.jsx)(u.a,{theme:"success",fixed:!0,onClick:function(){return e.setState({error:y})},children:this.state.error.msg}),"main-error"===this.state.error.target&&Object(N.jsx)(u.a,{theme:"danger",fixed:!0,onClick:function(){return e.setState({error:y})},children:this.state.error.msg}),void 0!==s&&this.state.selected_document_id&&Object(N.jsx)(p.d,{backDrop:!0,theme:p.c.default,close:function(){return e.setState({selected_document_id:null})},backDropClose:!1,widthSizeClass:p.b.maxWidth,displayClose:!0,title:"".concat(s.full_name,"'s document"),padding:{title:!0,body:void 0,footer:void 0},children:Object(N.jsxs)("div",{className:" border-t h-full flex",children:[Object(N.jsx)("div",{className:"flex-1 bg-gray-600",children:Object(N.jsx)(f.a,{file_url:"".concat(O.f,"/").concat(s.disability_surpoting_document),class_name:"w-full h-100vh",frame_title:"User document",setLoadingFile:function(){return e.setState({loading_document_file:!1})},full_height:!0})}),Object(N.jsxs)("div",{className:"w-96",children:[Object(N.jsx)("h2",{className:"text-gray-500 p-1 px-2 bg-gray-100 text-2xl text-center",children:"Teacher's information"}),"main-success"===this.state.error.target&&Object(N.jsx)(u.a,{theme:"success",onClick:function(){return e.setState({error:y})},children:this.state.error.msg}),"main-error"===this.state.error.target&&Object(N.jsx)(u.a,{theme:"danger",onClick:function(){return e.setState({error:y})},children:this.state.error.msg}),Object(N.jsxs)("section",{className:"border-b py-4",children:[Object(N.jsx)("h2",{className:"text-8xl text-gray-500",children:Object(N.jsx)(o.c,{className:"mx-auto"})}),Object(N.jsx)("h3",{className:"text-center font-bold text-xl",children:s.full_name})]}),Object(N.jsx)("div",{className:"p-2",children:[{title:"DOB: ",value:s.dob},{title:"Hire date: ",value:s.hire_date},{title:"Martial Status: ",value:s.martial_status},{title:"Position name: ",value:s.position_name},{title:"Qualification: ",value:s.qualification_name},{title:"Residence: ",value:s.resident_district_name},{title:"Role: ",value:s.role},{title:"School name: ",value:s.school_name}].map((function(e,t){var s=e.title,c=e.value;return Object(N.jsxs)("div",{className:"flex items-center px-1 py-1.5 border-b",children:[Object(N.jsx)("section",{className:"text-gray-600 pr-2",children:s}),Object(N.jsx)("section",{className:"font-bold",children:c})]},t)}))}),Object(N.jsxs)("div",{className:"py-2 text-center flex gap-2 px-3",children:[Object(N.jsx)(b.a,{size:"sm",theme:"default",onClick:this.openLink.bind(this,s.disability_surpoting_document),children:"Open document in a new tab"}),Object(N.jsx)("a",{href:"".concat(O.f,"/").concat(s.disability_surpoting_document),rel:"noreferrer",target:"_blank",download:!0,children:Object(N.jsx)(b.a,{size:"sm",theme:"primary-light",children:"Download"})})]}),Object(N.jsx)("div",{className:"p-2",children:Object(N.jsx)(b.a,{className:"w-full",theme:"success-light",size:"lg",onClick:this.setDocumentDecision.bind(this,s.teacher_transfer_id,!0),loading:this.state.loading_document_decision,children:"Yes, the document is valid"})}),Object(N.jsx)("div",{className:"p-2",children:Object(N.jsx)(b.a,{className:"w-full",theme:"danger-light",size:"lg",onClick:this.setDocumentDecision.bind(this,s.teacher_transfer_id,!1),loading:this.state.loading_document_decision,children:"No, the document is not valid"})})]})]})}),Object(N.jsxs)("div",{className:"animate__animated animate__zoomIn animate__faster pt-2",children:[Object(N.jsxs)("div",{className:"container mx-auto px-2 flex items-center",children:[Object(N.jsx)(b.a,{onClick:this.selectDistrict.bind(this,null),theme:"default",children:"Back"}),Object(N.jsx)(x.a,{className:"flex-1 m-0",children:"Document validation"}),Object(N.jsx)("section",{children:Object(N.jsxs)("div",{className:"flex flex-1 gap-1 mr-2 bg-yellow-100 p-1 rounded border border-yellow-400",children:[Object(N.jsx)(b.a,{size:"sm",theme:"remain"===this.state.status?"accent":"accent-light",onClick:this.changeStatus.bind(this,"remain"),children:"Remain"}),Object(N.jsx)(b.a,{size:"sm",theme:"complete"===this.state.status?"accent":"accent-light",onClick:this.changeStatus.bind(this,"complete"),children:"Completed"})]})}),Object(N.jsxs)("section",{className:"text-center bg-accent-800 bg-opacity-20 text-accent-900 px-4 rounded",children:[Object(N.jsx)("span",{className:"text-sm block text-gray-500 -mb-1",children:"Total:"}),Object(N.jsx)("h3",{className:"font-bold text-xl",children:this.state.total})]})]}),Object(N.jsxs)(j.a,{children:[Object(N.jsxs)("table",{className:"w-full",children:[Object(N.jsx)("thead",{className:"text-left bg-white",children:Object(N.jsxs)("tr",{className:"bg-accent-900 bg-opacity-10",children:[Object(N.jsx)("th",{className:"p-2 border-gray-300 border",children:"#"}),Object(N.jsx)("th",{className:"p-2 border-gray-300 border",children:"Names"}),Object(N.jsx)("th",{className:"p-2 border-gray-300 border",children:"School Code"}),Object(N.jsx)("th",{className:"p-2 border-gray-300 border",children:"School name"}),Object(N.jsx)("th",{className:"p-2 border-gray-300 border",children:"Position code"}),Object(N.jsx)("th",{className:"p-2 border-gray-300 border",children:"Position name"}),Object(N.jsx)("th",{className:"p-2 border-gray-300 border",children:"Qualification"})]})}),Object(N.jsx)("tbody",{children:!0===this.state.loading?Object(N.jsx)("tr",{className:" ",children:Object(N.jsx)("td",{colSpan:8,className:"py-4 text-center border",children:Object(N.jsx)(g.a,{})})}):this.state.documents.length<=0?Object(N.jsx)("tr",{children:Object(N.jsx)("td",{colSpan:8,className:"py-4 text-center border",children:Object(N.jsx)("h1",{className:"text-2xl text-gray-400",children:"No data found"})})}):this.state.documents.map((function(t,s){return Object(N.jsxs)("tr",{className:"bg-white cursor-pointer hover:bg-yellow-400 hover:bg-opacity-30",onClick:function(){return e.setState({selected_document_id:t.teacher_transfer_id})},children:[Object(N.jsx)("td",{className:"border p-2",children:s+1}),Object(N.jsx)("td",{className:"p-2 border",children:t.full_name}),Object(N.jsx)("td",{className:"p-2 border",children:t.school_from_id}),Object(N.jsx)("td",{className:"p-2 border",children:t.school_name}),Object(N.jsx)("td",{className:"p-2 border",children:t.position_id}),Object(N.jsx)("td",{className:"p-2 border text-sm",children:t.position_name}),Object(N.jsx)("td",{className:"p-2 border",children:t.qualification_name})]},s)}))})]}),Object(N.jsx)("div",{className:"flex gap-3 mx-auto pt-3",children:Array(+t).fill("0").map((function(t,s){return Object(N.jsx)("button",{className:"p-2 py-1 ".concat(+e.state.page===s+1?"bg-accent-800 text-black font-bold":"bg-opacity-25"," rounded-full bg-accent-800 "),onClick:e.paginateData.bind(e,s+1),children:s+1})}))})]})]})]})}}]),s}(l.a.Component),k=Object(m.b)((function(e){return{auth:e.auth}}),{})(S)}}]);
//# sourceMappingURL=59.0e4ea684.chunk.js.map