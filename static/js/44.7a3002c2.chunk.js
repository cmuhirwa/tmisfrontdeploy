(this.webpackJsonpTMIS=this.webpackJsonpTMIS||[]).push([[44],{181:function(e,t,s){"use strict";s.r(t),s.d(t,"CandidateSwaping",(function(){return S}));var a=s(29),r=s(30),n=s(31),c=s(32),l=s(2),i=s.n(l),o=s(13),d=s(17),u=s(10),m=s(55),h=s(27),b=s(26),x=s(33),j=s(44),p=s(34),_=s(43),g=s(1),f=function(e){var t=e.back,s=e.title;return Object(g.jsxs)("div",{className:"flex pt-2 border-b pb-2",children:[Object(g.jsxs)(b.a,{onClick:t,size:"sm",theme:"default",className:"flex flex-center items-center",children:[Object(g.jsx)(o.d,{size:20}),Object(g.jsx)("label",{className:"pl-1 flex-1 ",children:"Back"})]}),Object(g.jsx)("section",{className:"pl-3 text-gray-600",children:Object(g.jsxs)("h2",{className:"text-2xl ",children:[s," "]})})]})},O=s(20),N=s(130),v=void 0,y=function(e){var t=e.permutation,s=e.more,a=void 0!==s&&s,r=e.approveUser,n=e.approveReb,c=e.loading,i=void 0!==c&&c,d=Object(l.useState)(!1),u=Object(O.a)(d,2),m=u[0],h=u[1],x=!0===a||m,j=t.usersInfo.find((function(e){return e.user_id===t.user_one})),p=t.usersInfo.find((function(e){return e.user_id===t.user_two})),_=t.schools.find((function(e){return e.school_code===t.school_one})),f=t.schools.find((function(e){return e.school_code===t.school_two})),y=function(e,t){return void 0===e||void 0===t?Object(g.jsx)("div",{className:"p-2 text-center text-lg",children:"No users found"}):Object(g.jsxs)("div",{className:"flex-1 w-full rounded bg-white border",children:[Object(g.jsxs)("div",{className:"rounded m-1 border flex ".concat(!0===x?"":"items-center"),children:[Object(g.jsx)("section",{children:Object(g.jsx)(o.a,{className:"text-gray-400",size:x?80:30})}),Object(g.jsx)("div",{className:"flex-1 pl-2",children:[{label:"Names: ",value:e.full_name,more:!0,inline:!1},{label:"Staff code: ",value:e.staff_code,more:!1,inline:!0},{label:"NID: ",value:e.nid,more:!1,inline:!0},{label:"Sex: ",value:e.sex,more:!1,inline:!0},{label:"Phone number: ",value:e.phone_numbers,inline:!0,more:!1},{label:"Martial status: ",value:e.marital_status,inline:!0,more:!1}].map((function(e,t){return!1===e.more&&!1===x?null:e.value?Object(g.jsxs)("section",{className:"border-b ".concat(!0===e.inline?"flex py-1 items-center":""),children:[Object(g.jsx)("span",{className:"text-sm text-gray-500 block",children:null===e||void 0===e?void 0:e.label}),Object(g.jsx)("h2",{className:" ".concat(!1===e.inline?"-mt-1":"pl-2"," font-bold block "),children:null===e||void 0===e?void 0:e.value})]},t):null}))})]}),Object(g.jsxs)("div",{className:"rounded m-1 border flex items-center mt-3",children:[Object(g.jsx)("section",{className:"px-4",children:Object(g.jsx)(N.c,{className:"text-gray-400",size:x?50:20})}),Object(g.jsx)("div",{className:"flex-1",children:[{label:"School code: ",value:t.school_code,inline:!0,more:!0},{label:"School name: ",value:t.school_name,inline:!0,more:!1}].map((function(e,t){return!0===e.more&&!1===x?null:e.value?Object(g.jsxs)("section",{className:"border-b ".concat(!0===e.inline?"flex py-1 items-center":""),children:[Object(g.jsx)("span",{className:"text-sm text-gray-500 block",children:null===e||void 0===e?void 0:e.label}),Object(g.jsx)("h2",{className:" ".concat(!1===e.inline?"-mt-1":"pl-2"," font-bold block "),children:null===e||void 0===e?void 0:e.value})]},t):null}))})]})]})};return Object(g.jsxs)("div",{className:"bg-white p-2 mb-3 rounded",children:[Object(g.jsxs)("div",{className:"items-center flex flex-col md:flex-row cursor-pointer",onClick:h.bind(v,!x),children:[y(j,_),Object(g.jsx)("div",{className:"-mx-2 z-40 ",children:Object(g.jsx)(o.bb,{className:" rounded text-accent-900",size:50})}),y(p,f)]}),x&&Object(g.jsxs)("div",{className:"pt-3",children:[Object(g.jsx)("div",{className:"p-1 px-2 rounded mt-2 border grid lg:grid-cols-3 gap-1 ",children:[{label:"Permutation Code: ",value:t.permutation_code,inline:!0},{label:"Position: ",value:"".concat(t.position_code," - ").concat(t.position_name),inline:!0},{label:"Qualification name: ",value:t.qualification_name,inline:!0},{label:"Qualification name: ",value:t.role,inline:!0},{label:"Initiated date: ",value:t.user_one_date,inline:!0},{label:"Accepted date: ",value:t.user_two_date,inline:!0}].map((function(e,t){return Object(g.jsxs)("section",{className:"border-b border-l pl-2 ".concat(!0===e.inline?"flex py-1 items-center":""),children:[Object(g.jsx)("span",{className:"text-sm text-gray-500 block",children:null===e||void 0===e?void 0:e.label}),Object(g.jsx)("h2",{className:" ".concat(!1===e.inline?"-mt-1":"pl-2"," font-bold block "),children:null===e||void 0===e?void 0:e.value})]},t)}))}),Object(g.jsxs)("div",{className:"grid grid-cols-2 pt-3 items-center",children:[Object(g.jsxs)("div",{className:"flex gap-1",children:[t.reb_status&&Object(g.jsxs)("section",{className:"flex items-center gap-1 px-2 py-0.5 rounded-lg  ".concat("Accepted"===t.permutation_status?"bg-green-100 text-green-900":"bg-accent-400 text-accent-900"),children:[Object(g.jsx)("span",{className:"text-xs opacity-70",children:"User status"}),Object(g.jsx)("h5",{className:"text  block  font-bold ",children:t.permutation_status})]}),t.permutation_status&&Object(g.jsxs)("section",{className:"flex items-center gap-1 px-2 py-0.5 rounded-lg  ".concat("Accepted"===t.reb_status?"bg-green-100 text-green-900":"bg-accent-400 text-accent-900"),children:[Object(g.jsx)("span",{className:"text-xs opacity-70",children:"REB status"}),Object(g.jsx)("h5",{className:"text  block  font-bold ",children:t.reb_status})]})]}),Object(g.jsxs)("div",{className:"text-right grid gap-2",children:[r&&Object(g.jsx)(b.a,{onClick:r.bind(v,t.permutation_id),loading:i,size:"lg",children:"Approve permutation"}),n&&Object(g.jsx)(b.a,{onClick:n.bind(v,t.permutation_id),loading:i,size:"lg",children:"Approve permutation"})]})]})]})]})},w=function(e){Object(n.a)(s,e);var t=Object(c.a)(s);function s(e){var r;return Object(a.a)(this,s),(r=t.call(this,e)).setTab=function(e){return r.setState({selected_option:e})},r.cleanError=function(){setTimeout((function(){r.setState({error:{msg:"",target:null}})}),2e3)},r.componentDidMount=function(){r.appStart()},r.appStart=function(){if(!r.props.auth.user)return r.cleanError(),r.setState({error:{target:"main-error",msg:"Failed to load your permutations, please try again later"}});r.setState({loading_permutations:!0}),Object(m.b)(r.props.auth.user.user_id,(function(e,t,s){if(!0===e){if(!t.length)return r.cleanError(),r.setState({loading_permutations:!1,error:{target:"main-error",msg:s}});r.setState({loading_permutations:!1,my_permutations:t,error:{target:null,msg:""}})}else r.cleanError(),r.setState({loading_permutations:!1,error:{target:"main-error",msg:s}})}))},r.searchUser=function(){if(!r.props.auth.user)return r.setState({error:{target:"search-user-error",msg:"You are not authenticated, please refresh your browser"}}),void r.cleanError();r.setState({loading_user:!0,error:{target:null,msg:""}}),Object(u.N)(r.state.search_nid,(function(e,t,s){!0===e?null===t?r.setState({user_2:t,loading_user:!1,error:{target:"search-user-error",msg:null===t?"The NID you are using is not valid":s}}):r.setState({user_2:t,loading_user:!1}):r.setState({loading_user:!1,error:{target:"search-user-error",msg:null===t?"The NID you are using is not valid":s}})}))},r.userApprovePermutationUser=function(e){null!==e&&(r.setState({loading_approve_permutation:!0}),Object(m.d)({permutation_id:e,permutation_status:"Accepted"},(function(e,t,s){!0===e?(r.setState({loading_approve_permutation:!1,error:{target:"approve-permutation-success",msg:"Your permutation has been approved successfully"}}),r.appStart()):r.setState({error:{target:"approve-permutation-error",msg:s},loading_approve_permutation:!1})})))},r.generatePermutation=function(){var e,t,s;if(!window.confirm("Are you sure ".concat(null===(e=r.state.user_2)||void 0===e?void 0:e.full_name," is aware of this request?")))return window.alert("Please contact ".concat(null===(t=r.state.user_2)||void 0===t?void 0:t.full_name," and make sure he/she agree with your permutation request"));if(!r.props.auth.user||!r.props.auth.school)return r.setState({error:{target:"permutation-error",msg:"Please reload your browser"}});if(!r.props.basic.academic_calender)return r.setState({error:{target:"permutation-error",msg:"Academic information can't be loaded, please reload your browser"}});if(null===r.state.user_2)return r.setState({error:{target:"permutation-error",msg:"Academic information can't be loaded, please reload your browser"}});var a={academic_year_id:null===(s=r.props.basic.academic_calender)||void 0===s?void 0:s.academic_year_id,position_code:r.state.user_2.position_code?r.state.user_2.position_code:"",qualification_id:r.state.user_2.qualification_id?r.state.user_2.qualification_id:"",role_id:r.state.user_2.role_id?r.state.user_2.role_id:"",school_one:r.props.auth.school.school_code,school_two:r.state.user_2.school_code?r.state.user_2.school_code:"",user_one:r.props.auth.user.user_id,user_two:r.state.user_2.user_id?r.state.user_2.user_id:""};r.setState({loading_request:!0}),Object(m.a)(a,(function(e,t,s){!0===e?r.setState({loading_request:!1,res_data:t,transfer_success:!0}):r.setState({loading_request:!1,error:{msg:s,target:"permutation-error"}})}))},r.searchUserByCode=function(){r.setState({loading_user_by_code:!0,error:{target:null,msg:""},found_permutations:[]}),Object(m.c)(r.state.search_code,(function(e,t,s){!0===e?t.length<=0?(console.log("no data found"),r.setState({found_permutations:[],loading_user_by_code:!1,error:{target:"search-code-error",msg:"No permutation request found"}})):r.setState({found_permutations:t,loading_user_by_code:!1}):(r.setState({found_permutations:[],loading_user_by_code:!1,error:{target:"search-code-error",msg:s}}),r.cleanError())}))},r.state={loading:!1,selected_option:null,search_nid:"",loading_user:!1,user_2:null,error:{msg:"",target:null},loading_request:!1,transfer_success:!1,res_data:null,search_code:"",loading_user_by_code:!1,permutation:null,found_permutations:[],my_permutations:[],loading_permutations:!1,selected_permutation:null,loading_approve_permutation:!1},r}return Object(r.a)(s,[{key:"render",value:function(){var e,t,s=this;return!0===this.state.transfer_success?Object(g.jsxs)(x.a,{className:"py-2 animate__animated animate__zoomIn animate__faster",children:[Object(g.jsxs)("div",{className:"text-center",children:[Object(g.jsx)(o.i,{className:"text-green-500 mx-auto",size:120}),Object(g.jsx)("h2",{className:"text-2xl font-bold pt-2 text-green-600",children:"Your Permutation request has been created!"}),Object(g.jsxs)("p",{className:"py-2 text-gray-600",children:["Now you need to send the code below to"," ",Object(g.jsx)("b",{children:null===(e=this.state.user_2)||void 0===e?void 0:e.full_name})," ",Object(g.jsx)("br",{}),"so that he/she can approve this transfer"]}),Object(g.jsxs)("div",{className:"mx-auto rounded my-1 border py-2 inline-block px-5 bg-gray-50",children:[Object(g.jsx)("h4",{className:"text-gray-500",children:"Permutation code:"}),Object(g.jsx)("h1",{className:"text-3xl font-bold",children:null===(t=this.state.res_data)||void 0===t?void 0:t.permutation_code})]})]}),Object(g.jsx)("div",{className:"text-right border-t py-3 mt-4",children:Object(g.jsx)(b.a,{theme:"accent-light",onClick:function(){return s.setState({transfer_success:!1})},children:"Go to permutation list"})})]}):this.props.auth.user?Object(g.jsxs)(g.Fragment,{children:[null===this.state.selected_option&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)(x.a,{className:"animate__animated animate__zoomIn animate__faster",children:[Object(g.jsx)(j.a,{className:" py-2 lg:pb-3 lg:pt-2 font-light text-center text-gray-500",children:"Permutations"}),Object(g.jsx)("div",{className:"pt-2 flex gap-3 flex-col lg:flex-row",children:[{icon:o.c,title:"Generate new permutation request",id:1,description:"You will need the id of the teacher you want to swap with.",onClick:function(){return s.setTab(1)}},{icon:o.L,title:"Find permutation by code",id:2,description:"You will need a code, that was generated by the other teacher",onClick:function(){return s.setTab(2)}}].map((function(e,t){var s=e.icon;return Object(g.jsxs)("div",{onClick:e.onClick,className:"p-2  group items-center rounded border flex flex-1 hover:bg-accent-400 cursor-pointer",children:[Object(g.jsx)("section",{className:"p-2 bg-accent-400 rounded group-hover:bg-accent-800 group-hover:text-white text-accent-800",children:Object(g.jsx)(s,{size:40})}),Object(g.jsxs)("section",{className:"flex-1 pl-3",children:[Object(g.jsx)("h2",{className:"text-xl  text-gray-900",children:e.title}),Object(g.jsx)("p",{className:"text-gray-400 text-sm",children:e.description})]})]},t)}))})]}),!0===this.state.loading_permutations&&Object(g.jsx)("div",{className:"py-6 text-center text-6xl text-accent-800",children:Object(g.jsx)(_.a,{className:"mx-auto text-2xl"})}),!(0===this.state.my_permutations.length)&&Object(g.jsxs)(x.a,{transparent:!0,className:"mt-3 animate__animated animate__fadeIn animate__faster",children:[Object(g.jsxs)("h2",{className:"text-center text-3xl pb-2 font-bold text-gray-500",children:["My permutations"," ",Object(g.jsx)("b",{children:"(".concat(this.state.my_permutations.length,")")})]}),!0===this.state.loading_permutations?Object(g.jsx)("div",{className:"py-6 text-center text-8xl",children:Object(g.jsx)(_.a,{className:"mx-auto text-2xl"})}):this.state.my_permutations.length<=0?Object(g.jsxs)("div",{className:"py-4 text-center bg-white",children:[Object(g.jsx)("h2",{className:"text-6xl text-gray-600",children:Object(g.jsx)(o.fb,{className:"mx-auto"})}),Object(g.jsx)("h3",{className:"font-bold text-lg",children:"No permutation found!"}),Object(g.jsx)("h3",{className:"pt-1 text-gray-600",children:"Please try again later"})]}):this.state.my_permutations.map((function(e,t){return Object(g.jsx)(y,{permutation:e},t)}))]})]}),1===this.state.selected_option&&Object(g.jsxs)(x.a,{className:"animate__animated animate__zoomIn animate__faster",children:[Object(g.jsx)(f,{title:"Generate new permutation request",back:function(){if(null!==s.state.user_2)return s.setState({user_2:null});s.setTab(null)}}),null===this.state.user_2&&Object(g.jsxs)("div",{className:"py-6 text-center",children:[Object(g.jsx)(o.b,{size:70,className:"mx-auto text-gray-400"}),Object(g.jsx)("h3",{className:"font-bold text-gray-700 text-2xl pt-2",children:"Who do you want to swap with?"}),Object(g.jsxs)("p",{className:"pt-1 text-gray-600",children:["Make sure that he/she is aware that you are choosing him/her",Object(g.jsx)("br",{}),"If he/she does not know the about this your request will not reach him/her"]}),Object(g.jsxs)("div",{className:"max-w-screen-sm mx-auto mt-3 ",children:["search-user-error"===this.state.error.target?Object(g.jsx)(h.a,{theme:"danger",children:this.state.error.msg}):null,Object(g.jsxs)("div",{className:"pt-2 flex gap-1 items-center pb-1 w-full bg-gray-100 px-3 rounded  ".concat("search-user-error"===this.state.error.target?"animate__animated  animate__shakeX":""),children:[Object(g.jsx)(p.a,{onChange:function(e){s.setState({search_nid:e.target.value})},className:"flex-1",value:this.state.search_nid,error:"",label:"",placeholder:"",name:"",type:"number"}),Object(g.jsx)(b.a,{size:"lg",className:"w-48",loading:this.state.loading_user,onClick:this.searchUser,children:"Search user"})]})]})]}),null!==this.state.user_2&&Object(g.jsxs)(g.Fragment,{children:[" ",!0===this.state.loading_user?Object(g.jsx)("div",{className:"py-6 mx-auto text-center",children:Object(g.jsx)(_.a,{})}):Object(g.jsxs)("div",{className:"p-2 animate__animated animate__fadeIn animate__faster",children:[Object(g.jsxs)("div",{className:" flex pt-2",children:[Object(g.jsx)("div",{className:"",children:Object(g.jsx)(o.a,{size:120,className:"text-gray-400"})}),Object(g.jsxs)("div",{className:"pl-3 flex-1",children:[Object(g.jsx)("h3",{className:"pb-0.5 text-xl font-bold text-gray-600 border-b mb-2",children:"User details"}),Object(g.jsxs)("section",{className:"flex items-center pb-0.5",children:[Object(g.jsx)("label",{className:"text-sm text-gray-500 mb-0",children:"NID:"}),Object(g.jsx)("h4",{className:"font-bold pl-1",children:this.state.user_2.nid})]}),Object(g.jsxs)("section",{className:"flex items-center pb-0.5",children:[Object(g.jsx)("label",{className:"text-sm text-gray-500 mb-0",children:"Staff code:"}),Object(g.jsx)("h4",{className:"font-bold pl-1",children:this.state.user_2.staff_code})]}),Object(g.jsxs)("section",{className:"flex items-center pb-0.5",children:[Object(g.jsx)("label",{className:"text-sm text-gray-500",children:"Teacher names:"}),Object(g.jsx)("h4",{className:"font-bold pl-1",children:this.state.user_2.full_name})]})]}),Object(g.jsxs)("div",{className:"pl-3 flex-1",children:[Object(g.jsx)("h3",{className:"pb-0.5 text-xl font-bold text-gray-600 border-b mb-2",children:"Academic details"}),Object(g.jsxs)("section",{className:"flex items-center pb-0.5",children:[Object(g.jsx)("label",{className:"text-sm text-gray-500 mb-0",children:"School code:"}),Object(g.jsx)("h4",{className:"font-bold pl-1",children:this.state.user_2.school_code})]}),Object(g.jsxs)("section",{className:"flex items-center pb-0.5",children:[Object(g.jsx)("label",{className:"text-sm text-gray-500",children:"School name:"}),Object(g.jsx)("h4",{className:"font-bold pl-1",children:this.state.user_2.school_name})]}),Object(g.jsxs)("section",{className:"flex items-center pb-0.5",children:[Object(g.jsx)("label",{className:"text-sm text-gray-500",children:"School location:"}),Object(g.jsx)("h4",{className:"font-bold pl-1",children:this.state.user_2.district_name})]})]})]}),Object(g.jsx)("div",{className:"p-1 text-right border-t pt-2 mt-2",children:Object(g.jsx)(b.a,{onClick:this.generatePermutation,loading:this.state.loading_request,children:"Generate permutation request"})})]})]})]}),2===this.state.selected_option&&Object(g.jsx)(g.Fragment,{children:0===this.state.found_permutations.length?Object(g.jsxs)(x.a,{className:"animate__animated animate__zoomIn animate__faster",children:[Object(g.jsx)(f,{title:"Find permutation by code",back:this.setTab.bind(this,null)}),Object(g.jsx)("div",{className:"p-2",children:Object(g.jsxs)("div",{className:"py-6 text-center",children:[Object(g.jsx)(o.L,{size:70,className:"mx-auto text-gray-400"}),Object(g.jsx)("h3",{className:"font-bold text-gray-700 text-2xl pt-2",children:"Find the permutation?"}),Object(g.jsx)("p",{className:"pt-1 text-gray-600",children:"Please enter the code your friend gave you below"}),Object(g.jsxs)("div",{className:"w-80 mx-auto mt-3 ",children:["search-code-error"===this.state.error.target?Object(g.jsx)(h.a,{theme:"danger",children:this.state.error.msg}):null,Object(g.jsxs)("div",{className:"pt-2  flex gap-1 items-center pb-1 w-full bg-gray-100 px-3 rounded  ".concat("search-code-error"===this.state.error.target?"animate__animated  animate__shakeX":""),children:[Object(g.jsx)(p.a,{onChange:function(e){s.setState({search_code:e.target.value,error:{msg:"",target:null}})},disabled:this.state.loading_user_by_code,className:"flex-1",value:this.state.search_code,error:"",label:"",size:"lg",placeholder:"",name:"",type:"number",Input_className:""}),Object(g.jsx)(b.a,{size:"lg",className:"w-",loading:this.state.loading_user_by_code,onClick:this.searchUserByCode,children:"Check"})]})]})]})})]}):Object(g.jsxs)(x.a,{children:[Object(g.jsxs)("div",{className:"flex border-b p-2 mb-2 ",children:[Object(g.jsx)("h3",{className:"text-2xl font-bold text-gray flex-1",children:"Permutation"}),Object(g.jsx)(b.a,{theme:"danger-light",onClick:function(){return s.setState({found_permutations:[]})},children:"Close"})]}),Object(g.jsx)("div",{className:"",children:this.state.found_permutations.map((function(e,t){return Object(g.jsx)(y,{more:!0,permutation:e,approveUser:s.userApprovePermutationUser},t)}))})]})}),"approve-permutation-success"===this.state.error.target&&Object(g.jsx)(h.a,{fixed:!0,children:this.state.error.msg})]}):Object(g.jsx)(x.a,{children:Object(g.jsx)(h.a,{children:"Please refresh your account or login"})})}}]),s}(i.a.Component),S=Object(d.b)((function(e){return{auth:e.auth,basic:e.basic}}),{})(w)}}]);
//# sourceMappingURL=44.7a3002c2.chunk.js.map