(this.webpackJsonpTMIS=this.webpackJsonpTMIS||[]).push([[68],{490:function(e,t,s){"use strict";s.r(t),s.d(t,"InternalTransfer",(function(){return y}));var a=s(9),r=s(19),c=s(20),i=s(21),o=s(22),n=s(4),l=s.n(n),d=s(36),h=s(13),_=s(47),u=s(23),b=s(53),m=s(92),j=s(26),p=s(28),x=s(93),f=s(27),O=s(1),g=function(e){var t=e.close,s=e.district_id,a=e.district_name,r=void 0===a?null:a,c=Object(n.useState)(!0),i=Object(p.a)(c,2),o=i[0],l=i[1],d=Object(n.useState)([]),u=Object(p.a)(d,2),b=u[0],m=u[1],g=Object(n.useState)(""),v=Object(p.a)(g,2),N=v[0],y=v[1];return Object(n.useEffect)((function(){!0===o&&Object(h.O)(s,(function(e,t,s){l(!1),m(t),y(s),console.log({data:t})}))}),[o,s]),Object(O.jsx)(f.d,{backDrop:!0,theme:f.c.default,close:t,backDropClose:!1,widthSizeClass:f.b.large,displayClose:!0,padding:{title:!0,body:!1,footer:!1},title:"Export report",children:Object(O.jsxs)("div",{className:"border-t p-4 py-8",children:[""!==N&&Object(O.jsx)(_.a,{theme:"danger",children:N}),!0===o?Object(O.jsxs)("div",{className:"text-xl text-center",children:[Object(O.jsx)(j.a,{}),Object(O.jsx)("h2",{className:"text-2xl font-bold pt-2",children:"Preparing report"}),Object(O.jsx)("h4",{className:"text-gray-500 text-sm",children:"Please wait..."})]}):Object(O.jsxs)("div",{className:"text-center",children:[Object(O.jsxs)("h1",{className:"text-3xl",children:["Your ",Object(O.jsx)("b",{children:"Internal Transfer"})," report is ready"]}),Object(O.jsx)("h1",{children:"You can download it now"}),Object(O.jsx)("div",{className:"inline-block pt-5",children:Object(O.jsx)(x.a,{fileData:b.map((function(e){var t,s,a,r,c,i;return{teacher_id:e.teacher_id,teacher_first_name:e.teacher_first_name,teacher_last_name:e.teacher_last_name,teacher_full_name:e.teacher_full_name,teacher_phone_number:e.teacher_phone_number,position_code:e.position_code,position_name:e.position_name,qualification:e.qualification_name,school_from_code:null===(t=e.school_from_info)||void 0===t?void 0:t.school_code,school_form_name:null===(s=e.school_from_info)||void 0===s?void 0:s.school_name,district_from_name:null===(a=e.school_from_info)||void 0===a?void 0:a.district_name,approved_school_code:null===(r=e.approved_school_info)||void 0===r?void 0:r.school_code,approved_school_name:null===(c=e.approved_school_info)||void 0===c?void 0:c.school_name,approved_district_name:null===(i=e.approved_school_info)||void 0===i?void 0:i.district_name,transfer_reason:e.transfer_reason,transfer_type:e.transfer_type,teacher_requested_transfer_date:e.teacher_requested_transfer_date}})),fileName:"INTERNAL TRANSFERS - ".concat(s,"  ").concat(r?" - "+r:""),btnName:"Download EXCEL"})})]})]})})},v={target:null,msg:""},N=function(e){Object(i.a)(s,e);var t=Object(o.a)(s);function s(e){var c;return Object(r.a)(this,s),(c=t.call(this,e)).setOpenDownload=function(){return c.setState({open_download_excel:!c.state.open_download_excel})},c.loadingData=function(e,t,s){c.setState({loading:!0,selected_transfer_id:null,data:[],transfer_issue:""}),Object(h.P)({district_code:e,limit:c.state.limit,page:t,status:s||c.state.status},(function(e,s,a){c.setState({loading:!1,data:null!==s&&void 0!==s&&s.district_transfer_request?null===s||void 0===s?void 0:s.district_transfer_request:[],total:null!==s&&void 0!==s&&s.total_transfer?s.total_transfer:0,next:null!==s&&void 0!==s&&s.next?+(null===s||void 0===s?void 0:s.next):0,previous:null!==s&&void 0!==s&&s.previous?+(null===s||void 0===s?void 0:s.previous):0,error:e?v:{target:"main-error",msg:"Error: ".concat(a)},page:t})}))},c.paginateData=function(e){var t;null!==(t=c.props.auth.district)&&void 0!==t&&t.district_code&&c.loadingData(c.state.selected_district,e)},c.submitIssue=function(){return c.state.transfer_issue.length<=20||""===c.state.selected_transfer_id||null===c.state.selected_transfer_id?c.setState({error:{target:"request-input",msg:"Your message is too short, minimum characters are 20"}}):(c.setState({loading_request:!0}),void Object(h.hc)({teacher_transfer_id:c.state.selected_transfer_id,transfer_issue_comment:c.state.transfer_issue},(function(e,t,s){c.setState({loading_request:!1,error:!0===e?{target:"main-success",msg:"The request has been submitted successfully."}:{target:"main-error",msg:s},data:c.state.data.map((function(e){return e.teacher_transfer_id===c.state.selected_transfer_id?Object(a.a)(Object(a.a)({},e),{},{transfer_issue_comment:c.state.transfer_issue}):e}))})})))},c.changeStatus=function(e){c.state.status!==e&&c.props.auth.district&&(c.setState({status:e}),c.loadingData(c.state.selected_district,1,e))},c.state={loading:!1,error:v,data:[],limit:14,page:1,total:0,next:0,previous:0,selected_transfer_id:null,transfer_issue:"",loading_request:!1,status:"NO-ISSUE",open_download_excel:!1,selected_district:""},c}return Object(c.a)(s,[{key:"componentDidMount",value:function(){if(this.props.district_code)this.setState({selected_district:this.props.district_code}),this.loadingData(this.props.district_code,this.state.page,this.state.status);else{if(!this.props.auth.district||!this.props.auth.district.district_code)return this.setState({error:{target:"main-error",msg:"There is no district assigned to you!"}});this.setState({selected_district:this.props.auth.district.district_code}),this.loadingData(this.props.auth.district.district_code,this.state.page,this.state.status)}}},{key:"render",value:function(){var e=this,t=(this.state.total/this.state.limit).toFixed(0);return Object(O.jsxs)(O.Fragment,{children:[!0===this.state.open_download_excel&&this.props.auth.district&&Object(O.jsx)(g,{district_id:this.state.selected_district,close:this.setOpenDownload,district_name:this.props.district_name?this.props.district_name:null}),"main-success"===this.state.error.target&&Object(O.jsx)(_.a,{theme:"success",fixed:!0,children:this.state.error.msg}),"main-error"===this.state.error.target&&Object(O.jsx)(_.a,{theme:"danger",fixed:!0,children:this.state.error.msg}),Object(O.jsxs)("div",{className:"container mx-auto px-4 flex items-center",children:[Object(O.jsx)("div",{className:"flex-1",children:Object(O.jsx)(m.a,{className:"",children:"Internal transfers"})}),Object(O.jsx)("section",{className:"pr-3",children:Object(O.jsx)(u.a,{onClick:this.setOpenDownload,theme:"success",children:"Generate Excel"})}),Object(O.jsxs)("section",{className:"text-center p-1 bg-accent-800 bg-opacity-20 text-accent-900 px-4 rounded",children:[Object(O.jsx)("span",{className:"text-sm block text-gray-500 -mb-1",children:"Total:"}),Object(O.jsx)("h3",{className:"font-bold text-xl",children:this.state.total})]})]}),Object(O.jsxs)(b.a,{transparent:!0,children:[Object(O.jsxs)("table",{className:"w-full",children:[Object(O.jsx)("thead",{className:"text-left bg-white",children:Object(O.jsxs)("tr",{className:"bg-accent-900 bg-opacity-10",children:[Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"#"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"Names"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"School Code"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"School name"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"Position code"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"Position name"}),Object(O.jsx)("th",{className:"p-2 border-gray-300 border",children:"Qualification"})]})}),Object(O.jsx)("tbody",{children:!0===this.state.loading?Object(O.jsx)("tr",{className:" ",children:Object(O.jsx)("td",{colSpan:8,className:"py-4 text-center border",children:Object(O.jsx)(j.a,{})})}):this.state.data.length<=0?Object(O.jsx)("tr",{children:Object(O.jsx)("td",{colSpan:12,className:"py-4 text-center border",children:Object(O.jsx)("h1",{className:"text-2xl text-gray-400",children:"No data found"})})}):this.state.data.map((function(e,t){var s,a;return Object(O.jsxs)("tr",{className:"bg-white  hover:bg-yellow-400 hover:bg-opacity-30",children:[Object(O.jsx)("td",{className:"border p-2",children:t+1}),Object(O.jsx)("td",{className:"p-2 border",children:e.teacher_full_name}),Object(O.jsx)("td",{className:"p-2 border",children:null===(s=e.school_from_info)||void 0===s?void 0:s.school_code}),Object(O.jsx)("td",{className:"p-2 border",children:null===(a=e.school_from_info)||void 0===a?void 0:a.school_name}),Object(O.jsx)("td",{className:"p-2 border",children:e.position_code}),Object(O.jsx)("td",{className:"p-2 border text-sm",children:e.position_name}),Object(O.jsx)("td",{className:"p-2 border",children:e.qualification_name})]},t)}))})]}),Object(O.jsx)("div",{className:"flex gap-3 mx-auto pt-3",children:Array(+t).fill("0").map((function(t,s){return Object(O.jsx)("button",{className:"p-2 py-1 ".concat(+e.state.page===s+1?"bg-accent-800 text-black font-bold":"bg-opacity-25"," rounded-full bg-accent-800 "),onClick:e.paginateData.bind(e,s+1),children:s+1})}))})]})]})}}]),s}(l.a.Component),y=Object(d.b)((function(e){return{auth:e.auth}}),{})(N)}}]);
//# sourceMappingURL=68.2f54aec9.chunk.js.map