(this.webpackJsonpTMIS=this.webpackJsonpTMIS||[]).push([[36],{374:function(o,e,s){"use strict";var t=s(4),i=s(7),c=s(35),n=s(8),a=s(41),l=s(28),r=s(29),d=s(30),h=s(31),p=s(3),u=s(17),b=s(61),j=s(348),x=s(15),m=s(9),f=s.n(m),v=s(11),g=s(19),O=s(47),_=s(13),S=s(2),w=function(o){Object(d.a)(s,o);var e=Object(h.a)(s);function s(o){var r;return Object(l.a)(this,s),(r=e.call(this,o)).addPositionToSchool=function(o){r.setState({schoolPositionsTemp:[o].concat(Object(a.a)(r.state.schoolPositionsTemp.filter((function(e){return e.position_id!==o.position_id}))))})},r.addSchoolPositions=Object(n.a)(Object(t.a)().mark((function o(){var e,s,n,a;return Object(t.a)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!0!==window.confirm("Are you sure do you want to add these positions?")){o.next=23;break}if(!(r.state.schoolPositionsTemp.length>0&&void 0===r.props.school?r.props.auth.school:r.props.school)){o.next=23;break}Object(v.a)(),e=[],r.setState({loading:!0}),s=Object(c.a)(r.state.schoolPositionsTemp);try{for(s.s();!(n=s.n()).done;)a=n.value,e.push({school_code:void 0===r.props.school?r.props.auth.school.school_code:r.props.school.school_code,position_code:a.position_code})}catch(t){s.e(t)}finally{s.f()}return console.log("Positions codes: ",e),o.prev=8,o.next=11,f.a.post("".concat(x.d,"/schoolposition/assign"),e);case 11:r.props.appendPositionsToSchool(r.state.schoolPositionsTemp),r.setState({schoolPositionsTemp:[]}),r.setState({loading:!1}),r.setState({success:"Positions added successfully!",error:""}),alert("Positions added successfully!"),o.next=23;break;case 18:o.prev=18,o.t0=o.catch(8),r.setState({loading:!1}),r.setState({success:"",error:Object(_.a)(o.t0)}),console.log("Err: ",Object(i.a)({},o.t0));case 23:case"end":return o.stop()}}),o,null,[[8,18]])}))),r.RemoveSchoolPosition=function(){var o=Object(n.a)(Object(t.a)().mark((function o(e,s){var c;return Object(t.a)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(""===s||!0!==window.confirm("Are you sure do you want to remove this position")){o.next=15;break}return r.setState({loading:!0}),o.prev=2,o.next=5,f.a.post("".concat(x.d,"/schoolposition/delete/").concat(e),{school_code:s});case 5:c=o.sent,console.log("Delete status: ",c.status),200===c.status?(r.setState({success:"Positions added successfully!",error:""}),r.props.removePositionsToSchool(e)):r.setState({success:"",error:"Something went wrong! try again"}),o.next=15;break;case 10:o.prev=10,o.t0=o.catch(2),r.setState({success:"",error:Object(_.a)(o.t0)}),r.setState({loading:!1}),console.log("Err: ",Object(i.a)({},o.t0));case 15:case"end":return o.stop()}}),o,null,[[2,10]])})));return function(e,s){return o.apply(this,arguments)}}(),r.state={searchPositionValue:"",schoolPositionsTemp:[],edit:!1,loading:!1,success:"",error:""},r}return Object(r.a)(s,[{key:"render",value:function(){var o,e,s=this;return Object(S.jsx)("div",{children:Object(S.jsxs)("div",{className:"bg-white dark:bg-dark-800 p-3 rounded",children:[Object(S.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[Object(S.jsxs)("div",{className:"flex flex-col",children:[Object(S.jsx)("span",{className:"text-2xl font-bold text-gray-600",children:!0===this.state.edit?"Assign positions to school":"School positions list"}),Object(S.jsx)("div",{children:Object(S.jsx)(O.a,{onClick:function(){return s.setState({edit:!s.state.edit})},theme:!0===this.state.edit?"default":"accent",children:!0===this.state.edit?"Back to list":"Add new positions"})})]}),Object(S.jsx)("div",{children:Object(S.jsx)("div",{onClick:function(){return s.props.close&&s.props.close()},className:"bg-gray-100 hover:bg-yellow-100 flex items-center justify-center p-1 cursor-pointer rounded-full",children:Object(S.jsx)(u.l,{className:"text-3xl"})})})]}),""!==this.state.success&&Object(S.jsx)("div",{onClick:function(){return s.setState({success:""})},className:"bg-green-600 text-white font-bold pl-4 pr-2 py-2 text-lg rounded-md my-2 fixed right-10 cursor-pointer shadow-xl animate__animated animate__bounceInRight",children:Object(S.jsxs)("div",{className:"flex flex-row justify-between items-center gap-8",children:[Object(S.jsxs)("div",{children:["Success: ",this.state.success]}),Object(S.jsx)("div",{children:Object(S.jsx)(u.l,{className:"text-2xl text-red-600 bg-red-100 rounded-full"})})]})}),""!==this.state.error&&Object(S.jsx)("div",{onClick:function(){return s.setState({error:""})},className:"bg-red-600 text-white font-bold pl-4 pr-2 py-2 text-lg rounded-md my-2 fixed right-10 cursor-pointer shadow-xl animate__animated animate__bounceInRight",children:Object(S.jsxs)("div",{className:"flex flex-row justify-between items-center gap-8",children:[Object(S.jsxs)("div",{children:["Error: ",this.state.error]}),Object(S.jsx)("div",{children:Object(S.jsx)(u.l,{className:"text-2xl text-red-600 bg-red-100 rounded-full"})})]})}),Object(S.jsxs)("div",{className:"grid md:grid-cols-".concat(!0===this.state.edit?"2":"1"),children:[Object(S.jsxs)("div",{className:"col-span-1 border-r pr-2 ".concat(!0===this.state.edit?"":"hidden"),children:[Object(S.jsx)("div",{className:"",children:Object(S.jsx)(b.a,{onChange:function(o){return s.setState({searchPositionValue:o.target.value})},error:"",placeholder:"Search position...",value:this.state.searchPositionValue,type:"search",name:"post",label:"Search"})}),Object(S.jsx)("div",{className:"h-screen overflow-y-auto",children:0===Object(g.i)(this.props.positions,this.state.searchPositionValue).length?Object(S.jsx)("div",{children:"No positions found!"}):Object(g.i)(this.props.positions,this.state.searchPositionValue).filter((function(o){var e;return o.position_id!==(null===(e=s.state.schoolPositionsTemp.find((function(e){return e.position_id===o.position_id})))||void 0===e?void 0:e.position_id)})).map((function(o,e){return Object(S.jsxs)("div",{className:"border border-gray-300 px-3 py-2 flex flex- justify-between group bg-white hover:bg-blue-50 hover:border-blue-300 gap-3  items-center cursor-pointer my-1 rounded",onClick:function(){s.addPositionToSchool(o)},children:[Object(S.jsx)("div",{className:"flex flex-col",children:Object(S.jsxs)("span",{className:"text-base font-bold text-gray-700 group-hover:text-primary-800",children:[o.position_name,"(",o.qualification_name,")"]})}),Object(S.jsx)("div",{className:"",children:Object(S.jsx)("div",{className:"bg-blue-100 text-primary px-3 py-1 rounded cursor-pointer text-base text-primary-800 group-hover:text-white group-hover:bg-primary-800",children:"Select"})})]},e+1)}))})]}),Object(S.jsxs)("div",{className:"col-span-1 px-3",children:[" ",Object(S.jsxs)("div",{className:"flex flex-col border-b pb-3 border-accent-900",children:[Object(S.jsx)("span",{children:"School"}),Object(S.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[Object(S.jsxs)("span",{className:"text-accent-900 text-xl font-bold",children:[void 0===this.props.school?null===(o=this.props.auth.school)||void 0===o?void 0:o.school_name:this.props.school.school_name," ","(",void 0===this.props.school?null===(e=this.props.auth.school)||void 0===e?void 0:e.school_code:this.props.school.school_code,")"]}),Object(S.jsx)("div",{className:"font-bold text-2xl",children:[].concat(Object(a.a)(this.state.schoolPositionsTemp),Object(a.a)(this.props.schoolPositions)).length})]})]}),Object(S.jsx)("div",{className:"mt-3",children:0===[].concat(Object(a.a)(this.state.schoolPositionsTemp),Object(a.a)(this.props.schoolPositions)).length?Object(S.jsxs)("div",{className:"flex flex-col bg-gray-100 w-full justify-center items-center rounded-md p-4",children:[Object(S.jsx)("div",{className:"text-7xl text-gray-400",children:Object(S.jsx)(j.c,{})}),Object(S.jsx)("span",{className:"text-3xl text-black",children:"School positions not found"}),Object(S.jsx)("span",{className:"text-sm text-gray-600",children:"This school has no positions assigned to it. Please select positions"})]}):Object(S.jsxs)("div",{children:[0!==this.state.schoolPositionsTemp.length&&Object(S.jsx)("div",{className:"text-xl text-primary-800 my-3 font-bold",children:"New pending"}),this.state.schoolPositionsTemp.map((function(o,e){return Object(S.jsx)("div",{className:"border rounded-md px-3 py-2 mb-2 group cursor-pointer ".concat(void 0!==s.state.schoolPositionsTemp.find((function(e){return e.position_id===o.position_id}))?"bg-yellow-50 border-yellow-400":"bg-blue-50 border-blue-400 hover:bg-blue-100"," "),children:Object(S.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[Object(S.jsxs)("span",{className:"text-lg font-bold",children:[o.position_name," (",o.qualification_name,")"]}),Object(S.jsx)("div",{className:"",children:Object(S.jsx)("div",{onClick:function(){s.setState({schoolPositionsTemp:s.state.schoolPositionsTemp.filter((function(e){return e.position_id!==o.position_id}))})},className:"bg-white text-accent-900 px-3 py-1 rounded cursor-pointer text-base border border-yellow-400",children:"Remove"})})]})},e+1)})),0!==this.state.schoolPositionsTemp.length&&Object(S.jsx)("div",{children:Object(S.jsx)("div",{onClick:function(){s.addSchoolPositions()},className:"bg-primary-800 text-white hover:bg-blue-900 px-4 py-2 rounded w-max cursor-pointer",children:"Submit positions"})}),0!==this.props.schoolPositions.length&&Object(S.jsx)("div",{className:"font-bold text-lg text-gray-500 my-3",children:"List of school position"}),this.props.schoolPositions.map((function(o,e){return Object(S.jsxs)("div",{className:"border rounded-md px-3 py-2 mb-2 group cursor-pointer ".concat(void 0!==s.state.schoolPositionsTemp.find((function(e){return e.position_code===o.position_code}))?"bg-yellow-50 border-yellow-400":"bg-blue-50 border-blue-400 hover:bg-blue-100"," flex flex-row items-center justify-between gap-4"),children:[Object(S.jsx)("div",{className:"",children:Object(S.jsx)("div",{className:"flex flex-row items-center justify-between",children:Object(S.jsxs)("span",{className:"text-lg font-bold",children:[o.position_name," (",o.qualification_name,")"]})})}),Object(S.jsx)("div",{children:Object(S.jsx)("div",{onClick:function(){return s.RemoveSchoolPosition(o.school_has_position_id,o.school_code)},className:"bg-white border border-white text-red-800 group-hover:border-red-500 px-3 py-2 font-bold text-center rounded",children:"Remove"})})]},e+1)}))]})})]})]})]})})}}]),s}(p.Component);e.a=w},549:function(o,e,s){"use strict";s.r(e),s.d(e,"_AssignSchoolPosition",(function(){return b})),s.d(e,"AssignSchoolPosition",(function(){return j}));var t=s(28),i=s(29),c=s(30),n=s(31),a=s(3),l=s(51),r=s(374),d=s(27),h=s(16),p=s(48),u=s(2),b=function(o){Object(c.a)(s,o);var e=Object(n.a)(s);function s(o){var i;return Object(t.a)(this,s),(i=e.call(this,o)).componentDidMount=function(){null===i.props.basic.positions&&i.props.FC_GetAllPositions((function(o,e){i.setState({loading_data:!0}),!0===o&&i.setState({loading_data:!1}),console.log(o)})),i.props.basic.academic_calender&&i.props.auth.school&&Object(h.N)(i.props.auth.school.school_code,i.props.basic.academic_calender.academic_year_id,(function(o,e,s){var t;null!==e&&(i.setState({loading_data:!0}),!0===o&&null!==i.props.auth.school&&(i.setState({schoolPositionsShow:{school_code:null===(t=i.props.auth.school)||void 0===t?void 0:t.school_code,school_id:i.props.auth.school.school_code,school_positions:e.school_positions,school:{school_id:i.props.auth.school.school_code,school_code:i.props.auth.school.school_code,school_name:i.props.auth.school.school_name,school_category:i.props.auth.school.schoolcategory,school_status:i.props.auth.school.schoolstatus,region_code:i.props.auth.school.regioncode}}}),i.setState({loading_data:!1})))}))},i.state={loading_data:!1,schoolPositionsShow:null},i}return Object(i.a)(s,[{key:"render",value:function(){var o=this;return!0===this.state.loading_data||null===this.props.basic.positions||null===this.state.schoolPositionsShow?Object(u.jsx)(l.a,{children:Object(u.jsxs)("div",{className:"mx-auto p-8 flex flex-col items-center justify-center",children:[Object(u.jsx)("div",{children:"Loading, please wait..."}),Object(u.jsx)(p.a,{})]})}):Object(u.jsx)(l.a,{children:Object(u.jsx)("div",{className:"",children:null!==this.state.schoolPositionsShow&&null!==this.props.basic.positions&&Object(u.jsx)(r.a,{auth:this.props.auth,positions:this.props.basic.positions,schoolPositions:this.state.schoolPositionsShow.school_positions,school:this.state.schoolPositionsShow.school,appendPositionsToSchool:function(e){o.state.schoolPositionsShow&&o.props.basic.academic_calender&&Object(h.N)(o.state.schoolPositionsShow.school_code,o.props.basic.academic_calender.academic_year_id,(function(e,s,t){null!==s&&(o.setState({loading_data:!0}),!0===e&&(o.state.schoolPositionsShow&&o.setState({schoolPositionsShow:{school_code:o.state.schoolPositionsShow.school_code,school_id:o.state.schoolPositionsShow.school_id,school_positions:s.school_positions,school:o.state.schoolPositionsShow.school}}),o.setState({loading_data:!1})))}))},removePositionsToSchool:function(e){o.state.schoolPositionsShow&&o.props.basic.academic_calender&&Object(h.N)(o.state.schoolPositionsShow.school_code,o.props.basic.academic_calender.academic_year_id,(function(e,s,t){null!==s&&(o.setState({loading_data:!0}),!0===e&&(o.state.schoolPositionsShow&&o.setState({schoolPositionsShow:{school_code:o.state.schoolPositionsShow.school_code,school_id:o.state.schoolPositionsShow.school_id,school_positions:s.school_positions,school:o.state.schoolPositionsShow.school}}),o.setState({loading_data:!1})))}))},close:function(){}})})})}}]),s}(a.Component),j=Object(d.b)((function(o){return{auth:o.auth,basic:o.basic,schoolHierarchyStore:o.schoolHierarchyStore}}),{FC_GetAllPositions:h.n,FC_AllSchoolHierarchyDetails:h.c})(b)}}]);
//# sourceMappingURL=36.095e2ac8.chunk.js.map