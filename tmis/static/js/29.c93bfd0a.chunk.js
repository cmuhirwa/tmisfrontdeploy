(this["webpackJsonpreact-redux-typescript-advance"]=this["webpackJsonpreact-redux-typescript-advance"]||[]).push([[29],{123:function(e,t,s){"use strict";var o=s(4),i=s(40),n=s(6),c=s(35),a=s(26),r=s(27),l=s(28),d=s(29),u=s(3),h=s.n(u),p=s(2),b=s(11),x=s(31),m=s(128),j=s(13),_=s(5),f=s.n(_),v=s(8),g=s(18),O=s(25),y=s(9),P=s(1),N=function(e){Object(l.a)(s,e);var t=Object(d.a)(s);function s(e){var r;return Object(a.a)(this,s),(r=t.call(this,e)).addPositionToSchool=function(e){r.setState({schoolPositionsTemp:[e].concat(Object(c.a)(r.state.schoolPositionsTemp.filter((function(t){return t.position_id!==e.position_id}))))})},r.addSchoolPositions=Object(n.a)(h.a.mark((function e(){var t,s,n,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==window.confirm("Are you sure do you want to add these positions?")){e.next=23;break}if(!(r.state.schoolPositionsTemp.length>0&&void 0===r.props.school?r.props.auth.school:r.props.school)){e.next=23;break}Object(v.a)(),t=[],r.setState({loading:!0}),s=Object(i.a)(r.state.schoolPositionsTemp);try{for(s.s();!(n=s.n()).done;)c=n.value,t.push({school_code:void 0===r.props.school?r.props.auth.school.school_code:r.props.school.school_code,position_code:c.position_code})}catch(a){s.e(a)}finally{s.f()}return console.log("Positions codes: ",t),e.prev=8,e.next=11,f.a.post("".concat(j.c,"/schoolposition/assign"),t);case 11:r.props.appendPositionsToSchool(r.state.schoolPositionsTemp),r.setState({schoolPositionsTemp:[]}),r.setState({loading:!1}),r.setState({success:"Positions added successfully!",error:""}),alert("Positions added successfully!"),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(8),r.setState({loading:!1}),r.setState({success:"",error:Object(y.a)(e.t0)}),console.log("Err: ",Object(o.a)({},e.t0));case 23:case"end":return e.stop()}}),e,null,[[8,18]])}))),r.RemoveSchoolPosition=function(){var e=Object(n.a)(h.a.mark((function e(t,s){var i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===s||!0!==window.confirm("Are you sure do you want to remove this position")){e.next=15;break}return r.setState({loading:!0}),e.prev=2,e.next=5,f.a.post("".concat(j.c,"/schoolposition/delete/").concat(t),{school_code:s});case 5:i=e.sent,console.log("Delete status: ",i.status),200===i.status?(r.setState({success:"Positions added successfully!",error:""}),r.props.removePositionsToSchool(t)):r.setState({success:"",error:"Something went wrong! try again"}),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(2),r.setState({success:"",error:Object(y.a)(e.t0)}),r.setState({loading:!1}),console.log("Err: ",Object(o.a)({},e.t0));case 15:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,s){return e.apply(this,arguments)}}(),r.state={searchPositionValue:"",schoolPositionsTemp:[],edit:!1,loading:!1,success:"",error:""},r}return Object(r.a)(s,[{key:"render",value:function(){var e,t,s=this;return Object(P.jsx)("div",{children:Object(P.jsxs)("div",{className:"bg-white dark:bg-dark-800 p-3 rounded",children:[Object(P.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[Object(P.jsxs)("div",{className:"flex flex-col",children:[Object(P.jsx)("span",{className:"text-2xl font-bold text-gray-600",children:!0===this.state.edit?"Assign positions to school":"School positions list"}),Object(P.jsx)("div",{children:Object(P.jsx)(O.a,{onClick:function(){return s.setState({edit:!s.state.edit})},theme:!0===this.state.edit?"default":"accent",children:!0===this.state.edit?"Back to list":"Add new positions"})})]}),Object(P.jsx)("div",{children:Object(P.jsx)("div",{onClick:function(){return s.props.close&&s.props.close()},className:"bg-gray-100 hover:bg-yellow-100 flex items-center justify-center p-1 cursor-pointer rounded-full",children:Object(P.jsx)(b.h,{className:"text-3xl"})})})]}),""!==this.state.success&&Object(P.jsx)("div",{onClick:function(){return s.setState({success:""})},className:"bg-green-600 text-white font-bold pl-4 pr-2 py-2 text-lg rounded-md my-2 fixed right-10 cursor-pointer shadow-xl animate__animated animate__bounceInRight",children:Object(P.jsxs)("div",{className:"flex flex-row justify-between items-center gap-8",children:[Object(P.jsxs)("div",{children:["Success: ",this.state.success]}),Object(P.jsx)("div",{children:Object(P.jsx)(b.h,{className:"text-2xl text-red-600 bg-red-100 rounded-full"})})]})}),""!==this.state.error&&Object(P.jsx)("div",{onClick:function(){return s.setState({error:""})},className:"bg-red-600 text-white font-bold pl-4 pr-2 py-2 text-lg rounded-md my-2 fixed right-10 cursor-pointer shadow-xl animate__animated animate__bounceInRight",children:Object(P.jsxs)("div",{className:"flex flex-row justify-between items-center gap-8",children:[Object(P.jsxs)("div",{children:["Error: ",this.state.error]}),Object(P.jsx)("div",{children:Object(P.jsx)(b.h,{className:"text-2xl text-red-600 bg-red-100 rounded-full"})})]})}),Object(P.jsxs)("div",{className:"grid md:grid-cols-".concat(!0===this.state.edit?"2":"1"),children:[Object(P.jsxs)("div",{className:"col-span-1 border-r pr-2 ".concat(!0===this.state.edit?"":"hidden"),children:[Object(P.jsx)("div",{className:"",children:Object(P.jsx)(x.a,{onChange:function(e){return s.setState({searchPositionValue:e.target.value})},error:"",placeholder:"Search position...",value:this.state.searchPositionValue,type:"search",name:"post",label:"Search"})}),Object(P.jsx)("div",{className:"h-screen overflow-y-auto",children:0===Object(g.f)(this.props.positions,this.state.searchPositionValue).length?Object(P.jsx)("div",{children:"No positions found!"}):Object(g.f)(this.props.positions,this.state.searchPositionValue).filter((function(e){var t;return e.position_id!==(null===(t=s.state.schoolPositionsTemp.find((function(t){return t.position_id===e.position_id})))||void 0===t?void 0:t.position_id)})).map((function(e,t){return Object(P.jsxs)("div",{className:"border border-gray-300 px-3 py-2 flex flex- justify-between group bg-white hover:bg-blue-50 hover:border-blue-300 gap-3  items-center cursor-pointer my-1 rounded",onClick:function(){s.addPositionToSchool(e)},children:[Object(P.jsx)("div",{className:"flex flex-col",children:Object(P.jsxs)("span",{className:"text-base font-bold text-gray-700 group-hover:text-primary-800",children:[e.position_name,"(",e.qualification_name,")"]})}),Object(P.jsx)("div",{className:"",children:Object(P.jsx)("div",{className:"bg-blue-100 text-primary px-3 py-1 rounded cursor-pointer text-base text-primary-800 group-hover:text-white group-hover:bg-primary-800",children:"Select"})})]},t+1)}))})]}),Object(P.jsxs)("div",{className:"col-span-1 px-3",children:[" ",Object(P.jsxs)("div",{className:"flex flex-col border-b pb-3 border-accent-900",children:[Object(P.jsx)("span",{children:"School"}),Object(P.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[Object(P.jsxs)("span",{className:"text-accent-900 text-xl font-bold",children:[void 0===this.props.school?null===(e=this.props.auth.school)||void 0===e?void 0:e.school_name:this.props.school.school_name," ","(",void 0===this.props.school?null===(t=this.props.auth.school)||void 0===t?void 0:t.school_code:this.props.school.school_code,")"]}),Object(P.jsx)("div",{className:"font-bold text-2xl",children:[].concat(Object(c.a)(this.state.schoolPositionsTemp),Object(c.a)(this.props.schoolPositions)).length})]})]}),Object(P.jsx)("div",{className:"mt-3",children:0===[].concat(Object(c.a)(this.state.schoolPositionsTemp),Object(c.a)(this.props.schoolPositions)).length?Object(P.jsxs)("div",{className:"flex flex-col bg-gray-100 w-full justify-center items-center rounded-md p-4",children:[Object(P.jsx)("div",{className:"text-7xl text-gray-400",children:Object(P.jsx)(m.a,{})}),Object(P.jsx)("span",{className:"text-3xl text-black",children:"School positions not found"}),Object(P.jsx)("span",{className:"text-sm text-gray-600",children:"This school has no positions assigned to it. Please select positions"})]}):Object(P.jsxs)("div",{children:[0!==this.state.schoolPositionsTemp.length&&Object(P.jsx)("div",{className:"text-xl text-primary-800 my-3 font-bold",children:"New pending"}),this.state.schoolPositionsTemp.map((function(e,t){return Object(P.jsx)("div",{className:"border rounded-md px-3 py-2 mb-2 group cursor-pointer ".concat(void 0!==s.state.schoolPositionsTemp.find((function(t){return t.position_id===e.position_id}))?"bg-yellow-50 border-yellow-400":"bg-blue-50 border-blue-400 hover:bg-blue-100"," "),children:Object(P.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[Object(P.jsxs)("span",{className:"text-lg font-bold",children:[e.position_name," (",e.qualification_name,")"]}),Object(P.jsx)("div",{className:"",children:Object(P.jsx)("div",{onClick:function(){s.setState({schoolPositionsTemp:s.state.schoolPositionsTemp.filter((function(t){return t.position_id!==e.position_id}))})},className:"bg-white text-accent-900 px-3 py-1 rounded cursor-pointer text-base border border-yellow-400",children:"Remove"})})]})},t+1)})),0!==this.state.schoolPositionsTemp.length&&Object(P.jsx)("div",{children:Object(P.jsx)("div",{onClick:function(){s.addSchoolPositions()},className:"bg-primary-800 text-white hover:bg-blue-900 px-4 py-2 rounded w-max cursor-pointer",children:"Submit positions"})}),0!==this.props.schoolPositions.length&&Object(P.jsx)("div",{className:"font-bold text-lg text-gray-500 my-3",children:"List of school position"}),this.props.schoolPositions.map((function(e,t){return Object(P.jsxs)("div",{className:"border rounded-md px-3 py-2 mb-2 group cursor-pointer ".concat(void 0!==s.state.schoolPositionsTemp.find((function(t){return t.position_code===e.position_code}))?"bg-yellow-50 border-yellow-400":"bg-blue-50 border-blue-400 hover:bg-blue-100"," flex flex-row items-center justify-between gap-4"),children:[Object(P.jsx)("div",{className:"",children:Object(P.jsx)("div",{className:"flex flex-row items-center justify-between",children:Object(P.jsxs)("span",{className:"text-lg font-bold",children:[e.position_name," (",e.qualification_name,")"]})})}),Object(P.jsx)("div",{children:Object(P.jsx)("div",{onClick:function(){return s.RemoveSchoolPosition(e.school_has_position_id,e.school_code)},className:"bg-white border border-white text-red-800 group-hover:border-red-500 px-3 py-2 font-bold text-center rounded",children:"Remove"})})]},t+1)}))]})})]})]})]})})}}]),s}(p.Component);t.a=N},163:function(e,t,s){"use strict";s.r(t),s.d(t,"totalItemPosts",(function(){return k})),s.d(t,"vacantPosts",(function(){return T})),s.d(t,"_HdRequestToDee",(function(){return C})),s.d(t,"HdRequestToDee",(function(){return I}));var o=s(35),i=s(4),n=s(40),c=s(6),a=s(26),r=s(27),l=s(28),d=s(29),u=s(3),h=s.n(u),p=s(2),b=s(16),x=s(12),m=s(5),j=s.n(m),_=s(122),f=s(51),v=s(20),g=s(1),O=function(e){var t=Object(p.useState)(""),s=Object(v.a)(t,2),o=s[0],i=s[1],n=Object(p.useState)(e.currentRequests.toString()),c=Object(v.a)(n,2),a=c[0],r=c[1],l=Object(p.useState)(null),d=Object(v.a)(l,2),u=d[0],h=d[1];return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("input",{type:"number",className:"w-20 p-1 border-4 rounded-t border-primary-800 font-bold px-3 text-center text-black",value:a,name:"POSTSS",onChange:function(e){h(null),r(e.target.value)}}),Object(g.jsxs)("div",{className:"animate__animated animate__zoomIn animate__faster absolute p-1 bg-primary-800 rounded-b -mt-0.5 rounded-tl  z-40 w-80 right-0 ",children:[Object(g.jsx)("label",{className:"px-2 text-sm text-gray-300",htmlFor:"selected_comment",children:"Request reason"}),Object(g.jsx)("div",{className:"px-2",children:Object(g.jsxs)("select",{value:o,placeholder:"Select reason",className:"block appearance-none w-full bg-white border-2 border-primary-800 hover:border-gray-500 px-4 py-2 pr-8 rounded shadow leading-tight focus:outline-none focus:shadow-outline md:w-full text-black",onChange:function(e){h(null),i(e.target.value)},children:[Object(g.jsx)("option",{value:"Select reason",children:"Select reason"}),e.postRequestReasons.map((function(e){return Object(g.jsx)("option",{value:e.reason_id,children:e.reason_name},e.reason_id)}))]})}),null!==u&&Object(g.jsx)("div",{onClick:function(){return h(null)},className:"bg-red-100 rounded-md text-red-600 px-2 py-2 mx-3 my-2 animate__animated animate__animated animate__bounceIn",children:u}),Object(g.jsxs)("div",{className:"flex",children:[Object(g.jsx)("button",{onClick:function(){if(a.length<0||"0"===a||""===a)h("Please number of requests should be greater than 0");else if(o.length<0||""===o)h("Please select reason for number of requested posts");else{h(null);var t=e.getPostRequestItem({position:e.position,reason:o,postsNumber:parseInt(a)});console.log("Send: ",t),e.submitRequest(t),e.close()}},className:"p-1 px-4 rounded text-white bg-green-400 hover:bg-green-500 mx-2 my-1",children:"Send request"}),Object(g.jsx)("button",{onClick:function(){return e.close()},className:"p-1 px-2 rounded text-white bg-red-600 hover:bg-red-600  my-1",children:"Cancel"})]})]})]})},y=s(31),P=s(24),N=s(8),w=s(13),S=s(123),q=s(48),R=s(18),k=function(e,t){var s=0,o=e.find((function(e){return e.position_code===t.position_code}));return void 0!==o&&(s=void 0===o.existing_post?0:parseInt(o.existing_post)),s+(null===t.dde_post_distribution||void 0===t.dde_post_distribution?0:parseInt(t.dde_post_distribution))},T=function(e,t,s){var o=0,i=e.find((function(e){return e.position_code===s.position_code}));return void 0!==i&&(o=k(t,s)-parseInt(i.total_on_position)),o},C=function(e){Object(l.a)(s,e);var t=Object(d.a)(s);function s(e){var r;return Object(a.a)(this,s),(r=t.call(this,e)).setLoading=function(e){r.setState({loading:e})},r.getPostRequestReasons=Object(c.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(N.a)(),r.setLoading(!0),e.prev=2,e.next=5,j.a.get("".concat(w.c,"/postRequestReasons"));case 5:t=e.sent,r.setState({postRequestReasons:t.data}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:r.setLoading(!1);case 13:case"end":return e.stop()}}),e,null,[[2,9]])}))),r.existingTeachersCount=function(e){var t,s=0,o=Object(n.a)(r.state.normalSchoolPositions);try{var i=function(){var e=t.value;void 0!==r.state.normalSchoolPositions.find((function(t){return t.position_code===e.position_code}))&&(s+=parseInt(r.state.normalSchoolPositions.find((function(t){return t.position_code===e.position_code})).total_on_position))};for(o.s();!(t=o.n()).done;)i()}catch(c){o.e(c)}finally{o.f()}return s},r.existingTeachersCount1=function(e){var t,s=0,o=Object(n.a)(e);try{var i=function(){var e=t.value;void 0!==r.state.normalSchoolPositions.find((function(t){return t.position_code===e.position_code}))&&(s+=parseInt(r.state.normalSchoolPositions.find((function(t){return t.position_code===e.position_code})).total_on_position))};for(o.s();!(t=o.n()).done;)i()}catch(c){o.e(c)}finally{o.f()}return s},r.newAddedTeachersCount=function(e){var t,s=0,o=Object(n.a)(e);try{for(o.s();!(t=o.n()).done;){var i=t.value;void 0!==i.head_teacher_post_request&&(s+=parseInt(i.head_teacher_post_request))}}catch(c){o.e(c)}finally{o.f()}return s},r.TotalAllowedTeachersCount=function(e){var t,s=0,o=Object(n.a)(e);try{for(o.s();!(t=o.n()).done;){var i=t.value;null!==i.dde_post_distribution&&void 0!==i.dde_post_distribution&&(s+=parseInt(i.dde_post_distribution))}}catch(c){o.e(c)}finally{o.f()}return s},r.countRequestedPosts=function(e){var t=e.reduce((function(e,t){return e+parseInt(t.head_teacher_post_request)}),0);r.setState({totalRequested:t})},r.cleanAlert=function(){setTimeout((function(){r.setState({alert:{target:null,msg:""}})}),2e3)},r.getSchoolPositions=function(){var e=Object(c.a)(h.a.mark((function e(t,s){var o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(N.a)(),r.setLoading(!0),e.prev=2,e.next=5,j.a.get("".concat(w.c,"/schoolpostrequest/request/").concat(t,"/").concat(s));case 5:o=e.sent,console.log("RES DATA: ",o.data),r.getNotInitializedPosts(o.data.school_positions,o.data.school_post_requests).length>0?r.initializePosts(o.data.school_positions,o.data.school_post_requests):(r.setState({normalSchoolPositions:o.data.school_positions}),r.setState({schoolPositions:o.data.school_post_requests})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),console.log("Err: ",Object(i.a)({},e.t0)),r.cleanAlert();case 14:r.setLoading(!1);case 15:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,s){return e.apply(this,arguments)}}(),r.TotalVacantPosts=function(e){var t,s=0,o=Object(n.a)(e);try{for(o.s();!(t=o.n()).done;){var i=t.value;s+=T(r.state.normalSchoolPositions,r.state.schoolPositions,i)}}catch(c){o.e(c)}finally{o.f()}return s},r.sendFinalPostRequest=function(){var e=Object(c.a)(h.a.mark((function e(t){var s,o,c,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=4;break}return e.abrupt("return",r.setState({alert:{target:"main-error",msg:"No request found!"}}));case 4:if(!(""===t[0].head_teacher_post_request||parseInt(t[0].head_teacher_post_request)<0)){e.next=6;break}return e.abrupt("return",r.setState({alert:{target:"main-error",msg:"Please type number of requests greater than 0"}}));case 6:return r.setLoading(!0),e.prev=7,Object(N.a)(),e.next=11,j.a.post("".concat(w.c,"/schoolpostrequest/htrequest"),t);case 11:if(console.log("Sent data: ",t),void 0===r.state.schoolPositions.find((function(e){return e.position_code===t[0].position_code})))r.getSchoolPositions(t[0].school_code,t[0].academic_year_id);else{s=[],o=Object(n.a)(r.state.schoolPositions);try{for(o.s();!(c=o.n()).done;)(a=c.value).position_code===t[0].position_code?s.push({qualification_name:a.qualification_name,position_name:a.position_name,post_request_id:a.post_request_id,academic_calendar_id:a.academic_calendar_id,school_code:a.school_code,position_code:a.position_code,qualification_id:a.qualification_id,head_teacher_id:a.head_teacher_id,head_teacher_post_request:t[0].head_teacher_post_request.toString(),head_teacher_reason_id:t[0].head_teacher_reason_id,dde_id_request:a.dde_id_request,dde_post_request:a.dde_post_request,dde_id_distribution:a.dde_id_distribution,dde_post_distribution:a.dde_post_distribution,dde_distribution_comment:a.dde_distribution_comment,district_code:a.district_code,created_by:a.created_by,existing_post:a.existing_post,school_level_name:a.school_level_name,total_on_position:a.total_on_position,school_has_position_id:a.school_has_position_id}):s.push(a)}catch(l){o.e(l)}finally{o.f()}0===r.getNotInitializedPosts(r.state.normalSchoolPositions,r.state.schoolPositions).length&&r.setState({alert:{target:"main-success",msg:"Posts Request Submitted Successfully!"}}),r.setState({schoolPositions:s})}r.cleanAlert(),r.countRequestedPosts([]),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(7),console.log("Erro post: ",Object(i.a)({},e.t0)),r.cleanAlert(),r.setState({alert:{target:"main-error",msg:"Something went Wrong, Sending Request, Please try Again Later"}});case 23:r.setLoading(!1);case 24:case"end":return e.stop()}}),e,null,[[7,18]])})));return function(t){return e.apply(this,arguments)}}(),r.getUpdatedValue=function(e,t){var s=r.state.requestPosts.map((function(s){return s.position_code===t&&(s.head_teacher_post_request=e),s}));r.setState({requestPosts:s}),r.countRequestedPosts(r.state.requestPosts)},r.getValue=function(e,t){var s,i,n,c,a=r.state.currentPostsData.filter((function(e){return e.position_id===t}))[0],l="".concat(null===(s=r.props.auth.school)||void 0===s?void 0:s.school_code[0]).concat(null===(i=r.props.auth.school)||void 0===i?void 0:i.school_code[1]);if(a&&l&&null!==(n=r.props.auth.school)&&void 0!==n&&n.school_code&&null!==(c=r.props.auth.user)&&void 0!==c&&c.user_id){var d,u={academic_calendar_id:(null===(d=r.props.basic.academic_calender)||void 0===d?void 0:d.academic_year_id)||"1",school_code:r.props.auth.school.school_code,position_name:a.position_name,qualification_name:a.qualification_name,position_code:a.position_code,qualification_id:a.qualification_id,head_teacher_id:r.props.auth.user.user_id,head_teacher_post_request:e,head_teacher_reason_id:"7",district_code:l},h=[].concat(Object(o.a)(r.state.requestPosts),[u]);r.setState({requestPosts:h}),r.countRequestedPosts(h),r.setState({requestPosts:h})}},r.filterData=function(){var e=[].concat(Object(o.a)(r.state.normalSchoolPositions.filter((function(e){var t;return e.position_code!==(null===(t=r.state.schoolPositions.find((function(t){return t.position_code===e.position_code})))||void 0===t?void 0:t.position_code)}))),Object(o.a)(r.state.schoolPositions)),t="All"===r.state.seleQualification?e:e.filter((function(e){return e.qualification_id===r.state.seleQualification}));return Object(R.f)(t,r.state.seacrhValue)},r.componentDidMount=function(){null===r.props.basic.positions&&r.props.FC_GetAllPositions((function(e,t){r.setLoading(!0),!1===e&&r.setState({alert:{target:"main-error",msg:t}}),r.setLoading(!1)})),r.props.auth.school&&r.props.basic.academic_calender&&r.getSchoolPositions(r.props.auth.school.school_code,r.props.basic.academic_calender.academic_year_id),0===r.state.postRequestReasons.length&&r.getPostRequestReasons()},r.addPostRequestItem=function(e){r.props.basic.academic_calender&&r.props.auth.user&&r.props.auth.district&&r.setState({addedRequests:[].concat(Object(o.a)(r.state.addedRequests.filter((function(t){return t.position_code!==e.position.position_code}))),[{academic_year_id:r.props.basic.academic_calender.academic_year_id,school_code:e.position.school_code,position_code:e.position.position_code,qualification_id:e.position.qualification_id,head_teacher_id:r.props.auth.user.user_id,head_teacher_post_request:e.postsNumber.toString(),existing_post:void 0===e.position.existing_post?"0":e.position.existing_post,head_teacher_reason_id:e.reason,district_code:r.props.auth.district.district_code}])})},r.getNotInitializedPosts=function(e,t){var s,o=[],i=Object(n.a)(e);try{var c=function(){var e=s.value;void 0===t.find((function(t){return t.position_code===e.position_code}))&&o.push(e)};for(i.s();!(s=i.n()).done;)c()}catch(a){i.e(a)}finally{i.f()}return o},r.initializePosts=function(e,t){var s,i=[],c=Object(n.a)(e);try{for(c.s();!(s=c.n()).done;){var a=s.value;i=[].concat(Object(o.a)(i),Object(o.a)(r.getPostRequestItem({position:a,reason:"7",postsNumber:0})))}}catch(l){c.e(l)}finally{c.f()}console.log("Requests: ",i),r.sendFinalPostRequest(i),console.log("Testing reset data: ",{schoolPositions:t,normalSchoolPositions:e})},r.getPostRequestItem=function(e){var t=[];return r.props.basic.academic_calender&&r.props.auth.user&&(t=[].concat(Object(o.a)(r.state.addedRequests.filter((function(t){return t.position_code!==e.position.position_code}))),[{academic_year_id:r.props.basic.academic_calender.academic_year_id,school_code:e.position.school_code,position_code:e.position.position_code,qualification_id:e.position.qualification_id,head_teacher_id:r.props.auth.user.user_id,head_teacher_post_request:e.postsNumber.toString(),existing_post:e.position.total_on_position,head_teacher_reason_id:e.reason,district_code:e.position.school_code.substring(0,2)}])),t},r.state={selected:null,seleQualification:"All",qualification:[],totalRequested:0,seacrhValue:"",alert:{target:null,msg:""},currentPostsData:[],allFliteredData:[],requestPosts:[],addSchoolPositions:!1,schoolPositions:[],normalSchoolPositions:[],sendPostRequest:!0,addedRequests:[],postRequestReasons:[],loading:!1},r}return Object(r.a)(s,[{key:"render",value:function(){var e,t=this;return Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)(f.a,{title:"Posts requests",subTitle:"School posts requests management",className:"h-screen",children:[0!==this.getNotInitializedPosts(this.state.normalSchoolPositions,this.state.schoolPositions).length&&Object(g.jsx)("div",{className:"fixed bg-black bg-opacity-50 h-full w-full top-0 left-0 z-50 flex flex-row items-center justify-center",children:Object(g.jsxs)("div",{className:"bg-white rounded-md p-10 text-center flex flex-col bg-opacity-80",children:[Object(g.jsx)("span",{className:"text-2xl",children:"Initializing new positions"}),Object(g.jsx)("span",{className:"text-base text-gray-500",children:"Please wait..."})]})}),"main-success"===this.state.alert.target&&Object(g.jsx)("div",{className:"mb-20",children:Object(g.jsx)(P.a,{theme:"success",children:this.state.alert.msg})}),"main-error"===this.state.alert.target&&Object(g.jsx)("div",{className:"mb-20",children:Object(g.jsx)(P.a,{theme:"danger",children:this.state.alert.msg})}),null===this.props.basic.positions?Object(g.jsxs)("div",{className:"flex flex-col justify-center items-center bg-gray-100 rounded-md p-5 w-full mt-4",children:[Object(g.jsx)(q.a,{}),Object(g.jsx)("div",{className:"text-xl text-gray-800 animate-pulse",children:Object(g.jsx)("span",{children:"Loading positions..."})})]}):!0===this.state.addSchoolPositions&&null!==this.props.basic.positions?Object(g.jsx)("div",{className:"mt-4 border rounded",children:Object(g.jsx)(S.a,{auth:this.props.auth,positions:this.props.basic.positions,schoolPositions:this.state.schoolPositions,appendPositionsToSchool:function(e){t.props.auth.school&&t.props.basic.academic_calender&&t.getSchoolPositions(t.props.auth.school.school_code,t.props.basic.academic_calender.academic_year_id)},removePositionsToSchool:function(e){t.props.auth.school&&t.props.basic.academic_calender&&t.getSchoolPositions(t.props.auth.school.school_code,t.props.basic.academic_calender.academic_year_id)},close:function(){t.setState({addSchoolPositions:!1})}})}):!1===this.state.sendPostRequest?Object(g.jsx)("div",{}):Object(g.jsxs)("div",{className:"",children:[Object(g.jsxs)("div",{className:"flex flex-row w-full justify-between mt-3 -mb-3",children:[Object(g.jsx)("div",{className:"text-xl uppercase mb-2",children:"LIST OF SCHOOL POSITIONS"}),Object(g.jsx)("div",{className:"",children:Object(g.jsx)("div",{className:"flex flex-row gap-5 md:-mt-12",children:Object(g.jsx)("div",{children:Object(g.jsxs)("div",{className:"flex flex-row gap-5 bg-blue-50 -mt-3 mb-3 rounded-md pt-2 px-4",children:[Object(g.jsxs)("div",{className:"mb-3 text-center",children:[Object(g.jsx)("div",{className:"text-sm text-gray-900 -mt-1",children:"Existing teachers"}),Object(g.jsxs)("div",{className:"text-4xl font-bold text-gray-900",children:[this.existingTeachersCount(this.state.schoolPositions)<10?0:"",this.existingTeachersCount(this.state.schoolPositions)]})]}),Object(g.jsxs)("div",{className:"text-center",children:[Object(g.jsx)("div",{className:"text-sm text-accent-900 -mt-1",children:"Total vacants"}),Object(g.jsxs)("div",{className:"text-4xl font-bold text-accent-900",children:[this.TotalVacantPosts(this.state.schoolPositions)<10?0:"",this.newAddedTeachersCount(this.state.schoolPositions)]})]})]})})})})]}),!0===this.state.loading?Object(g.jsxs)("div",{className:"flex flex-col items-center justify-center bg-gray-100 rounded-lg p-5 mt-5",children:[Object(g.jsx)(q.a,{}),Object(g.jsx)("div",{className:"text-2xl",children:"Loading, please wait..."})]}):Object(g.jsx)("div",{className:"flex flex-row gap-2",children:Object(g.jsxs)("div",{className:"flex-1 bg-white dark:bg-dark-800 shadow-lg rounded-md p-2 pt-0 mb-10",children:[Object(g.jsxs)("div",{className:"flex flex-row items-center w-full",children:[Object(g.jsx)("div",{className:"flex-1",children:Object(g.jsx)(y.a,{onChange:function(e){return t.setState({seacrhValue:e.target.value})},error:"",placeholder:"Search Post Here...",value:this.state.seacrhValue,type:"search",name:"post",label:"Search",size:"sm"})}),Object(g.jsxs)("div",{className:"flex-2 relative inline-block mt-6 ml-2",children:[Object(g.jsxs)("select",{value:this.state.seleQualification,placeholder:"All",className:"block appearance-none w-full bg-white border-2 border-primary-800 hover:border-black px-4 py-2 pr-8 rounded  leading-tight focus:outline-none md:w-full dark:text-white dark:bg-primary-900 ",onChange:function(e){t.setState({seleQualification:e.target.value})},children:[Object(g.jsx)("option",{value:"All",children:"All"}),this.props.basic.qualifications.map((function(e){return Object(g.jsx)("option",{value:e.qualification_id,children:e.qualification_name},e.qualification_id)}))]}),Object(g.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:Object(g.jsx)(_.a,{className:"fill-current h-4 w-4"})})]})]}),Object(g.jsx)("div",{className:"w-full h-full",children:Object(g.jsx)("div",{className:"w-full h-full overflow-x-scroll",children:Object(g.jsxs)("table",{className:"h-auto",children:[Object(g.jsx)("thead",{children:Object(g.jsxs)("tr",{children:[Object(g.jsx)("th",{className:"border text-center px-2",children:"#"}),Object(g.jsx)("th",{className:"text-left border px-2",style:{width:"2000px"},children:"Position"}),Object(g.jsx)("th",{className:"text-center border px-2",children:"Qualification"}),Object(g.jsx)("th",{className:"text-center border w-40",children:"Existing teachers"}),Object(g.jsx)("th",{className:"text-center text-blue-800 bg-blue-50 border border-blue-100 w-48",children:"HT new posts requests"}),Object(g.jsx)("th",{className:"text-center border text-green-800 w-48",children:"Approved posts by DDE"}),Object(g.jsx)("th",{className:"text-center border text-accent-900 w-48",children:"Total posts"}),Object(g.jsx)("th",{className:"text-center border  w-48",children:"Vacant posts"}),Object(g.jsx)("th",{className:"text-center border w-52",children:"Comment"})]})}),Object(g.jsxs)("tbody",{children:[this.state.normalSchoolPositions.length<=0&&Object(g.jsx)("tr",{children:Object(g.jsx)("td",{className:"text-center p-2",colSpan:9,children:Object(g.jsxs)("div",{className:"bg-gray-100 rounded-md p-6",children:[Object(g.jsx)("div",{className:"text-2xl font-extrabold text-center",children:"No positions Found"}),Object(g.jsxs)("div",{className:"text-base text-center",children:["There are no positions assigned to the school"," ",null===(e=this.props.auth.school)||void 0===e?void 0:e.school_name]}),Object(g.jsx)("div",{className:"flex justify-center w-full mt-3",children:Object(g.jsx)("div",{onClick:function(){t.setState({addSchoolPositions:!0})},className:"btn bg-yellow-50 border-2 border-yellow-500 hover:bg-accent-900 w-max rounded-md px-4 py-2 text-base font-bold hover:text-white cursor-pointer",children:"Add positions"})})]})})}),this.filterData().map((function(e,s){var o,i=s+1;return Object(g.jsx)(p.Fragment,{children:Object(g.jsxs)("tr",{className:"rounded ".concat(e.position_code===t.state.selected?"bg-yellow-50 font-bold":""," ").concat(void 0!==t.state.addedRequests.find((function(t){return t.position_code===e.position_code}))?"hover:bg-blue-50 hover:text-primary-800":"hover:bg-gray-50 hover:text-accent-900","  hover:text-dark-900 group"),children:[Object(g.jsx)("td",{className:"p-2 border text-center",children:i}),Object(g.jsx)("td",{className:"p-2 border",children:Object(g.jsxs)("div",{className:"flex flex-col",children:[Object(g.jsx)("span",{className:"text-base",children:e.position_name}),Object(g.jsxs)("span",{className:"text-gray-500 text-sm group-hover:text-black",children:["School level:"," ",Object(g.jsx)("span",{className:"font-bold",children:e.school_level_name})]})]})}),Object(g.jsx)("td",{className:"p-2 border text-center",children:e.qualification_name}),Object(g.jsx)("td",{className:"p-2 border text-center",children:null===(o=t.state.normalSchoolPositions.find((function(t){return t.position_code===e.position_code})))||void 0===o?void 0:o.total_on_position}),e.position_code===t.state.selected?Object(g.jsx)("td",{className:" border  w-12 relative",children:t.state.normalSchoolPositions.find((function(t){return t.position_code===e.position_code}))&&Object(g.jsx)(O,{postRequestReasons:t.state.postRequestReasons,getPostRequestItem:t.getPostRequestItem,close:function(){t.setState({selected:null})},currentRequests:void 0===e.head_teacher_post_request||null===e.head_teacher_post_request?0:parseInt(e.head_teacher_post_request),submitRequest:t.sendFinalPostRequest,position:t.state.normalSchoolPositions.find((function(t){return t.position_code===e.position_code}))})}):Object(g.jsx)("td",{className:"p-2 border-2 rounded ".concat(null===e.head_teacher_post_request?"group-hover:bg-primary-800 border-primary-800":"group-hover:bg-blue-300 border-blue-300"," group-hover:text-black w-12 font-bold  bg-blue-100 hover:bg-blue-300 cursor-pointer text-center"),onClick:function(s){t.setState({selected:e.position_code})},children:void 0===e.head_teacher_post_request?Object(g.jsx)("span",{className:"text-gray-400 group-hover:text-yellow-800",children:"0"}):null!==e.head_teacher_post_request?e.head_teacher_post_request:Object(g.jsx)("div",{className:"w-full h-full rounded text-center text-blue-800 group-hover:text-white",children:"Request"})}),Object(g.jsx)("td",{className:"p-2 text-green-600 border font-bold text-center",children:void 0===e.dde_post_distribution?Object(g.jsx)("span",{className:"text-gray-400 group-hover:text-yellow-800",children:"0"}):null===e.dde_post_distribution?0:e.dde_post_distribution}),Object(g.jsx)("td",{className:"p-2 border text-center",children:k(t.state.schoolPositions,e)}),Object(g.jsx)("td",{className:"p-2 border text-center",children:T(t.state.normalSchoolPositions,t.state.schoolPositions,e)<0?Object(g.jsx)("span",{className:"text-sm"}):T(t.state.normalSchoolPositions,t.state.schoolPositions,e)}),Object(g.jsx)("td",{className:"p-2 border text-center",children:e.dde_distribution_comment})]})},i)}))]})]})})})]})})]})]})})}}]),s}(p.Component),I=Object(b.b)((function(e){return{auth:e.auth,basic:e.basic}}),{FC_GetAllPositions:x.j})(C)}}]);
//# sourceMappingURL=29.c93bfd0a.chunk.js.map